/*!
 * tsui-image-editor.min.js
 * @version 3.4.0
 * @author NHNEnt FE Development Lab <dl_javascript@nhnent.com>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("tui-code-snippet"),require("fabric/dist/fabric.require")):"function"==typeof define&&define.amd?define(["tui-code-snippet","fabric/dist/fabric.require"],t):"object"==typeof exports?exports.ImageEditor=t(require("tui-code-snippet"),require("fabric/dist/fabric.require")):(e.tui=e.tui||{},e.tui.ImageEditor=t(e.tui&&e.tui.util,e.fabric))}(window,function(e,t){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=68)}([function(t,n){t.exports=e},function(e,t,n){n(36),n(37),n(52),n(56),e.exports=n(7).Promise},function(e,n){e.exports=t},function(e,t,n){var i=n(28)("wks"),o=n(29),r=n(4).Symbol,a="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=a&&r[e]||(a?r:o)("Symbol."+e))}).store=i},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var i=n(11),o=n(26);e.exports=n(8)?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(12);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){e.exports=!n(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports={}},function(e,t,n){var i=n(17);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var i=n(6),o=n(39),r=n(40),a=Object.defineProperty;t.f=n(8)?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var i=n(12),o=n(4).document,r=i(o)&&i(o.createElement);e.exports=function(e){return r?o.createElement(e):{}}},function(e,t,n){var i=n(47),o=n(16);e.exports=function(e){return i(o(e))}},function(e,t,n){var i=n(28)("keys"),o=n(29);e.exports=function(e){return i[e]||(i[e]=o(e))}},function(e,t,n){var i=n(11).f,o=n(13),r=n(3)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,n){"use strict";var i=n(23),o=n(24),r=n(41),a=n(5),s=n(13),c=n(9),l=n(42),u=n(21),h=n(50),d=n(3)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,g,v,m,b){l(n,t,g);var y,_,k,w=function(e){if(!f&&e in C)return C[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},x=t+" Iterator",E="values"==v,S=!1,C=e.prototype,O=C[d]||C["@@iterator"]||v&&C[v],j=O||w(v),P=v?E?w("entries"):j:void 0,T="Array"==t&&C.entries||O;if(T&&(k=h(T.call(new e)))!==Object.prototype&&(u(k,x,!0),i||s(k,d)||a(k,d,p)),E&&O&&"values"!==O.name&&(S=!0,j=function(){return O.call(this)}),i&&!b||!f&&!S&&C[d]||a(C,d,j),c[t]=j,c[x]=p,v)if(y={values:E?j:w("values"),keys:m?j:w("keys"),entries:P},b)for(_ in y)_ in C||r(C,_,y[_]);else o(o.P+o.F*(f||S),t,y);return y}},function(e,t){e.exports=!0},function(e,t,n){var i=n(4),o=n(7),r=n(10),a=n(5),s=function(e,t,n){var c,l,u,h=e&s.F,d=e&s.G,f=e&s.S,p=e&s.P,g=e&s.B,v=e&s.W,m=d?o:o[t]||(o[t]={}),b=m.prototype,y=d?i:f?i[t]:(i[t]||{}).prototype;for(c in d&&(n=t),n)(l=!h&&y&&void 0!==y[c])&&c in m||(u=l?y[c]:n[c],m[c]=d&&"function"!=typeof y[c]?n[c]:g&&l?r(u,i):v&&y[c]==u?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(u):p&&"function"==typeof u?r(Function.call,u):u,p&&((m.virtual||(m.virtual={}))[c]=u,e&s.R&&b&&!b[c]&&a(b,c,u)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(15),o=Math.min;e.exports=function(e){return e>0?o(i(e),9007199254740991):0}},function(e,t,n){var i=n(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){e.exports=n(4).document&&document.documentElement},function(e,t,n){var i=n(14),o=n(3)("toStringTag"),r="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:r?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var i,o,r,a=n(10),s=n(63),c=n(31),l=n(18),u=n(4),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,g=0,v={},m=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){m.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},f=function(e){delete v[e]},"process"==n(14)(h)?i=function(e){h.nextTick(a(m,e,1))}:p?(r=(o=new p).port2,o.port1.onmessage=b,i=a(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):i="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),m.call(e)}}:function(e){setTimeout(a(m,e,1),0)}),e.exports={set:d,clear:f}},function(e,t,n){
/*!
 * Toast UI Colorpicker
 * @version 2.2.0
 * @author NHNEnt FE Development Team <dl_javascript@nhnent.com>
 * @license MIT
 */
var i;i=function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="dist",n(0)}([function(e,t,n){n(1),e.exports=n(6)},function(e,t){},,,,,function(e,t,n){"use strict";var i={domutil:n(7),domevent:n(9),Collection:n(10),View:n(11),Drag:n(12),create:n(13),Palette:n(16),Slider:n(18),colorutil:n(14),svgvml:n(19)};e.exports=i},function(e,t,n){"use strict";var i,o,r=n(8),a=n(9),s=n(10),c=r,l="onselectstart"in document,u="",h=/^auto$|^$|%/;o=(i={appendHTMLElement:function(e,t,n){var i;return n=n||"",(i=document.createElement(e)).className=n,t?t.appendChild(i):document.body.appendChild(i),i},remove:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},get:function(e){return document.getElementById(e)},_matcher:function(e,t){return/^\./.test(t)?i.hasClass(e,t.replace(".","")):/^#/.test(t)?e.id===t.replace("#",""):e.nodeName.toLowerCase()===t.toLowerCase()},find:function(e,t,n){var o=[],r=!1,a=c.isUndefined(n)||!1===n,s=c.isFunction(n);return c.isString(t)&&(t=i.get(t)),function e(t,c){for(var l,u=t.childNodes,h=0,d=u.length;h<d;h+=1)if("#text"!==(l=u[h]).nodeName)if(i._matcher(l,c)){if((s&&n(l)||!s)&&o.push(l),a){r=!0;break}}else if(l.childNodes.length>0&&(e(l,c),r))break}(t=t||window.document.body,e),a?o[0]||null:o},closest:function(e,t){var n=e.parentNode;if(i._matcher(e,t))return e;for(;n&&n!==window.document.body;){if(i._matcher(n,t))return n;n=n.parentNode}},text:function(e){var t="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)t+=i.text(e)}else if(3===o||4===o)return e.nodeValue}else for(;e[n];n+=1)t+=i.text(e[n]);return t},setData:function(e,t,n){"dataset"in e?e.dataset[t]=n:e.setAttribute("data-"+t,n)},getData:function(e,t){return"dataset"in e?e.dataset[t]:e.getAttribute("data-"+t)},hasClass:function(e,t){var n;return c.isUndefined(e.classList)?(n=i.getClass(e)).length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n):e.classList.contains(t)},addClass:function(e,t){var n;c.isUndefined(e.classList)?i.hasClass(e,t)||(n=i.getClass(e),i.setClass(e,(n?n+" ":"")+t)):c.forEachArray(t.split(" "),function(t){e.classList.add(t)})},setClass:function(e,t){c.isUndefined(e.className.baseVal)?e.className=t:e.className.baseVal=t},removeClass:function(e,t){var n="";c.isUndefined(e.classList)?(n=(" "+i.getClass(e)+" ").replace(" "+t+" "," "),i.setClass(e,n.replace(/^\s\s*/,"").replace(/\s\s*$/,""))):e.classList.remove(t)},getClass:function(e){return e&&e.className?c.isUndefined(e.className.baseVal)?e.className:e.className.baseVal:""},getStyle:function(e,t){var n,i=e.style[t]||e.currentStyle&&e.currentStyle[t];return i&&"auto"!==i||!document.defaultView||(i=(n=document.defaultView.getComputedStyle(e,null))?n[t]:null),"auto"===i?null:i},getComputedStyle:function(e){var t=document.defaultView;return t&&t.getComputedStyle?document.defaultView.getComputedStyle(e):{getPropertyValue:function(t){var n=/(\-([a-z]){1})/g;return"float"===t&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null}}},setPosition:function(e,t,n){t=c.isUndefined(t)?0:t,n=c.isUndefined(n)?0:n,e._pos=[t,n],e.style.left=t+"px",e.style.top=n+"px"},getPosition:function(e,t){var n,i,o;return t&&(e._pos=null),e._pos?e._pos:(n=0,i=0,(h.test(e.style.left)||h.test(e.style.top))&&"getBoundingClientRect"in e?(n=(o=e.getBoundingClientRect()).left,i=o.top):(n=parseFloat(e.style.left||0),i=parseFloat(e.style.top||0)),[n,i])},getSize:function(e){var t,n=i.getStyle(e,"width"),o=i.getStyle(e,"height");return(h.test(n)||h.test(o))&&"getBoundingClientRect"in e?(n=(t=e.getBoundingClientRect()).width,o=t.height):(n=parseFloat(n||0),o=parseFloat(o||0)),[n,o]},testProp:function(e){for(var t=document.documentElement.style,n=0,i=e.length;n<i;n+=1)if(e[n]in t)return e[n];return!1},getFormData:function(e){var t=new s(function(){return this.length}),n=function(e){return!e.disabled},o={};return t.add.apply(t,i.find("input",e,n).concat(i.find("select",e,n)).concat(i.find("textarea",e,n))),t=t.groupBy(function(e){return e&&e.getAttribute("name")||"_other"}),c.forEach(t,function(e,t){"_other"!==t&&e.each(function(n){var r=n.nodeName.toLowerCase(),a=n.type,s=[];"radio"===a?s=[e.find(function(e){return e.checked}).toArray().pop()]:"checkbox"===a?s=e.find(function(e){return e.checked}).toArray():"select"===r?e.find(function(e){return!!e.childNodes.length}).each(function(e){s=s.concat(i.find("option",e,function(e){return e.selected}))}):s=e.find(function(e){return""!==e.value}).toArray(),(s=c.map(s,function(e){return e.value})).length?1===s.length&&(s=s[0]):s="",o[t]=s})}),o}}).testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),i.disableTextSelection=l?function(){a.on(window,"selectstart",a.preventDefault)}:function(){var e=document.documentElement.style;u=e[o],e[o]="none"},i.enableTextSelection=l?function(){a.off(window,"selectstart",a.preventDefault)}:function(){document.documentElement.style[o]=u},i.disableImageDrag=function(){a.on(window,"dragstart",a.preventDefault)},i.enableImageDrag=function(){a.off(window,"dragstart",a.preventDefault)},i.applyTemplate=function(e,t){return e.replace(/\{\{(\w*)\}\}/g,function(e,n){return t.hasOwnProperty(n)?t[n]:""})},e.exports=i},function(t,n){t.exports=e},function(e,t,n){"use strict";var i=n(8),o=i.browser,r={START:["touchstart","mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},a={on:function(e,t,n,o){i.isString(t)?i.forEach(t.split(" "),function(t){a._on(e,t,n,o)}):i.forEachOwnProperties(t,function(t,i){a._on(e,i,t,n)})},_on:function(e,t,n,o){var r,s,c;r=t+i.stamp(n)+(o?"_"+i.stamp(o):""),e._evt&&e._evt[r]||(c=s=function(t){n.call(o||e,t||window.event)},"addEventListener"in e?"mouseenter"===t||"mouseleave"===t?(s=function(t){t=t||window.event,a._checkMouse(e,t)&&c(t)},e.addEventListener("mouseenter"===t?"mouseover":"mouseout",s,!1)):("mousewheel"===t&&e.addEventListener("DOMMouseScroll",s,!1),e.addEventListener(t,s,!1)):"attachEvent"in e&&e.attachEvent("on"+t,s),e._evt=e._evt||{},e._evt[r]=s)},off:function(e,t,n,o){i.isString(t)?i.forEach(t.split(" "),function(t){a._off(e,t,n,o)}):i.forEachOwnProperties(t,function(t,i){a._off(e,i,t,n)})},_off:function(e,t,n,o){var r=t+i.stamp(n)+(o?"_"+i.stamp(o):""),a=e._evt&&e._evt[r];if(a){if("removeEventListener"in e)"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",a,!1):("mousewheel"===t&&e.removeEventListener("DOMMouseScroll",a,!1),e.removeEventListener(t,a,!1));else if("detachEvent"in e)try{e.detachEvent("on"+t,a)}catch(e){}delete e._evt[r],i.keys(e._evt).length||(i.browser.msie&&i.browser.version<9?e._evt=null:delete e._evt)}},once:function(e,t,n,o){var r=this;i.isObject(t)?i.forEachOwnProperties(t,function(t,i){a.once(e,i,t,n)}):a.on(e,t,function i(){n.apply(o||e,arguments),r._off(e,t,i,o)},o)},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stop:function(e){a.preventDefault(e),a.stopPropagation(e)},disableScrollPropagation:function(e){a.on(e,"mousewheel MozMousePixelScroll",a.stopPropagation)},disableClickPropagation:function(e){a.on(e,r.START.join(" ")+" click dblclick",a.stopPropagation)},getMousePosition:function(e,t){var n;return t?(n=t.getBoundingClientRect(),[e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop]):[e.clientX,e.clientY]},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_checkMouse:function(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(e){return!1}return n!==e},trigger:function(e,t,n){i.isUndefined(n)&&/(mouse|click)/.exec(t)&&(n=a.mouseEvent(t)),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent&&e.fireEvent("on"+t,n)},mouseEvent:function(e,t){var n,r;return r=i.extend({bubbles:!0,cancelable:"mousemove"!==e,view:window,wheelDelta:0,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},t),o.msie&&o.version<9&&delete r.wheelDelta,"function"==typeof document.createEvent?(n=document.createEvent("MouseEvents")).initMouseEvent(e,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,document.body.parentNode):document.createEventObject&&(n=document.createEventObject(),i.forEach(r,function(e,t){n[t]=e},this),n.button={0:1,1:4,2:2}[n.button]||n.button),n},getMouseButton:function(e){var t;return document.implementation.hasFeature("MouseEvents","2.0")?e.button:(t=e.button+"",~"0,1,3,5,7".indexOf(t)?0:~"2,6".indexOf(t)?2:~"4".indexOf(t)?1:void 0)}};e.exports=a},function(e,t,n){"use strict";var i=n(8),o=i.forEachOwnProperties,r=i.forEachArray,a=i.isFunction,s=i.isObject,c=Array.prototype.slice;function l(e){this.items={},this.length=0,a(e)&&(this.getItemID=e)}l.and=function(e){var t;return e=c.call(arguments),t=e.length,function(n){for(var i=0;i<t;i+=1)if(!e[i].call(null,n))return!1;return!0}},l.or=function(e){var t;return e=c.call(arguments),t=e.length,function(n){for(var i=1,o=e[0].call(null,n);i<t;i+=1)o=o||e[i].call(null,n);return o}},l.merge=function(e){var t=c.call(arguments),n={},o=new l(t[0].getItemID),a=i.extend;return r(t,function(e){a(n,e.items)}),o.items=n,o.length=i.keys(o.items).length,o},l.prototype.getItemID=function(e){return e._id+""},l.prototype.add=function(e){var t,n;arguments.length>1?r(c.call(arguments),function(e){this.add(e)},this):(t=this.getItemID(e),(n=this.items)[t]||(this.length+=1),n[t]=e)},l.prototype.remove=function(e){var t,n,o=[];return this.length?arguments.length>1?o=i.map(c.call(arguments),function(e){return this.remove(e)},this):(t=this.items,s(e)&&(e=this.getItemID(e)),t[e]?(this.length-=1,n=t[e],delete t[e],n):o):o},l.prototype.clear=function(){this.items={},this.length=0},l.prototype.has=function(e){var t,n;return!!this.length&&(t=a(e),n=!1,t?this.each(function(t){return!0!==e(t)||(n=!0,!1)}):(e=s(e)?this.getItemID(e):e,n=i.isExisty(this.items[e])),n)},l.prototype.doWhenHas=function(e,t,n){var o=this.items[e];i.isExisty(o)&&t.call(n||this,o)},l.prototype.find=function(e){var t=new l;return this.hasOwnProperty("getItemID")&&(t.getItemID=this.getItemID),this.each(function(n){!0===e(n)&&t.add(n)}),t},l.prototype.groupBy=function(e,t){var n,o,r={},s=a(e),c=this.getItemID;if(i.isArray(e)){if(i.forEachArray(e,function(e){r[e+""]=new l(c)}),!t)return r;e=t,s=!0}return this.each(function(t){s?o=e(t):(o=t[e],a(o)&&(o=o.apply(t))),(n=r[o])||(n=r[o]=new l(c)),n.add(t)}),r},l.prototype.single=function(){var e;return this.each(function(t){return e=t,!1},this),e},l.prototype.sort=function(e){var t=[];return this.each(function(e){t.push(e)}),a(e)&&(t=t.sort(e)),t},l.prototype.each=function(e,t){o(this.items,e,t||this)},l.prototype.toArray=function(){return this.length?i.map(this.items,function(e){return e}):[]},e.exports=l},function(e,t,n){"use strict";var i=n(8),o=n(7),r=n(10);function a(e,t){var n=i.stamp(this);e=e||{},i.isUndefined(t)&&(t=o.appendHTMLElement("div")),o.addClass(t,"tui-view-"+n),this.id=n,this.container=t,this.childs=new r(function(e){return i.stamp(e)}),this.parent=null}a.prototype.addChild=function(e,t){t&&t.call(e,this),e.parent=this,this.childs.add(e)},a.prototype.removeChild=function(e,t){var n=i.isNumber(e)?this.childs.items[e]:e;e=i.stamp(n),t&&t.call(n,this),this.childs.remove(e)},a.prototype.render=function(){this.childs.each(function(e){e.render()})},a.prototype.recursive=function(e,t){i.isFunction(e)&&(t||e(this),this.childs.each(function(t){t.recursive(e)}))},a.prototype.resize=function(){for(var e=Array.prototype.slice.call(arguments),t=this.parent;t;)i.isFunction(t._onResize)&&t._onResize.apply(t,e),t=t.parent},a.prototype._beforeDestroy=function(){},a.prototype._destroy=function(){this._beforeDestroy(),this.childs.clear(),this.container.innerHTML="",this.id=this.parent=this.childs=this.container=null},a.prototype.destroy=function(e){this.childs.each(function(e){e.destroy(!0),e._destroy()}),e||this._destroy()},a.prototype.getViewBound=function(){var e=this.container,t=o.getPosition(e),n=o.getSize(e);return{x:t[0],y:t[1],width:n[0],height:n[1]}},e.exports=a},function(e,t,n){(function(t){"use strict";var i=n(8),o=n(7),r=n(9);function a(e,t){r.on(t,"mousedown",this._onMouseDown,this),this.options=i.extend({distance:10},e),this.container=t,this._isMoved=!1,this._distance=0,this._dragStartFired=!1,this._dragStartEventData=null}a.prototype.destroy=function(){r.off(this.container,"mousedown",this._onMouseDown,this),this.options=this.container=this._isMoved=this._distance=this._dragStartFired=this._dragStartEventData=null},a.prototype._toggleDragEvent=function(e){var n,i,a=this.container;e?(n="on",i="disable"):(n="off",i="enable"),o[i+"TextSelection"](a),o[i+"ImageDrag"](a),r[n](t.document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp},this)},a.prototype._getEventData=function(e){return{target:e.target||e.srcElement,originEvent:e}},a.prototype._onMouseDown=function(e){0===r.getMouseButton(e)&&(this._distance=0,this._dragStartFired=!1,this._dragStartEventData=this._getEventData(e),this._toggleDragEvent(!0))},a.prototype._onMouseMove=function(e){var t=this.options.distance;r.preventDefault(e),this._isMoved=!0,this._distance<t?this._distance+=1:this._dragStartFired||(this._dragStartFired=!0,this.invoke("dragStart",this._dragStartEventData))?this.fire("drag",this._getEventData(e)):this._toggleDragEvent(!1)},a.prototype._onMouseUp=function(e){if(this._toggleDragEvent(!1),this._isMoved)return this._isMoved=!1,void this.fire("dragEnd",this._getEventData(e));this.fire("click",this._getEventData(e))},i.CustomEvents.mixin(a),e.exports=a}).call(t,function(){return this}())},function(e,t,n){"use strict";var i=n(8),o=n(14),r=n(15),a=n(16),s=n(18),c=!1;function l(e){var t,n;if(!(this instanceof l))return new l(e);if(!(e=this.options=i.extend({container:null,color:"#f8f8f8",preset:["#181818","#282828","#383838","#585858","#b8b8b8","#d8d8d8","#e8e8e8","#f8f8f8","#ab4642","#dc9656","#f7ca88","#a1b56c","#86c1b9","#7cafc2","#ba8baf","#a16946"],cssPrefix:"tui-colorpicker-",detailTxt:"Detail",usageStatistics:!0},e)).container)throw new Error("ColorPicker(): need container option.");t=this.layout=new r(e,e.container),this.palette=new a(e,t.container),this.palette.on({_selectColor:this._onSelectColorInPalette,_toggleSlider:this._onToggleSlider},this),this.slider=new s(e,t.container),this.slider.on("_selectColor",this._onSelectColorInSlider,this),t.addChild(this.palette),t.addChild(this.slider),this.render(e.color),e.usageStatistics&&(n=location.hostname,c||(c=!0,i.imagePing("https://www.google-analytics.com/collect",{v:1,t:"event",tid:"UA-115377265-9",cid:n,dp:n,dh:"color-picker"})))}l.prototype._onSelectColorInPalette=function(e){var t=e.color,n=this.options;o.isValidRGB(t)||""===t?(this.fire("selectColor",{color:t,origin:"palette"}),n.color!==t&&(n.color=t,this.render(t))):this.render()},l.prototype._onToggleSlider=function(){this.slider.toggle(!this.slider.isVisible())},l.prototype._onSelectColorInSlider=function(e){var t=e.color,n=this.options;this.fire("selectColor",{color:t,origin:"slider"}),n.color!==t&&(n.color=t,this.palette.render(t))},l.prototype.setColor=function(e){if(!o.isValidRGB(e))throw new Error("ColorPicker#setColor(): need valid hex string color value");this.options.color=e,this.render(e)},l.prototype.getColor=function(){return this.options.color},l.prototype.toggle=function(e){this.layout.container.style.display=e?"block":"none"},l.prototype.render=function(e){this.layout.render(e||this.options.color)},l.prototype.destroy=function(){this.layout.destroy(),this.options.container.innerHTML="",this.layout=this.slider=this.palette=this.options=null},i.CustomEvents.mixin(l),e.exports=l},function(e,t){"use strict";var n=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,i={leadingZero:function(e,t){var n="",i=0;if((e+"").length>t)return e+"";for(;i<t-1;i+=1)n+="0";return(n+e).slice(-1*t)},isValidRGB:function(e){return n.test(e)},
// @license RGB <-> HSV conversion utilities based off of http://www.cs.rit.edu/~ncs/color/t_convert.html
hexToRGB:function(e){return!!i.isValidRGB(e)&&(e=e.substring(1),[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)])},rgbToHEX:function(e,t,n){var o="#"+i.leadingZero(e.toString(16),2)+i.leadingZero(t.toString(16),2)+i.leadingZero(n.toString(16),2);return!!i.isValidRGB(o)&&o},rgbToHSV:function(e,t,n){var i,o,r,a,s,c;if(e/=255,t/=255,n/=255,s=i=Math.max(e,t,n),c=i-(o=Math.min(e,t,n)),a=0===i?0:c/i,i===o)r=0;else{switch(i){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return[Math.round(360*r),Math.round(100*a),Math.round(100*s)]},hsvToRGB:function(e,t,n){var i,o,r,a,s,c,l,u;if(e=Math.max(0,Math.min(360,e)),t=Math.max(0,Math.min(100,t)),n=Math.max(0,Math.min(100,n)),n/=100,0===(t/=100))return i=o=r=n,[Math.round(255*i),Math.round(255*o),Math.round(255*r)];switch(c=n*(1-t),l=n*(1-t*(s=(e/=60)-(a=Math.floor(e)))),u=n*(1-t*(1-s)),a){case 0:i=n,o=u,r=c;break;case 1:i=l,o=n,r=c;break;case 2:i=c,o=n,r=u;break;case 3:i=c,o=l,r=n;break;case 4:i=u,o=c,r=n;break;default:i=n,o=c,r=l}return[Math.round(255*i),Math.round(255*o),Math.round(255*r)]}};e.exports=i},function(e,t,n){"use strict";var i=n(8),o=n(7),r=n(11);function a(e,t){this.options=i.extend({cssPrefix:"tui-colorpicker-"},e),t=o.appendHTMLElement("div",t,this.options.cssPrefix+"container"),r.call(this,e,t),this.render()}i.inherit(a,r),a.prototype.render=function(e){this.recursive(function(t){t.render(e)},!0)},e.exports=a},function(e,t,n){"use strict";var i=n(8),o=n(7),r=n(14),a=n(9),s=n(11),c=n(17);function l(e,t){this.options=i.extend({cssPrefix:"tui-colorpicker-",preset:["#181818","#282828","#383838","#585858","#B8B8B8","#D8D8D8","#E8E8E8","#F8F8F8","#AB4642","#DC9656","#F7CA88","#A1B56C","#86C1B9","#7CAFC2","#BA8BAF","#A16946"],detailTxt:"Detail"},e),t=o.appendHTMLElement("div",t,this.options.cssPrefix+"palette-container"),s.call(this,e,t)}i.inherit(l,s),l.prototype._onClick=function(e){var t=this.options,n=e.srcElement||e.target,i={};if(o.hasClass(n,t.cssPrefix+"palette-button"))return i.color=n.value,void this.fire("_selectColor",i);o.hasClass(n,t.cssPrefix+"palette-toggle-slider")&&this.fire("_toggleSlider")},l.prototype._onChange=function(e){var t=this.options,n=e.srcElement||e.target,i={};o.hasClass(n,t.cssPrefix+"palette-hex")&&(i.color=n.value,this.fire("_selectColor",i))},l.prototype._beforeDestroy=function(){this._toggleEvent(!1)},l.prototype._toggleEvent=function(e){var t,n=this.options,i=this.container,r=a[e?"on":"off"];r(i,"click",this._onClick,this),(t=o.find("."+n.cssPrefix+"palette-hex",i))&&r(t,"change",this._onChange,this)},l.prototype.render=function(e){var t=this.options,n="";this._toggleEvent(!1),n=c.layout.replace("{{colorList}}",i.map(t.preset,function(n){var i="";return r.isValidRGB(n)&&(i=o.applyTemplate(c.itemStyle,{color:n})),o.applyTemplate(c.item,{itemStyle:i,itemClass:n?"":" "+t.cssPrefix+"color-transparent",color:n,cssPrefix:t.cssPrefix,selected:n===e?" "+t.cssPrefix+"selected":""})}).join("")),n=o.applyTemplate(n,{cssPrefix:t.cssPrefix,detailTxt:t.detailTxt,color:e}),this.container.innerHTML=n,this._toggleEvent(!0)},i.CustomEvents.mixin(l),e.exports=l},function(e,t){"use strict";var n=['<ul class="{{cssPrefix}}clearfix">{{colorList}}</ul>','<div class="{{cssPrefix}}clearfix" style="overflow:hidden">','<input type="button" class="{{cssPrefix}}palette-toggle-slider" value="{{detailTxt}}" />','<input type="text" class="{{cssPrefix}}palette-hex" value="{{color}}" maxlength="7" />','<span class="{{cssPrefix}}palette-preview" style="background-color:{{color}};color:{{color}}">{{color}}</span>',"</div>"].join("\n");e.exports={layout:n,item:'<li><input class="{{cssPrefix}}palette-button{{selected}}{{itemClass}}" type="button" style="{{itemStyle}}" title="{{color}}" value="{{color}}" /></li>',itemStyle:"background-color:{{color}};color:{{color}}"}},function(e,t,n){"use strict";var i=n(8),o=n(7),r=n(9),a=n(19),s=n(14),c=n(11),l=n(12),u=n(20),h=[-7,112],d=[-3,115];function f(e,t){(t=o.appendHTMLElement("div",t,e.cssPrefix+"slider-container")).style.display="none",c.call(this,e,t),this.options=i.extend({color:"#f8f8f8",cssPrefix:"tui-colorpicker-"},e),this._dragDataCache={},this.sliderHandleElement=null,this.huebarHandleElement=null,this.baseColorElement=null,this.drag=new l({distance:0},t),this.drag.on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd,click:this._onClick},this)}i.inherit(f,c),f.prototype._beforeDestroy=function(){this.drag.off(),this.drag=this.options=this._dragDataCache=this.sliderHandleElement=this.huebarHandleElement=this.baseColorElement=null},f.prototype.toggle=function(e){this.container.style.display=e?"block":"none"},f.prototype.isVisible=function(){return"block"===this.container.style.display},f.prototype.render=function(e){var t,n,i=this.container,r=this.options,a=u.layout;s.isValidRGB(e)&&(a=(a=(a=a.replace(/{{slider}}/,u.slider)).replace(/{{huebar}}/,u.huebar)).replace(/{{cssPrefix}}/g,r.cssPrefix),this.container.innerHTML=a,this.sliderHandleElement=o.find("."+r.cssPrefix+"slider-handle",i),this.huebarHandleElement=o.find("."+r.cssPrefix+"huebar-handle",i),this.baseColorElement=o.find("."+r.cssPrefix+"slider-basecolor",i),t=s.hexToRGB(e),n=s.rgbToHSV.apply(null,t),this.moveHue(n[0],!0),this.moveSaturationAndValue(n[1],n[2],!0))},f.prototype._moveColorSliderHandle=function(e,t,n){var i,o=this.sliderHandleElement;t=Math.max(h[0],t),t=Math.min(h[1],t),e=Math.max(h[0],e),e=Math.min(h[1],e),a.setTranslateXY(o,e,t),i=t>50?"white":"black",a.setStrokeColor(o,i),n||this.fire("_selectColor",{color:s.rgbToHEX.apply(null,this.getRGB())})},f.prototype.moveSaturationAndValue=function(e,t,n){var i,o,r,a;e=e||0,t=t||0,i=Math.abs(h[0]),r=e*(o=h[1])/100-i,a=o-t*o/100-i,this._moveColorSliderHandle(r,a,n)},f.prototype._moveColorSliderByPosition=function(e,t){var n=h[0];this._moveColorSliderHandle(e+n,t+n)},f.prototype.getSaturationAndValue=function(){var e=Math.abs(h[0]),t=e+h[1],n=a.getTranslateXY(this.sliderHandleElement);return[(n[1]+e)/t*100,100-(n[0]+e)/t*100]},f.prototype._moveHueHandle=function(e,t){var n,i,o=this.huebarHandleElement,r=this.baseColorElement;e=Math.max(d[0],e),e=Math.min(d[1],e),a.setTranslateY(o,e),n=s.hsvToRGB(this.getHue(),100,100),i=s.rgbToHEX.apply(null,n),a.setGradientColorStop(r,i),t||this.fire("_selectColor",{color:s.rgbToHEX.apply(null,this.getRGB())})},f.prototype.moveHue=function(e,t){var n,i;n=((i=Math.abs(d[0]))+d[1])*(e=e||0)/359.99-i,this._moveHueHandle(n,t)},f.prototype._moveHueByPosition=function(e){var t=d[0];this._moveHueHandle(e+t)},f.prototype.getHue=function(){var e,t,n=this.huebarHandleElement,i=a.getTranslateXY(n);return t=(e=Math.abs(d[0]))+d[1],359.99*(i[0]+e)/t},f.prototype.getHSV=function(){var e=this.getSaturationAndValue();return[this.getHue()].concat(e)},f.prototype.getRGB=function(){return s.hsvToRGB.apply(null,this.getHSV())},f.prototype._prepareColorSliderForMouseEvent=function(e){var t=this.options,n=o.closest(e.target,"."+t.cssPrefix+"slider-part");return this._dragDataCache={isColorSlider:o.hasClass(n,t.cssPrefix+"slider-left"),parentElement:n}},f.prototype._onClick=function(e){var t=this._prepareColorSliderForMouseEvent(e),n=r.getMousePosition(e.originEvent,t.parentElement);t.isColorSlider?this._moveColorSliderByPosition(n[0],n[1]):this._moveHueByPosition(n[1]),this._dragDataCache=null},f.prototype._onDragStart=function(e){this._prepareColorSliderForMouseEvent(e)},f.prototype._onDrag=function(e){var t=this._dragDataCache,n=r.getMousePosition(e.originEvent,t.parentElement);t.isColorSlider?this._moveColorSliderByPosition(n[0],n[1]):this._moveHueByPosition(n[1])},f.prototype._onDragEnd=function(){this._dragDataCache=null},i.CustomEvents.mixin(f),e.exports=f},function(e,t,n){"use strict";var i=n(8),o=/[\.\-0-9]+/g,r={isOldBrowser:function(){var e=r._isOldBrowser;return i.isExisty(e)||(r._isOldBrowser=e=i.browser.msie&&i.browser.version<9),e},getTranslateXY:function(e){var t;return r.isOldBrowser()?(t=e.style,[parseFloat(t.top),parseFloat(t.left)]):(t=e.getAttribute("transform"))?(t=t.match(o),[parseFloat(t[1]),parseFloat(t[0])]):[0,0]},setTranslateXY:function(e,t,n){r.isOldBrowser()?(e.style.left=t+"px",e.style.top=n+"px"):e.setAttribute("transform","translate("+t+","+n+")")},setTranslateY:function(e,t){r.isOldBrowser()?e.style.top=t+"px":e.setAttribute("transform","translate(-6,"+t+")")},setStrokeColor:function(e,t){r.isOldBrowser()?e.strokecolor=t:e.setAttribute("stroke",t)},setGradientColorStop:function(e,t){r.isOldBrowser()?e.color=t:e.setAttribute("stop-color",t)}};e.exports=r},function(e,t,n){(function(t){"use strict";var i=n(8),o=['<div class="{{cssPrefix}}slider-left {{cssPrefix}}slider-part">{{slider}}</div>','<div class="{{cssPrefix}}slider-right {{cssPrefix}}slider-part">{{huebar}}</div>'].join("\n"),r=['<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-slider">',"<defs>",'<linearGradient id="{{cssPrefix}}svg-fill-color" x1="0%" y1="0%" x2="100%" y2="0%">','<stop offset="0%" stop-color="rgb(255,255,255)" />','<stop class="{{cssPrefix}}slider-basecolor" offset="100%" stop-color="rgb(255,0,0)" />',"</linearGradient>",'<linearGradient id="{{cssPrefix}}svn-fill-black" x1="0%" y1="0%" x2="0%" y2="100%">','<stop offset="0%" style="stop-color:rgb(0,0,0);stop-opacity:0" />','<stop offset="100%" style="stop-color:rgb(0,0,0);stop-opacity:1" />',"</linearGradient>","</defs>",'<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svg-fill-color)"></rect>','<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svn-fill-black)"></rect>','<path transform="translate(0,0)" class="{{cssPrefix}}slider-handle" d="M0 7.5 L15 7.5 M7.5 15 L7.5 0 M2 7 a5.5 5.5 0 1 1 0 1 Z" stroke="black" stroke-width="0.75" fill="none" />',"</svg>"].join("\n"),a=['<div class="{{cssPrefix}}vml-slider">','<v:rect strokecolor="none" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">','<v:fill class="{{cssPrefix}}vml {{cssPrefix}}slider-basecolor" type="gradient" method="none" color="#ff0000" color2="#fff" angle="90" />',"</v:rect>",'<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">','<v:fill type="gradient" method="none" color="black" color2="white" o:opacity2="0%" class="{{cssPrefix}}vml" />',"</v:rect>",'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}slider-handle" coordsize="1 1" style="width:1px;height:1px;"path="m 0,7 l 14,7 m 7,14 l 7,0 ar 12,12 2,2 z" filled="false" stroked="true" />',"</div>"].join("\n"),s=['<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-huebar">',"<defs>",'<linearGradient id="g" x1="0%" y1="0%" x2="0%" y2="100%">','<stop offset="0%" stop-color="rgb(255,0,0)" />','<stop offset="16.666%" stop-color="rgb(255,255,0)" />','<stop offset="33.333%" stop-color="rgb(0,255,0)" />','<stop offset="50%" stop-color="rgb(0,255,255)" />','<stop offset="66.666%" stop-color="rgb(0,0,255)" />','<stop offset="83.333%" stop-color="rgb(255,0,255)" />','<stop offset="100%" stop-color="rgb(255,0,0)" />',"</linearGradient>","</defs>",'<rect width="18px" height="100%" fill="url(#g)"></rect>','<path transform="translate(-6,-3)" class="{{cssPrefix}}huebar-handle" d="M0 0 L4 4 L0 8 L0 0 Z" fill="black" stroke="none" />',"</svg>"].join("\n"),c=['<div class="{{cssPrefix}}vml-huebar">','<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-huebar-bg">','<v:fill type="gradient" method="none" colors="0% rgb(255,0,0), 16.666% rgb(255,255,0), 33.333% rgb(0,255,0), 50% rgb(0,255,255), 66.666% rgb(0,0,255), 83.333% rgb(255,0,255), 100% rgb(255,0,0)" angle="180" class="{{cssPrefix}}vml" />',"</v:rect>",'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}huebar-handle" coordsize="1 1" style="width:1px;height:1px;position:absolute;z-index:1;right:22px;top:-3px;"path="m 0,0 l 4,4 l 0,8 l 0,0 z" filled="true" fillcolor="black" stroked="false" />',"</div>"].join("\n"),l=i.browser.msie&&i.browser.version<9;l&&t.document.namespaces.add("v","urn:schemas-microsoft-com:vml"),e.exports={layout:o,slider:l?a:r,huebar:l?c:s}}).call(t,function(){return this}())}])},e.exports=i(n(0))},function(e,t){Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null})
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */,"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(e){"use strict";if("Element"in e){var t=e.Element.prototype,n=Object,i=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},r=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},s=function(e){for(var t=i.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],o=0,r=n.length;o<r;o++)this.push(n[o]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=s.prototype=[],l=function(){return new s(this)};if(r.prototype=Error.prototype,c.item=function(e){return this[e]||null},c.contains=function(e){return-1!==a(this,e+="")},c.add=function(){var e,t=arguments,n=0,i=t.length,o=!1;do{e=t[n]+"",-1===a(this,e)&&(this.push(e),o=!0)}while(++n<i);o&&this._updateClassName()},c.remove=function(){var e,t,n=arguments,i=0,o=n.length,r=!1;do{for(e=n[i]+"",t=a(this,e);-1!==t;)this.splice(t,1),r=!0,t=a(this,e)}while(++i<o);r&&this._updateClassName()},c.toggle=function(e,t){e+="";var n=this.contains(e),i=n?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!n},c.toString=function(){return this.join(" ")},n.defineProperty){var u={get:l,enumerable:!0,configurable:!0};try{n.defineProperty(t,"classList",u)}catch(e){void 0!==e.number&&-2146823252!==e.number||(u.enumerable=!1,n.defineProperty(t,"classList",u))}}else n.prototype.__defineGetter__&&t.__defineGetter__("classList",l)}}(window.self),function(){"use strict";var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var n,i=arguments.length;for(n=0;n<i;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}e=null}())
/*!
 * @copyright Copyright (c) 2017 IcoMoon.io
 * @license   Licensed under MIT license
 *            See https://github.com/Keyamoon/svgxuse
 * @version   1.2.6
 */,
/*!
 * @copyright Copyright (c) 2017 IcoMoon.io
 * @license   Licensed under MIT license
 *            See https://github.com/Keyamoon/svgxuse
 * @version   1.2.6
 */
function(){"use strict";if("undefined"!=typeof window&&window.addEventListener){var e,t,n,i=Object.create(null),o=function(){clearTimeout(t),t=setTimeout(e,100)},r=function(){},a=function(){var e;window.addEventListener("resize",o,!1),window.addEventListener("orientationchange",o,!1),window.MutationObserver?((e=new MutationObserver(o)).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}),r=function(){try{e.disconnect(),window.removeEventListener("resize",o,!1),window.removeEventListener("orientationchange",o,!1)}catch(e){}}):(document.documentElement.addEventListener("DOMSubtreeModified",o,!1),r=function(){document.documentElement.removeEventListener("DOMSubtreeModified",o,!1),window.removeEventListener("resize",o,!1),window.removeEventListener("orientationchange",o,!1)})},s=function(e){function t(e){var t;return void 0!==e.protocol?t=e:(t=document.createElement("a")).href=e,t.protocol.replace(/:/g,"")+t.host}var n,i,o;return window.XMLHttpRequest&&(n=new XMLHttpRequest,i=t(location),o=t(e),n=void 0===n.withCredentials&&""!==o&&o!==i?XDomainRequest||void 0:XMLHttpRequest),n},c="http://www.w3.org/1999/xlink";e=function(){var e,t,n,o,l,u,h,d,f,p,g=0;function v(){0===(g-=1)&&(r(),a())}function m(e){return function(){!0!==i[e.base]&&(e.useEl.setAttributeNS(c,"xlink:href","#"+e.hash),e.useEl.hasAttribute("href")&&e.useEl.setAttribute("href","#"+e.hash))}}function b(e){return function(){var t,n=document.body,i=document.createElement("x");e.onload=null,i.innerHTML=e.responseText,(t=i.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",n.insertBefore(t,n.firstChild)),v()}}function y(e){return function(){e.onerror=null,e.ontimeout=null,v()}}for(r(),f=document.getElementsByTagName("use"),l=0;l<f.length;l+=1){try{t=f[l].getBoundingClientRect()}catch(e){t=!1}e=(d=(o=f[l].getAttribute("href")||f[l].getAttributeNS(c,"href")||f[l].getAttribute("xlink:href"))&&o.split?o.split("#"):["",""])[0],n=d[1],u=t&&0===t.left&&0===t.right&&0===t.top&&0===t.bottom,t&&0===t.width&&0===t.height&&!u?(f[l].hasAttribute("href")&&f[l].setAttributeNS(c,"xlink:href",o),e.length&&(!0!==(p=i[e])&&setTimeout(m({useEl:f[l],base:e,hash:n}),0),void 0===p&&void 0!==(h=s(e))&&(p=new h,i[e]=p,p.onload=b(p),p.onerror=y(p),p.ontimeout=y(p),p.open("GET",e),p.send(),g+=1))):u?e.length&&i[e]&&setTimeout(m({useEl:f[l],base:e,hash:n}),0):void 0===i[e]?i[e]=!0:i[e].onload&&(i[e].abort(),delete i[e].onload,i[e]=!0)}f="",g+=1,v()},n=function(){window.removeEventListener("load",n,!1),t=setTimeout(e,0)},"complete"!==document.readyState?window.addEventListener("load",n,!1):n()}}()},function(e,t){},function(e,t,n){"use strict";var i=n(38)(!0);n(22)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var i=n(15),o=n(16);e.exports=function(e){return function(t,n){var r,a,s=String(o(t)),c=i(n),l=s.length;return c<0||c>=l?e?"":void 0:(r=s.charCodeAt(c))<55296||r>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):r:e?s.slice(c,c+2):a-56320+(r-55296<<10)+65536}}},function(e,t,n){e.exports=!n(8)&&!n(25)(function(){return 7!=Object.defineProperty(n(18)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(12);e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){e.exports=n(5)},function(e,t,n){"use strict";var i=n(43),o=n(26),r=n(21),a={};n(5)(a,n(3)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(a,{next:o(1,n)}),r(e,t+" Iterator")}},function(e,t,n){var i=n(6),o=n(44),r=n(30),a=n(20)("IE_PROTO"),s=function(){},c=function(){var e,t=n(18)("iframe"),i=r.length;for(t.style.display="none",n(31).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;i--;)delete c.prototype[r[i]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[a]=e):n=c(),void 0===t?n:o(n,t)}},function(e,t,n){var i=n(11),o=n(6),r=n(45);e.exports=n(8)?Object.defineProperties:function(e,t){o(e);for(var n,a=r(t),s=a.length,c=0;s>c;)i.f(e,n=a[c++],t[n]);return e}},function(e,t,n){var i=n(46),o=n(30);e.exports=Object.keys||function(e){return i(e,o)}},function(e,t,n){var i=n(13),o=n(19),r=n(48)(!1),a=n(20)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),c=0,l=[];for(n in s)n!=a&&i(s,n)&&l.push(n);for(;t.length>c;)i(s,n=t[c++])&&(~r(l,n)||l.push(n));return l}},function(e,t,n){var i=n(14);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){var i=n(19),o=n(27),r=n(49);e.exports=function(e){return function(t,n,a){var s,c=i(t),l=o(c.length),u=r(a,l);if(e&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},function(e,t,n){var i=n(15),o=Math.max,r=Math.min;e.exports=function(e,t){return(e=i(e))<0?o(e+t,0):r(e,t)}},function(e,t,n){var i=n(13),o=n(51),r=n(20)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var i=n(16);e.exports=function(e){return Object(i(e))}},function(e,t,n){n(53);for(var i=n(4),o=n(5),r=n(9),a=n(3)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var l=s[c],u=i[l],h=u&&u.prototype;h&&!h[a]&&o(h,a,l),r[l]=r.Array}},function(e,t,n){"use strict";var i=n(54),o=n(55),r=n(9),a=n(19);e.exports=n(22)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i,o,r,a=n(23),s=n(4),c=n(10),l=n(32),u=n(24),h=n(12),d=n(17),f=n(57),p=n(58),g=n(62),v=n(33).set,m=n(64)(),b=s.TypeError,y=s.process,_=s.Promise,k="process"==l(y=s.process),w=function(){},x=!!function(){try{var e=_.resolve(1),t=(e.constructor={})[n(3)("species")]=function(e){e(w,w)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(w)instanceof t}catch(e){}}(),E=function(e,t){return e===t||e===_&&t===r},S=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},C=function(e){return E(_,e)?new O(e):new o(e)},O=o=function(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw b("Bad Promise constructor");t=e,n=i}),this.resolve=d(t),this.reject=d(n)},j=function(e){try{e()}catch(e){return{error:e}}},P=function(e,t){if(!e._n){e._n=!0;var n=e._c;m(function(){for(var i=e._v,o=1==e._s,r=0,a=function(t){var n,r,a=o?t.ok:t.fail,s=t.resolve,c=t.reject,l=t.domain;try{a?(o||(2==e._h&&A(e),e._h=1),!0===a?n=i:(l&&l.enter(),n=a(i),l&&l.exit()),n===t.promise?c(b("Promise-chain cycle")):(r=S(n))?r.call(n,s,c):s(n)):c(i)}catch(e){c(e)}};n.length>r;)a(n[r++]);e._c=[],e._n=!1,t&&!e._h&&T(e)})}},T=function(e){v.call(s,function(){var t,n,i,o=e._v;if(M(e)&&(t=j(function(){k?y.emit("unhandledRejection",o,e):(n=s.onunhandledrejection)?n({promise:e,reason:o}):(i=s.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=k||M(e)?2:1),e._a=void 0,t)throw t.error})},M=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,i=0;n.length>i;)if((t=n[i++]).fail||!M(t.promise))return!1;return!0},A=function(e){v.call(s,function(){var t;k?y.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},D=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),P(t,!0))},I=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw b("Promise can't be resolved itself");(t=S(e))?m(function(){var i={_w:n,_d:!1};try{t.call(e,c(I,i,1),c(D,i,1))}catch(e){D.call(i,e)}}):(n._v=e,n._s=1,P(n,!1))}catch(e){D.call({_w:n,_d:!1},e)}}};x||(_=function(e){f(this,_,"Promise","_h"),d(e),i.call(this);try{e(c(I,this,1),c(D,this,1))}catch(e){D.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(65)(_.prototype,{then:function(e,t){var n=C(g(this,_));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=k?y.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),O=function(){var e=new i;this.promise=e,this.resolve=c(I,e,1),this.reject=c(D,e,1)}),u(u.G+u.W+u.F*!x,{Promise:_}),n(21)(_,"Promise"),n(66)("Promise"),r=n(7).Promise,u(u.S+u.F*!x,"Promise",{reject:function(e){var t=C(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(a||!x),"Promise",{resolve:function(e){if(e instanceof _&&E(e.constructor,this))return e;var t=C(this);return(0,t.resolve)(e),t.promise}}),u(u.S+u.F*!(x&&n(67)(function(e){_.all(e).catch(w)})),"Promise",{all:function(e){var t=this,n=C(t),i=n.resolve,o=n.reject,r=j(function(){var n=[],r=0,a=1;p(e,!1,function(e){var s=r++,c=!1;n.push(void 0),a++,t.resolve(e).then(function(e){c||(c=!0,n[s]=e,--a||i(n))},o)}),--a||i(n)});return r&&o(r.error),n.promise},race:function(e){var t=this,n=C(t),i=n.reject,o=j(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return o&&i(o.error),n.promise}})},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var i=n(10),o=n(59),r=n(60),a=n(6),s=n(27),c=n(61),l={},u={};(t=e.exports=function(e,t,n,h,d){var f,p,g,v,m=d?function(){return e}:c(e),b=i(n,h,t?2:1),y=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(r(m)){for(f=s(e.length);f>y;y++)if((v=t?b(a(p=e[y])[0],p[1]):b(e[y]))===l||v===u)return v}else for(g=m.call(e);!(p=g.next()).done;)if((v=o(g,b,p.value,t))===l||v===u)return v}).BREAK=l,t.RETURN=u},function(e,t,n){var i=n(6);e.exports=function(e,t,n,o){try{return o?t(i(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&i(r.call(e)),t}}},function(e,t,n){var i=n(9),o=n(3)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[o]===e)}},function(e,t,n){var i=n(32),o=n(3)("iterator"),r=n(9);e.exports=n(7).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||r[i(e)]}},function(e,t,n){var i=n(6),o=n(17),r=n(3)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[r])?t:o(n)}},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(4),o=n(33).set,r=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,c="process"==n(14)(a);e.exports=function(){var e,t,n,l=function(){var i,o;for(c&&(i=a.domain)&&i.exit();e;){o=e.fn,e=e.next;try{o()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(c)n=function(){a.nextTick(l)};else if(r){var u=!0,h=document.createTextNode("");new r(l).observe(h,{characterData:!0}),n=function(){h.data=u=!u}}else if(s&&s.resolve){var d=s.resolve();n=function(){d.then(l)}}else n=function(){o.call(i,l)};return function(i){var o={fn:i,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){var i=n(5);e.exports=function(e,t,n){for(var o in t)n&&e[o]?e[o]=t[o]:i(e,o,t[o]);return e}},function(e,t,n){"use strict";var i=n(4),o=n(7),r=n(11),a=n(8),s=n(3)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:i[e];a&&t&&!t[s]&&r.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var i=n(3)("iterator"),o=!1;try{var r=[7][i]();r.return=function(){o=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var r=[7],a=r[i]();a.next=function(){return{done:n=!0}},r[i]=function(){return a},e(r)}catch(e){}return n}},function(e,t,n){"use strict";n.r(t);n(35);var i=n(0),o=n.n(i),r=n(1),a=n.n(r),s=Math.min,c=Math.max,l=!1;function u(e,t,n){var i;return t>n&&(i=t,t=n,n=i),c(t,s(e,n))}function h(){for(var e={},t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return Object(i.forEach)(n,function(t){e[t]=t}),e}function d(e,t){var n,i={},o=t.length,r=0;for(r=0;r<o;r+=1)i[n=t[r]]=e[n];return i}function f(e){return parseInt(e,10)}function p(){return!!(window.File&&window.FileList&&window.FileReader)}function g(e,t){4===e.length&&(e="".concat(e).concat(e.slice(1,4)));var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),o=parseInt(e.slice(5,7),16),r=t||1;return"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(r,")")}var v=h("UN_IMPLEMENTATION","NO_COMPONENT_NAME"),m="Should implement a method: ",b="Should set a component name",y={UN_IMPLEMENTATION:function(e){return m+e},NO_COMPONENT_NAME:function(){return b}},_={types:o.a.extend({},v),create:function(e){e=e.toLowerCase();for(var t=y[e],n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.apply(void 0,i)}};function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var w=_.create,x=_.types,E=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t.name,this.args=n,this.execute=t.execute,this.undo=t.undo,this.executeCallback=t.executeCallback||null,this.undoCallback=t.undoCallback||null,this.undoData={}}var t,n,i;return t=e,(n=[{key:"execute",value:function(){throw new Error(w(x.UN_IMPLEMENTATION,"execute"))}},{key:"undo",value:function(){throw new Error(w(x.UN_IMPLEMENTATION,"undo"))}},{key:"setExecuteCallback",value:function(e){return this.executeCallback=e,this}},{key:"setUndoCallback",value:function(e){return this.undoCallback=e,this}}])&&k(t.prototype,n),i&&k(t,i),e}(),S={};var C={create:function(e){var t=S[e];if(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return new E(t,i)}return null},register:function(e){S[e.name]=e}},O=h("IMAGE_LOADER","CROPPER","FLIP","ROTATION","FREE_DRAWING","LINE","TEXT","ICON","FILTER","SHAPE"),j={CLEAR_OBJECTS:"clearObjects",LOAD_IMAGE:"loadImage",FLIP_IMAGE:"flip",ROTATE_IMAGE:"rotate",ADD_OBJECT:"addObject",REMOVE_OBJECT:"removeObject",APPLY_FILTER:"applyFilter",REMOVE_FILTER:"removeFilter",ADD_ICON:"addIcon",CHANGE_ICON_COLOR:"changeIconColor",ADD_SHAPE:"addShape",CHANGE_SHAPE:"changeShape",ADD_TEXT:"addText",CHANGE_TEXT:"changeText",CHANGE_TEXT_STYLE:"changeTextStyle",ADD_IMAGE_OBJECT:"addImageObject",RESIZE_CANVAS_DIMENSION:"resizeCanvasDimension",SET_OBJECT_PROPERTIES:"setObjectProperties",SET_OBJECT_POSITION:"setObjectPosition"},P={OBJECT_ACTIVATED:"objectActivated",OBJECT_MOVED:"objectMoved",OBJECT_SCALED:"objectScaled",OBJECT_CREATED:"objectCreated",TEXT_EDITING:"textEditing",TEXT_CHANGED:"textChanged",ICON_CREATE_RESIZE:"iconCreateResize",ICON_CREATE_END:"iconCreateEnd",ADD_TEXT:"addText",ADD_OBJECT:"addObject",ADD_OBJECT_AFTER:"addObjectAfter",MOUSE_DOWN:"mousedown",MOUSE_UP:"mouseup",MOUSE_MOVE:"mousemove",REDO_STACK_CHANGED:"redoStackChanged",UNDO_STACK_CHANGED:"undoStackChanged",SELECTION_CLEARED:"selectionCleared",SELECTION_CREATED:"selectionCreated"},T=h("NORMAL","CROPPER","FREE_DRAWING","LINE_DRAWING","TEXT","SHAPE"),M={Z:90,Y:89,SHIFT:16,BACKSPACE:8,DEL:46},A={SELECTION_STYLE:{borderColor:"red",cornerColor:"green",cornerSize:10,originX:"center",originY:"center",transparentCorners:!1}},D={flip:"The flipX and flipY setting values are not changed.",rotation:"The current angle is same the old angle.",loadImage:"The background image is empty.",isLock:"The executing command state is locked.",undo:"The promise of undo command is reject.",redo:"The promise of redo command is reject.",invalidDrawingMode:"This operation is not supported in the drawing mode",invalidParameters:"Invalid parameters",noActiveObject:"There is no active object.",unsupportedType:"Unsupported object type",noObject:"The object is not in canvas.",addedObject:"The object is already added."},I={"icon-arrow":"M40 12V0l24 24-24 24V36H0V12h40z","icon-arrow-2":"M49,32 H3 V22 h46 l-18,-18 h12 l23,23 L43,50 h-12 l18,-18  z ","icon-arrow-3":"M43.349998,27 L17.354,53 H1.949999 l25.996,-26 L1.949999,1 h15.404 L43.349998,27  z ","icon-star":"M35,54.557999 l-19.912001,10.468 l3.804,-22.172001 l-16.108,-15.7 l22.26,-3.236 L35,3.746 l9.956,20.172001 l22.26,3.236 l-16.108,15.7 l3.804,22.172001  z ","icon-star-2":"M17,31.212 l-7.194,4.08 l-4.728,-6.83 l-8.234,0.524 l-1.328,-8.226 l-7.644,-3.14 l2.338,-7.992 l-5.54,-6.18 l5.54,-6.176 l-2.338,-7.994 l7.644,-3.138 l1.328,-8.226 l8.234,0.522 l4.728,-6.83 L17,-24.312 l7.194,-4.08 l4.728,6.83 l8.234,-0.522 l1.328,8.226 l7.644,3.14 l-2.338,7.992 l5.54,6.178 l-5.54,6.178 l2.338,7.992 l-7.644,3.14 l-1.328,8.226 l-8.234,-0.524 l-4.728,6.83  z ","icon-polygon":"M3,31 L19,3 h32 l16,28 l-16,28 H19  z ","icon-location":"M24 62C8 45.503 0 32.837 0 24 0 10.745 10.745 0 24 0s24 10.745 24 24c0 8.837-8 21.503-24 38zm0-28c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10z","icon-heart":"M49.994999,91.349998 l-6.96,-6.333 C18.324001,62.606995 2.01,47.829002 2.01,29.690998 C2.01,14.912998 13.619999,3.299999 28.401001,3.299999 c8.349,0 16.362,5.859 21.594,12 c5.229,-6.141 13.242001,-12 21.591,-12 c14.778,0 26.390999,11.61 26.390999,26.390999 c0,18.138 -16.314001,32.916 -41.025002,55.374001 l-6.96,6.285  z ","icon-bubble":"M44 48L34 58V48H12C5.373 48 0 42.627 0 36V12C0 5.373 5.373 0 12 0h40c6.627 0 12 5.373 12 12v24c0 6.627-5.373 12-12 12h-8z"},R={realTimeEvent:!0,min:-360,max:360,value:0},L={min:5,max:30,value:12},B={realTimeEvent:!1,min:2,max:300,value:3},F={realTimeEvent:!0,min:10,max:100,value:50},N={min:0,max:1,value:.7},H={min:0,max:255,value:60},z={min:0,max:255,value:10},U={min:0,max:255,value:100},W={min:-255,max:255,value:100},X={min:0,max:1e3,value:100},V={min:2,max:20,value:4},G={min:0,max:255,value:45};function Y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var q=P,K=D,J=o.a.isFunction,Z=o.a.isString,$=o.a.CustomEvents,Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._undoStack=[],this._redoStack=[],this._isLocked=!1}var t,n,i;return t=e,(n=[{key:"_invokeExecution",value:function(e){var t=this;this.lock();var n=e.args;return n||(n=[]),e.execute.apply(e,n).then(function(n){return t.pushUndoStack(e),t.unlock(),J(e.executeCallback)&&e.executeCallback(n),n}).catch(function(e){return t.unlock(),a.a.reject(e)})}},{key:"_invokeUndo",value:function(e){var t=this;this.lock();var n=e.args;return n||(n=[]),e.undo.apply(e,n).then(function(n){return t.pushRedoStack(e),t.unlock(),J(e.undoCallback)&&e.undoCallback(n),n}).catch(function(e){return t.unlock(),a.a.reject(e)})}},{key:"_fireRedoStackChanged",value:function(){this.fire(q.REDO_STACK_CHANGED,this._redoStack.length)}},{key:"_fireUndoStackChanged",value:function(){this.fire(q.UNDO_STACK_CHANGED,this._undoStack.length)}},{key:"lock",value:function(){this._isLocked=!0}},{key:"unlock",value:function(){this._isLocked=!1}},{key:"execute",value:function(){var e=this;if(this._isLocked)return a.a.reject(K.isLock);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0];return Z(o)&&(o=C.create.apply(C,n)),this._invokeExecution(o).then(function(t){return e.clearRedoStack(),t})}},{key:"undo",value:function(){var e,t=this._undoStack.pop(),n="";return t&&this._isLocked&&(this.pushUndoStack(t,!0),t=null),t?(this.isEmptyUndoStack()&&this._fireUndoStackChanged(),e=this._invokeUndo(t)):(n=K.undo,this._isLocked&&(n="".concat(n," Because ").concat(K.isLock)),e=a.a.reject(n)),e}},{key:"redo",value:function(){var e,t=this._redoStack.pop(),n="";return t&&this._isLocked&&(this.pushRedoStack(t,!0),t=null),t?(this.isEmptyRedoStack()&&this._fireRedoStackChanged(),e=this._invokeExecution(t)):(n=K.redo,this._isLocked&&(n="".concat(n," Because ").concat(K.isLock)),e=a.a.reject(n)),e}},{key:"pushUndoStack",value:function(e,t){this._undoStack.push(e),t||this._fireUndoStackChanged()}},{key:"pushRedoStack",value:function(e,t){this._redoStack.push(e),t||this._fireRedoStackChanged()}},{key:"isEmptyRedoStack",value:function(){return 0===this._redoStack.length}},{key:"isEmptyUndoStack",value:function(){return 0===this._undoStack.length}},{key:"clearUndoStack",value:function(){this.isEmptyUndoStack()||(this._undoStack=[],this._fireUndoStackChanged())}},{key:"clearRedoStack",value:function(){this.isEmptyRedoStack()||(this._redoStack=[],this._fireRedoStackChanged())}}])&&Y(t.prototype,n),i&&Y(t,i),e}();$.mixin(Q);var ee=Q,te={"common.bi.image":"https://uicdn.toast.com/toastui/img/tui-image-editor-bi.png","common.bisize.width":"251px","common.bisize.height":"21px","common.backgroundImage":"none","common.backgroundColor":"#1e1e1e","common.border":"0px","header.backgroundImage":"none","header.backgroundColor":"transparent","header.border":"0px","loadButton.backgroundColor":"#fff","loadButton.border":"1px solid #ddd","loadButton.color":"#222","loadButton.fontFamily":"'Noto Sans', sans-serif","loadButton.fontSize":"12px","downloadButton.backgroundColor":"#fdba3b","downloadButton.border":"1px solid #fdba3b","downloadButton.color":"#fff","downloadButton.fontFamily":"'Noto Sans', sans-serif","downloadButton.fontSize":"12px","menu.normalIcon.path":"icon-d.svg","menu.normalIcon.name":"icon-d","menu.activeIcon.path":"icon-b.svg","menu.activeIcon.name":"icon-b","menu.disabledIcon.path":"icon-a.svg","menu.disabledIcon.name":"icon-a","menu.hoverIcon.path":"icon-c.svg","menu.hoverIcon.name":"icon-c","menu.iconSize.width":"24px","menu.iconSize.height":"24px","submenu.backgroundColor":"#1e1e1e","submenu.partition.color":"#3c3c3c","submenu.normalIcon.path":"icon-d.svg","submenu.normalIcon.name":"icon-d","submenu.activeIcon.path":"icon-c.svg","submenu.activeIcon.name":"icon-c","submenu.iconSize.width":"32px","submenu.iconSize.height":"32px","submenu.normalLabel.color":"#8a8a8a","submenu.normalLabel.fontWeight":"lighter","submenu.activeLabel.color":"#fff","submenu.activeLabel.fontWeight":"lighter","checkbox.border":"0px","checkbox.backgroundColor":"#fff","range.pointer.color":"#fff","range.bar.color":"#666","range.subbar.color":"#d1d1d1","range.disabledPointer.color":"#414141","range.disabledBar.color":"#282828","range.disabledSubbar.color":"#414141","range.value.color":"#fff","range.value.fontWeight":"lighter","range.value.fontSize":"11px","range.value.border":"1px solid #353535","range.value.backgroundColor":"#151515","range.title.color":"#fff","range.title.fontWeight":"lighter","colorpicker.button.border":"1px solid #1e1e1e","colorpicker.title.color":"#fff"};function ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ie=function(){function e(t){var n,o,r,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.styles=this._changeToObject(Object(i.extend)(te,t)),n=this._styleMaker(),r=document.getElementsByTagName("head")[0],a=document.createElement("link"),s=encodeURIComponent(n),o&&(a.id=o),a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href","data:text/css;charset=UTF-8,".concat(s)),r.appendChild(a)}var t,n,o;return t=e,(n=[{key:"getStyle",value:function(e){var t=null,n=e.replace(/\..+$/,""),o=this.styles[e];switch(e){case"common.bi":t=this.styles[e].image;break;case"menu.icon":case"submenu.icon":t={active:this.styles["".concat(n,".activeIcon")],normal:this.styles["".concat(n,".normalIcon")],hover:this.styles["".concat(n,".hoverIcon")],disabled:this.styles["".concat(n,".disabledIcon")]};break;case"submenu.label":t={active:this._makeCssText(this.styles["".concat(n,".activeLabel")]),normal:this._makeCssText(this.styles["".concat(n,".normalLabel")])};break;case"submenu.partition":t={vertical:this._makeCssText(Object(i.extend)({},o,{borderLeft:"1px solid ".concat(o.color)})),horizontal:this._makeCssText(Object(i.extend)({},o,{borderBottom:"1px solid ".concat(o.color)}))};break;case"range.disabledPointer":case"range.disabledBar":case"range.disabledSubbar":case"range.pointer":case"range.bar":case"range.subbar":o.backgroundColor=o.color,t=this._makeCssText(o);break;default:t=this._makeCssText(o)}return t}},{key:"_styleMaker",value:function(){var e,t,n,i,o,r,a,s,c,l,u,h,d,f,p,g,v,m,b,y=this.getStyle("submenu.label"),_=this.getStyle("submenu.partition");return e={subMenuLabelActive:y.active,subMenuLabelNormal:y.normal,submenuPartitionVertical:_.vertical,submenuPartitionHorizontal:_.horizontal,biSize:this.getStyle("common.bisize"),subMenuRangeTitle:this.getStyle("range.title"),submenuRangePointer:this.getStyle("range.pointer"),submenuRangeBar:this.getStyle("range.bar"),submenuRangeSubbar:this.getStyle("range.subbar"),submenuDisabledRangePointer:this.getStyle("range.disabledPointer"),submenuDisabledRangeBar:this.getStyle("range.disabledBar"),submenuDisabledRangeSubbar:this.getStyle("range.disabledSubbar"),submenuRangeValue:this.getStyle("range.value"),submenuColorpickerTitle:this.getStyle("colorpicker.title"),submenuColorpickerButton:this.getStyle("colorpicker.button"),submenuCheckbox:this.getStyle("checkbox"),menuIconSize:this.getStyle("menu.iconSize"),submenuIconSize:this.getStyle("submenu.iconSize")},t=e.subMenuLabelActive,n=e.subMenuLabelNormal,i=e.subMenuRangeTitle,o=e.submenuPartitionVertical,r=e.submenuPartitionHorizontal,a=e.submenuCheckbox,s=e.submenuRangePointer,c=e.submenuRangeValue,l=e.submenuColorpickerTitle,u=e.submenuColorpickerButton,h=e.submenuRangeBar,d=e.submenuRangeSubbar,f=e.submenuDisabledRangePointer,p=e.submenuDisabledRangeBar,g=e.submenuDisabledRangeSubbar,v=e.submenuIconSize,m=e.menuIconSize,b=e.biSize,'\n    #tie-icon-add-button.icon-bubble .tui-image-editor-button[data-icontype="icon-bubble"] label,\n    #tie-icon-add-button.icon-heart .tui-image-editor-button[data-icontype="icon-heart"] label,\n    #tie-icon-add-button.icon-location .tui-image-editor-button[data-icontype="icon-location"] label,\n    #tie-icon-add-button.icon-polygon .tui-image-editor-button[data-icontype="icon-polygon"] label,\n    #tie-icon-add-button.icon-star .tui-image-editor-button[data-icontype="icon-star"] label,\n    #tie-icon-add-button.icon-arrow-3 .tui-image-editor-button[data-icontype="icon-arrow-3"] label,\n    #tie-icon-add-button.icon-arrow-2 .tui-image-editor-button[data-icontype="icon-arrow-2"] label,\n    #tie-icon-add-button.icon-arrow .tui-image-editor-button[data-icontype="icon-arrow"] label,\n    #tie-icon-add-button.icon-bubble .tui-image-editor-button[data-icontype="icon-bubble"] label,\n    #tie-draw-line-select-button.line .tui-image-editor-button.line label,\n    #tie-draw-line-select-button.free .tui-image-editor-button.free label,\n    #tie-flip-button.flipX .tui-image-editor-button.flipX label,\n    #tie-flip-button.flipY .tui-image-editor-button.flipY label,\n    #tie-flip-button.resetFlip .tui-image-editor-button.resetFlip label,\n    #tie-crop-button .tui-image-editor-button.apply.active label,\n    #tie-crop-preset-button .tui-image-editor-button.preset.active label,\n    #tie-shape-button.rect .tui-image-editor-button.rect label,\n    #tie-shape-button.circle .tui-image-editor-button.circle label,\n    #tie-shape-button.triangle .tui-image-editor-button.triangle label,\n    #tie-text-effect-button .tui-image-editor-button.active label,\n    #tie-text-align-button.left .tui-image-editor-button.left label,\n    #tie-text-align-button.center .tui-image-editor-button.center label,\n    #tie-text-align-button.right .tui-image-editor-button.right label,\n    #tie-mask-apply.apply.active .tui-image-editor-button.apply label,\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button:hover > label,\n    .tui-image-editor-container .tui-image-editor-checkbox input + label {\n        '.concat(t,"\n    }\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button > label,\n    .tui-image-editor-container .tui-image-editor-range-wrap.tui-image-editor-newline.short label {\n        ").concat(n,"\n    }\n    .tui-image-editor-container .tui-image-editor-range-wrap label {\n        ").concat(i,"\n    }\n    .tui-image-editor-container .tui-image-editor-partition > div {\n        ").concat(o,"\n    }\n    .tui-image-editor-container.left .tui-image-editor-submenu .tui-image-editor-partition > div,\n    .tui-image-editor-container.right .tui-image-editor-submenu .tui-image-editor-partition > div {\n        ").concat(r,"\n    }\n    .tui-image-editor-container .tui-image-editor-checkbox input + label:before {\n        ").concat(a,"\n    }\n    .tui-image-editor-container .tui-image-editor-checkbox input:checked + label:before {\n        border: 0;\n    }\n    .tui-image-editor-container .tui-image-editor-virtual-range-pointer {\n        ").concat(s,"\n    }\n    .tui-image-editor-container .tui-image-editor-virtual-range-bar {\n        ").concat(h,"\n    }\n    .tui-image-editor-container .tui-image-editor-virtual-range-subbar {\n        ").concat(d,"\n    }\n    .tui-image-editor-container .tui-image-editor-disabled .tui-image-editor-virtual-range-pointer {\n        ").concat(f,"\n    }\n    .tui-image-editor-container .tui-image-editor-disabled .tui-image-editor-virtual-range-subbar {\n        ").concat(g,"\n    }\n    .tui-image-editor-container .tui-image-editor-disabled .tui-image-editor-virtual-range-bar {\n        ").concat(p,"\n    }\n    .tui-image-editor-container .tui-image-editor-range-value {\n        ").concat(c,"\n    }\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button .color-picker-value + label {\n        ").concat(l,"\n    }\n    .tui-image-editor-container .tui-image-editor-submenu .tui-image-editor-button .color-picker-value {\n        ").concat(u,"\n    }\n    .tui-image-editor-container .svg_ic-menu {\n        ").concat(m,"\n    }\n    .tui-image-editor-container .svg_ic-submenu {\n        ").concat(v,"\n    }\n    .tui-image-editor-container .tui-image-editor-controls-logo > img,\n    .tui-image-editor-container .tui-image-editor-header-logo > img {\n        ").concat(b,"\n    }\n\n")}},{key:"_changeToObject",value:function(e){var t={};return Object(i.forEach)(e,function(e,n){var i=n.match(/^(.+)\.([a-z]+)$/i),o=i[1],r=i[2];t[o]||(t[o]={}),t[o][r]=e}),t}},{key:"_makeCssText",value:function(e){var t=this,n=[];return Object(i.forEach)(e,function(e,i){["backgroundImage"].indexOf(i)>-1&&"none"!==e&&(e="url(".concat(e,")")),n.push("".concat(t._toUnderScore(i),": ").concat(e))}),n.join(";")}},{key:"_toUnderScore",value:function(e){return e.replace(/([A-Z])/g,function(e,t){return"-".concat(t.toLowerCase())})}}])&&ne(t.prototype,n),o&&ne(t,o),e}(),oe=n(34),re=n.n(oe);function ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var se=["#000000","#2a2a2a","#545454","#7e7e7e","#a8a8a8","#d2d2d2","#ffffff","","#ff4040","#ff6518","#ffbb3b","#03bd9e","#00a9ff","#515ce6","#9e5fff","#ff5583"],ce=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#7e7e7e",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"up";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o=t.getAttribute("title");this._show=!1,this._colorpickerElement=t,this._toggleDirection=i,this._makePickerButtonElement(t,n),this._makePickerLayerElement(t,o),this._color=n,this.picker=re.a.create({container:this.pickerElement,preset:se,color:n}),this._addEvent(t)}var t,n,i;return t=e,(n=[{key:"_changeColorElement",value:function(e){e?(this.colorElement.classList.remove("transparent"),this.colorElement.style.backgroundColor=e):(this.colorElement.style.backgroundColor="#fff",this.colorElement.classList.add("transparent"))}},{key:"_makePickerButtonElement",value:function(e,t){e.classList.add("tui-image-editor-button"),this.colorElement=document.createElement("div"),this.colorElement.className="color-picker-value",t?this.colorElement.style.backgroundColor=t:this.colorElement.classList.add("transparent")}},{key:"_makePickerLayerElement",value:function(e,t){var n=document.createElement("label"),i=document.createElement("div");this.pickerControl=document.createElement("div"),this.pickerControl.className="color-picker-control",this.pickerElement=document.createElement("div"),this.pickerElement.className="color-picker",n.innerHTML=t,i.className="triangle",this.pickerControl.appendChild(this.pickerElement),this.pickerControl.appendChild(i),e.appendChild(this.pickerControl),e.appendChild(this.colorElement),e.appendChild(n)}},{key:"_addEvent",value:function(e){var t=this;this.picker.on("selectColor",function(e){t._changeColorElement(e.color),t._color=e.color,t.fire("change",e.color)}),e.addEventListener("click",function(e){t._show=!t._show,t.pickerControl.style.display=t._show?"block":"none",t._setPickerControlPosition(),t.fire("changeShow",t),e.stopPropagation()}),document.body.addEventListener("click",function(){t.hide()})}},{key:"hide",value:function(){this._show=!1,this.pickerControl.style.display="none"}},{key:"_setPickerControlPosition",value:function(){var e=this.pickerControl.style,t=this._colorpickerElement.clientWidth/2+2,n=this.pickerControl.offsetWidth/2-t,i=-1*(this.pickerControl.offsetHeight+10);"down"===this._toggleDirection&&(i=30),e.top="".concat(i,"px"),e.left="-".concat(n,"px")}},{key:"color",get:function(){return this._color},set:function(e){this._color=e,this._changeColorElement(e)}}])&&ae(t.prototype,n),i&&ae(t,i),e}();o.a.CustomEvents.mixin(ce);var le=ce;function ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var he=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=n.value||0,this.rangeElement=t,this._drawRangeElement(),this.rangeWidth=f(window.getComputedStyle(t,null).width)-12,this._min=n.min||0,this._max=n.max||100,this._absMax=-1*this._min+this._max,this.realTimeEvent=n.realTimeEvent||!1,this._addClickEvent(),this._addDragEvent(),this.value=n.value,this.trigger("change")}var t,n,i;return t=e,(n=[{key:"trigger",value:function(e){this.fire(e,this._value)}},{key:"_drawRangeElement",value:function(){this.rangeElement.classList.add("tui-image-editor-range"),this.bar=document.createElement("div"),this.bar.className="tui-image-editor-virtual-range-bar",this.subbar=document.createElement("div"),this.subbar.className="tui-image-editor-virtual-range-subbar",this.pointer=document.createElement("div"),this.pointer.className="tui-image-editor-virtual-range-pointer",this.bar.appendChild(this.subbar),this.bar.appendChild(this.pointer),this.rangeElement.appendChild(this.bar)}},{key:"_addClickEvent",value:function(){var e=this;this.rangeElement.addEventListener("click",function(t){if(t.stopPropagation(),"tui-image-editor-range"===t.target.className){var n=t.offsetX/e.rangeWidth,i=e._absMax*n+e._min;e.pointer.style.left="".concat(n*e.rangeWidth,"px"),e.subbar.style.right="".concat((1-n)*e.rangeWidth,"px"),e._value=i,e.fire("change",i)}})}},{key:"_addDragEvent",value:function(){var e=this;this.pointer.addEventListener("mousedown",function(t){e.firstPosition=t.screenX,e.firstLeft=f(e.pointer.style.left)||0,e.dragEventHandler={changeAngle:e._changeAngle.bind(e),stopChangingAngle:e._stopChangingAngle.bind(e)},document.addEventListener("mousemove",e.dragEventHandler.changeAngle),document.addEventListener("mouseup",e.dragEventHandler.stopChangingAngle)})}},{key:"_changeAngle",value:function(e){var t=e.screenX-this.firstPosition,n=this.firstLeft+t;n=(n=n>this.rangeWidth?this.rangeWidth:n)<0?0:n,this.pointer.style.left="".concat(n,"px"),this.subbar.style.right="".concat(this.rangeWidth-n,"px");var i=n/this.rangeWidth,o=this._absMax*i+this._min;this._value=o,this.realTimeEvent&&this.fire("change",o)}},{key:"_stopChangingAngle",value:function(){this.fire("change",this._value),document.removeEventListener("mousemove",this.dragEventHandler.changeAngle),document.removeEventListener("mouseup",this.dragEventHandler.stopChangingAngle)}},{key:"max",set:function(e){this._max=e,this._absMax=-1*this._min+this._max,this.value=this._value},get:function(){return this._max}},{key:"value",get:function(){return this._value},set:function(e){var t=(e-this._min)*this.rangeWidth/this._absMax;this.rangeWidth<t&&(t=this.rangeWidth),this.pointer.style.left="".concat(t,"px"),this.subbar.style.right="".concat(this.rangeWidth-t,"px"),this._value=e}}])&&ue(t.prototype,n),i&&ue(t,i),e}();o.a.CustomEvents.mixin(he);var de=he;function fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var pe=function(){function e(t,n){var i=n.name,o=n.iconStyle,r=n.menuBarPosition,a=n.templateHtml;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=function(e){return t.querySelector(e)},this.menuBarPosition=r,this.toggleDirection="top"===r?"down":"up",this.colorPickerControls=[],this._makeSubMenuElement(t,{name:i,iconStyle:o,templateHtml:a})}var t,n,i;return t=e,(n=[{key:"colorPickerChangeShow",value:function(e){this.colorPickerControls.forEach(function(t){e!==t&&t.hide()})}},{key:"getButtonType",value:function(e,t){return e.className.match(RegExp("(".concat(t.join("|"),")")))[0]}},{key:"changeClass",value:function(e,t,n){e.classList.remove(t),e.classList.add(n)}},{key:"changeStandbyMode",value:function(){}},{key:"changeStartMode",value:function(){}},{key:"_makeSubMenuElement",value:function(e,t){var n=t.name,i=t.iconStyle,o=t.templateHtml,r=document.createElement("div");r.className="tui-image-editor-menu-".concat(n),r.innerHTML=o({iconStyle:i}),e.appendChild(r)}}])&&fe(t.prototype,n),i&&fe(t,i),e}(),ge=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-shape-button">\n            <div class="tui-image-editor-button rect">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-shape-rectangle"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-shape-rectangle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> Rectangle </label>\n            </div>\n            <div class="tui-image-editor-button circle">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-shape-circle"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-shape-circle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> Circle </label>\n            </div>\n            <div class="tui-image-editor-button triangle">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-shape-triangle"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-shape-triangle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> Triangle </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li id="tie-shape-color-button">\n            <div id="tie-color-fill" title="Fill"></div>\n            <div id="tie-color-stroke" title="Stroke"></div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">Stroke</label>\n            <div id="tie-stroke-range"></div>\n            <input id="tie-stroke-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n')};function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function be(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ke={stroke:"#ffbb3b",fill:"",strokeWidth:3},we=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-crop-preset-button">\n            <div class="tui-image-editor-button preset preset-none active">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-shape-rectangle"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-shape-rectangle"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> Custom </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-square">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> Square </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-3-2">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 3:2 </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-4-3">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 4:3 </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-5-4">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 5:4 </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-7-5">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 7:5 </label>\n            </div>\n            <div class="tui-image-editor-button preset preset-16-9">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-crop"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-crop"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 16:9 </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition tui-image-editor-newline">\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li id="tie-crop-button" class="action">\n            <div class="tui-image-editor-button apply">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-apply" class="normal"/>\n                    <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-apply" class="active"/>\n                </svg>\n                <label>\n                    Apply\n                </label>\n            </div>\n            <div class="tui-image-editor-button cancel">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-cancel" class="normal"/>\n                    <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-cancel" class="active"/>\n                </svg>\n                <label>\n                    Cancel\n                </label>\n            </div>\n        </li>\n    </ul>\n')};function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Se(e,t){return!t||"object"!==xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul id="tie-flip-button" class="tui-image-editor-submenu-item">\n        <li>\n            <div class="tui-image-editor-button flipX">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-flip-x" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-flip-x" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Flip X\n                </label>\n            </div>\n            <div class="tui-image-editor-button flipY">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-flip-y" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-flip-y" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Flip Y\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div class="tui-image-editor-button resetFlip">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-flip-reset"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-flip-reset"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Reset\n                </label>\n            </div>\n        </li>\n    </ul>\n')};function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Me(e,t){return!t||"object"!==Pe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-retate-button">\n            <div class="tui-image-editor-button clockwise">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-rotate-clockwise"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-rotate-clockwise"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> 30 </label>\n            </div>\n            <div class="tui-image-editor-button counterclockwise">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-rotate-counterclockwise"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-rotate-counterclockwise"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> -30 </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">Range</label>\n            <div id="tie-rotate-range"></div>\n            <input id="tie-ratate-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n')};function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Be(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var He=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-text-effect-button">\n            <div class="tui-image-editor-button bold">\n                <div>\n                    <svg class="svg_ic-submenu">\n                    <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-text-bold" class="normal"/>\n                    <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-text-bold" class="active"/>\n                    </svg>\n                </div>\n                <label> Bold </label>\n            </div>\n            <div class="tui-image-editor-button italic">\n                <div>\n                    <svg class="svg_ic-submenu">\n                    <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-text-italic" class="normal"/>\n                    <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-text-italic" class="active"/>\n                    </svg>\n                </div>\n                <label> Italic </label>\n            </div>\n            <div class="tui-image-editor-button underline">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-text-underline"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-text-underline"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label> Underline </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li id="tie-text-align-button">\n            <div class="tui-image-editor-button left">\n                <div>\n                    <svg class="svg_ic-submenu">\n                     <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-text-align-left"\n                        class="normal"/>\n                     <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-text-align-left"\n                        class="active"/>\n                    </svg>\n                </div>\n                <label> Left </label>\n            </div>\n            <div class="tui-image-editor-button center">\n                <div>\n                    <svg class="svg_ic-submenu">\n                     <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-text-align-center"\n                        class="normal"/>\n                     <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-text-align-center"\n                        class="active"/>\n                    </svg>\n                </div>\n                <label> Center </label>\n            </div>\n            <div class="tui-image-editor-button right">\n                <div>\n                    <svg class="svg_ic-submenu">\n                     <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-text-align-right"\n                        class="normal"/>\n                     <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-text-align-right"\n                        class="active"/>\n                    </svg>\n                </div>\n                <label> Right </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div id="tie-text-color" title="Color"></div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">Text size</label>\n            <div id="tie-text-range"></div>\n            <input id="tie-text-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n')};function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function We(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ge=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li>\n            <div class="tui-image-editor-button">\n                <div>\n                    <input type="file" accept="image/*" id="tie-mask-image-file">\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-mask-load" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-mask-load" class="active"/>\n                    </svg>\n                </div>\n                <label> Load Mask Image </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li id="tie-mask-apply" class="tui-image-editor-newline apply" style="margin-top: 22px;margin-bottom: 5px">\n            <div class="tui-image-editor-button apply">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-apply" class="normal"/>\n                    <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-apply" class="active"/>\n                </svg>\n                <label>\n                    Apply\n                </label>\n            </div>\n        </li>\n    </ul>\n')};function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ke(e,t){return!t||"object"!==Ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $e=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-icon-add-button">\n            <div class="tui-image-editor-button" data-icontype="icon-arrow">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-icon-arrow"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-arrow"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Arrow\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-arrow-2">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-arrow-2"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-arrow-2"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Arrow-2\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-arrow-3">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-arrow-3"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-arrow-3"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Arrow-3\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-star">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-star" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-star" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Star-1\n                </label>\n            </div>\n            <div class="tui-image-editor-button" data-icontype="icon-star-2">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-star-2"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-star-2"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Star-2\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-polygon">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-polygon"\n                            class="normal"/>\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-polygon"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Polygon\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-location">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-location"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-location"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Location\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-heart">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-heart"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-heart"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Heart\n                </label>\n            </div>\n\n            <div class="tui-image-editor-button" data-icontype="icon-bubble">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-bubble"\n                            class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-bubble"\n                            class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Bubble\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li id="tie-icon-add-button">\n            <div class="tui-image-editor-button" style="margin:0">\n                <div>\n                    <input type="file" accept="image/*" id="tie-icon-image-file">\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-icon-load" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-icon-load" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Custom icon\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div id="tie-icon-color" title="Color"></div>\n        </li>\n    </ul>\n')};function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tt(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ot=function(e){var t=e.iconStyle,n=t.normal,i=t.active;return'\n    <ul class="tui-image-editor-submenu-item">\n        <li id="tie-draw-line-select-button">\n            <div class="tui-image-editor-button free">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="'.concat(n.path,"#").concat(n.name,'-ic-draw-free" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-draw-free" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Free\n                </label>\n            </div>\n            <div class="tui-image-editor-button line">\n                <div>\n                    <svg class="svg_ic-submenu">\n                        <use xlink:href="').concat(n.path,"#").concat(n.name,'-ic-draw-line" class="normal"/>\n                        <use xlink:href="').concat(i.path,"#").concat(i.name,'-ic-draw-line" class="active"/>\n                    </svg>\n                </div>\n                <label>\n                    Straight\n                </label>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div id="tie-draw-color" title="Color"></div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-newline tui-image-editor-range-wrap">\n            <label class="range">Range</label>\n            <div id="tie-draw-range"></div>\n            <input id="tie-draw-range-value" class="tui-image-editor-range-value" value="0" />\n        </li>\n    </ul>\n')};function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function st(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ut=function(){return'\n    <ul class="tui-image-editor-submenu-item">\n        <li class="tui-image-editor-submenu-align">\n            <div class="tui-image-editor-checkbox-wrap fixed-width">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-grayscale">\n                    <label for="tie-grayscale">Grayscale</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-invert">\n                    <label for="tie-invert">Invert</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-sepia">\n                    <label for="tie-sepia">Sepia</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-sepia2">\n                    <label for="tie-sepia2">Sepia2</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-blur">\n                    <label for="tie-blur">Blur</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-sharpen">\n                    <label for="tie-sharpen">Sharpen</label>\n                </div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-emboss">\n                    <label for="tie-emboss">Emboss</label>\n                </div>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-submenu-align">\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled" style="margin-bottom: 7px;">\n                <div class="tui-image-editor-checkbox-wrap">\n                    <div class="tui-image-editor-checkbox">\n                        <input type="checkbox" id="tie-remove-white">\n                        <label for="tie-remove-white">Remove White</label>\n                    </div>\n                </div>\n                <div class="tui-image-editor-newline tui-image-editor-range-wrap short">\n                    <label>Threshold</label>\n                    <div id="tie-removewhite-threshold-range"></div>\n                </div>\n                <div class="tui-image-editor-newline tui-image-editor-range-wrap short">\n                    <label>Distance</label>\n                    <div id="tie-removewhite-distance-range"></div>\n                </div>\n            </div>\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-newline tui-image-editor-checkbox-wrap">\n                    <div class="tui-image-editor-checkbox">\n                        <input type="checkbox" id="tie-gradient-transparency">\n                        <label for="tie-gradient-transparency">Grayscale</label>\n                    </div>\n                </div>\n                <div class="tui-image-editor-newline tui-image-editor-range-wrap short">\n                    <label>Value</label>\n                    <div id="tie-gradient-transparency-range"></div>\n                </div>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition only-left-right">\n            <div></div>\n        </li>\n        <li class="tui-image-editor-submenu-align">\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-brightness">\n                    <label for="tie-brightness">Brightness</label>\n                </div>\n                <div class="tui-image-editor-range-wrap short">\n                    <div id="tie-brightness-range"></div>\n                </div>\n            </div>\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-noise">\n                    <label for="tie-noise">Noise</label>\n                </div>\n                <div class="tui-image-editor-range-wrap short">\n                    <div id="tie-noise-range"></div>\n                </div>\n            </div>\n\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-pixelate">\n                    <label for="tie-pixelate">Pixelate</label>\n                </div>\n                <div class="tui-image-editor-range-wrap short">\n                    <div id="tie-pixelate-range"></div>\n                </div>\n            </div>\n            <div class="tui-image-editor-checkbox-group tui-image-editor-disabled">\n                <div class="tui-image-editor-newline tui-image-editor-checkbox-wrap">\n                    <div class="tui-image-editor-checkbox">\n                        <input type="checkbox" id="tie-color-filter">\n                        <label for="tie-color-filter">Color Filter</label>\n                    </div>\n                </div>\n                <div class="tui-image-editor-newline tui-image-editor-range-wrap short">\n                    <label>Threshold</label>\n                    <div id="tie-colorfilter-threshole-range"></div>\n                </div>\n            </div>\n        </li>\n        <li class="tui-image-editor-partition">\n            <div></div>\n        </li>\n        <li>\n            <div class="filter-color-item">\n                <div id="tie-filter-tint-color" title="Tint"></div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-tint">\n                    <label for="tie-tint"></label>\n                </div>\n            </div>\n            <div class="filter-color-item">\n                <div id="tie-filter-multiply-color" title="Multiply"></div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-multiply">\n                    <label for="tie-multiply"></label>\n                </div>\n            </div>\n            <div class="filter-color-item">\n                <div id="tie-filter-blend-color" title="Blend"></div>\n                <div class="tui-image-editor-checkbox">\n                    <input type="checkbox" id="tie-blend">\n                    <label for="tie-blend"></label>\n                </div>\n            </div>\n        </li>\n    </ul>\n'};function ht(e){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ft(e,t){return!t||"object"!==ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vt=["add","diff","subtract","multiply","screen","lighten","darken"],mt=["grayscale","invert","sepia","sepia2","blur","sharpen","emboss","remove-white","gradient-transparency","brightness","noise","pixelate","color-filter","tint","multiply","blend"];function bt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var yt={Shape:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=be(this,ye(t).call(this,e,{name:"shape",iconStyle:o,menuBarPosition:r,templateHtml:ge}))).type=null,i.options=ke,i._els={shapeSelectButton:i.selector("#tie-shape-button"),shapeColorButton:i.selector("#tie-shape-color-button"),strokeRange:new de(i.selector("#tie-stroke-range"),B),strokeRangeValue:i.selector("#tie-stroke-range-value"),fillColorpicker:new le(i.selector("#tie-color-fill"),"",i.toggleDirection),strokeColorpicker:new le(i.selector("#tie-color-stroke"),"#ffbb3b",i.toggleDirection)},i.colorPickerControls.push(i._els.fillColorpicker),i.colorPickerControls.push(i._els.strokeColorpicker),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this.actions=e,this._els.shapeSelectButton.addEventListener("click",this._changeShapeHandler.bind(this)),this._els.strokeRange.on("change",this._changeStrokeRangeHandler.bind(this)),this._els.fillColorpicker.on("change",this._changeFillColorHandler.bind(this)),this._els.strokeColorpicker.on("change",this._changeStrokeColorHandler.bind(this)),this._els.fillColorpicker.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.strokeColorpicker.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.strokeRangeValue.value=this._els.strokeRange.value,this._els.strokeRangeValue.setAttribute("readonly",!0)}},{key:"setShapeStatus",value:function(e){var t=e.strokeWidth,n=e.strokeColor,i=e.fillColor;this._els.strokeRange.value=t,this._els.strokeRange.trigger("change"),this._els.strokeColorpicker.color=n,this._els.fillColorpicker.color=i,this.options.stroke=n,this.options.fill=i,this.options.strokeWidth=t}},{key:"changeStartMode",value:function(){this.actions.stopDrawingMode()}},{key:"changeStandbyMode",value:function(){this.type=null,this.actions.changeSelectableAll(!0),this._els.shapeSelectButton.classList.remove("circle"),this._els.shapeSelectButton.classList.remove("triangle"),this._els.shapeSelectButton.classList.remove("rect")}},{key:"setMaxStrokeValue",value:function(e){var t=e;t<=0&&(t=B.max),this._els.strokeRange.max=t}},{key:"setStrokeValue",value:function(e){this._els.strokeRange.value=e,this._els.strokeRange.trigger("change")}},{key:"getStrokeValue",value:function(){return this._els.strokeRange.value}},{key:"_changeShapeHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){this.actions.stopDrawingMode(),this.actions.discardSelection();var n=this.getButtonType(t,["circle","triangle","rect"]);if(this.type===n)return void this.changeStandbyMode();this.changeStandbyMode(),this.type=n,e.currentTarget.classList.add(n),this.actions.changeSelectableAll(!1),this.actions.modeChange("shape")}}},{key:"_changeStrokeRangeHandler",value:function(e){this.options.strokeWidth=f(e),this._els.strokeRangeValue.value=f(e),this.actions.changeShape({strokeWidth:e}),this.actions.setDrawingShape(this.type,this.options)}},{key:"_changeFillColorHandler",value:function(e){e=e||"transparent",this.options.fill=e,this.actions.changeShape({fill:e})}},{key:"_changeStrokeColorHandler",value:function(e){e=e||"transparent",this.options.stroke=e,this.actions.changeShape({stroke:e})}}])&&me(n.prototype,i),o&&me(n,o),t}(),Crop:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Se(this,Ce(t).call(this,e,{name:"crop",iconStyle:o,menuBarPosition:r,templateHtml:we}))).status="active",i._els={apply:i.selector("#tie-crop-button .apply"),cancel:i.selector("#tie-crop-button .cancel"),preset:i.selector("#tie-crop-preset-button")},i.defaultPresetButton=i._els.preset.querySelector(".preset-none"),i}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){var t=this;this.actions=e,this._els.apply.addEventListener("click",function(){t.actions.crop(),t._els.apply.classList.remove("active")}),this._els.cancel.addEventListener("click",function(){t.actions.cancel(),t._els.apply.classList.remove("active")}),this._els.preset.addEventListener("click",function(e){var n=e.target.closest(".tui-image-editor-button.preset");if(n){var i=n.className.match(/preset-[^\s]+/)[0];t._setPresetButtonActive(n),t.actions.preset(i)}})}},{key:"changeStartMode",value:function(){this.actions.modeChange("crop")}},{key:"changeStandbyMode",value:function(){this.actions.stopDrawingMode(),this._setPresetButtonActive()}},{key:"changeApplyButtonStatus",value:function(e){e?this._els.apply.classList.add("active"):this._els.apply.classList.remove("active")}},{key:"_setPresetButtonActive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultPresetButton;o.a.forEach([].slice.call(this._els.preset.querySelectorAll(".preset")),function(e){e.classList.remove("active")}),e&&e.classList.add("active")}}])&&Ee(n.prototype,i),r&&Ee(n,r),t}(),Flip:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Me(this,Ae(t).call(this,e,{name:"flip",iconStyle:o,menuBarPosition:r,templateHtml:je}))).flipStatus=!1,i._els={flipButton:i.selector("#tie-flip-button")},i}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this._actions=e,this._els.flipButton.addEventListener("click",this._changeFlip.bind(this))}},{key:"_changeFlip",value:function(e){var t=this,n=e.target.closest(".tui-image-editor-button");if(n){var i=this.getButtonType(n,["flipX","flipY","resetFlip"]);if(!this.flipStatus&&"resetFlip"===i)return;this._actions.flip(i).then(function(e){var n=t._els.flipButton.classList;t.flipStatus=!1,n.remove("resetFlip"),o.a.forEach(["flipX","flipY"],function(i){n.remove(i),e[i]&&(n.add(i),n.add("resetFlip"),t.flipStatus=!0)})})}}}])&&Te(n.prototype,i),r&&Te(n,r),t}(),Rotate:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Be(this,Fe(t).call(this,e,{name:"rotate",iconStyle:o,menuBarPosition:r,templateHtml:Ie})))._els={rotateButton:i.selector("#tie-retate-button"),rotateRange:new de(i.selector("#tie-rotate-range"),R),rotateRangeValue:i.selector("#tie-ratate-range-value")},i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this.actions=e,this._els.rotateButton.addEventListener("click",this._changeRotateForButton.bind(this)),this._els.rotateRange.on("change",this._changeRotateForRange.bind(this)),this._els.rotateRangeValue.setAttribute("readonly",!0)}},{key:"_changeRotateForRange",value:function(e){var t=f(e);this._els.rotateRangeValue.value=t,this.actions.setAngle(t)}},{key:"_changeRotateForButton",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n={clockwise:30,counterclockwise:-30}[this.getButtonType(t,["counterclockwise","clockwise"])];this.actions.rotate(n)}}}])&&Le(n.prototype,i),o&&Le(n,o),t}(),Text:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=We(this,Xe(t).call(this,e,{name:"text",iconStyle:o,menuBarPosition:r,templateHtml:He}))).effect={bold:!1,italic:!1,underline:!1},i.align="left",i._els={textEffectButton:i.selector("#tie-text-effect-button"),textAlignButton:i.selector("#tie-text-align-button"),textColorpicker:new le(i.selector("#tie-text-color"),"#ffbb3b",i.toggleDirection),textRange:new de(i.selector("#tie-text-range"),F),textRangeValue:i.selector("#tie-text-range-value")},i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this.actions=e,this._els.textEffectButton.addEventListener("click",this._setTextEffectHandler.bind(this)),this._els.textAlignButton.addEventListener("click",this._setTextAlignHandler.bind(this)),this._els.textRange.on("change",this._changeTextRnageHandler.bind(this)),this._els.textRangeValue.value=this._els.textRange.value,this._els.textRangeValue.setAttribute("readonly",!0),this._els.textColorpicker.on("change",this._changeColorHandler.bind(this))}},{key:"changeStandbyMode",value:function(){this.actions.stopDrawingMode()}},{key:"changeStartMode",value:function(){this.actions.modeChange("text")}},{key:"_setTextEffectHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button"),n=t.className.match(/(bold|italic|underline)/)[0],i={bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},underline:{textDecoration:"underline"}}[n];this.effect[n]=!this.effect[n],t.classList.toggle("active"),this.actions.changeTextStyle(i)}},{key:"_setTextAlignHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n=this.getButtonType(t,["left","center","right"]);e.currentTarget.classList.remove(this.align),this.align!==n&&e.currentTarget.classList.add(n),this.actions.changeTextStyle({textAlign:n}),this.align=n}}},{key:"_changeTextRnageHandler",value:function(e){e=f(e),f(this._els.textRangeValue.value)!==e&&(this.actions.changeTextStyle({fontSize:e}),this._els.textRangeValue.value=e)}},{key:"_changeColorHandler",value:function(e){e=e||"transparent",this.actions.changeTextStyle({fill:e})}},{key:"textColor",get:function(){return this._els.textColorpicker.color}},{key:"fontSize",get:function(){return this._els.textRange.value},set:function(e){this._els.textRange.value=e,this._els.textRangeValue.value=e}}])&&Ue(n.prototype,i),o&&Ue(n,o),t}(),Mask:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Ke(this,Je(t).call(this,e,{name:"mask",iconStyle:o,menuBarPosition:r,templateHtml:Ge})))._els={applyButton:i.selector("#tie-mask-apply"),maskImageButton:i.selector("#tie-mask-image-file")},i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this.actions=e,this._els.maskImageButton.addEventListener("change",this._loadMaskFile.bind(this)),this._els.applyButton.addEventListener("click",this._applyMask.bind(this))}},{key:"_applyMask",value:function(){this.actions.applyFilter(),this._els.applyButton.classList.remove("active")}},{key:"_loadMaskFile",value:function(e){var t;p()||alert("This browser does not support file-api");var n=e.target.files[0];n&&(t=URL.createObjectURL(n),this.actions.loadImageFromURL(t,n),this._els.applyButton.classList.add("active"))}}])&&qe(n.prototype,i),o&&qe(n,o),t}(),Icon:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=tt(this,nt(t).call(this,e,{name:"icon",iconStyle:o,menuBarPosition:r,templateHtml:$e}))).iconType=null,i._iconMap={},i._els={registIconButton:i.selector("#tie-icon-image-file"),addIconButton:i.selector("#tie-icon-add-button"),iconColorpicker:new le(i.selector("#tie-icon-color"),"#ffbb3b",i.toggleDirection)},i}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this.actions=e,this._els.iconColorpicker.on("change",this._changeColorHandler.bind(this)),this._els.registIconButton.addEventListener("change",this._registeIconHandler.bind(this)),this._els.addIconButton.addEventListener("click",this._addIconHandler.bind(this))}},{key:"clearIconType",value:function(){this._els.addIconButton.classList.remove(this.iconType),this.iconType=null}},{key:"registDefaultIcon",value:function(){var e=this;o.a.forEach(I,function(t,n){e.actions.registDefalutIcons(n,t)})}},{key:"setIconPickerColor",value:function(e){this._els.iconColorpicker.color=e}},{key:"changeStandbyMode",value:function(){this.clearIconType(),this.actions.cancelAddIcon()}},{key:"_changeColorHandler",value:function(e){e=e||"transparent",this.actions.changeColor(e)}},{key:"_addIconHandler",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n=t.getAttribute("data-icontype"),i=this._els.iconColorpicker.color;this.actions.discardSelection(),this.actions.changeSelectableAll(!1),this._els.addIconButton.classList.remove(this.iconType),this._els.addIconButton.classList.add(n),this.iconType===n?this.changeStandbyMode():(this.actions.addIcon(n,i),this.iconType=n)}}},{key:"_registeIconHandler",value:function(e){var t;p||alert("This browser does not support file-api");var n=e.target.files[0];n&&(t=URL.createObjectURL(n),this.actions.registCustomIcon(t,n))}}])&&et(n.prototype,i),r&&et(n,r),t}(),Draw:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=st(this,ct(t).call(this,e,{name:"draw",iconStyle:o,menuBarPosition:r,templateHtml:ot})))._els={lineSelectButton:i.selector("#tie-draw-line-select-button"),drawColorpicker:new le(i.selector("#tie-draw-color"),"#00a9ff",i.toggleDirection),drawRange:new de(i.selector("#tie-draw-range"),L),drawRangeValue:i.selector("#tie-draw-range-value")},i.type=null,i.color=i._els.drawColorpicker.color,i.width=i._els.drawRange.value,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){this.actions=e,this._els.lineSelectButton.addEventListener("click",this._changeDrawType.bind(this)),this._els.drawColorpicker.on("change",this._changeDrawColor.bind(this)),this._els.drawRange.on("change",this._changeDrawRange.bind(this)),this._els.drawRangeValue.value=this._els.drawRange.value,this._els.drawRangeValue.setAttribute("readonly",!0)}},{key:"setDrawMode",value:function(){this.actions.setDrawMode(this.type,{width:this.width,color:g(this.color,.7)})}},{key:"changeStandbyMode",value:function(){this.type=null,this.actions.stopDrawingMode(),this.actions.changeSelectableAll(!0),this._els.lineSelectButton.classList.remove("free"),this._els.lineSelectButton.classList.remove("line")}},{key:"changeStartMode",value:function(){this.type="free",this._els.lineSelectButton.classList.add("free"),this.setDrawMode()}},{key:"_changeDrawType",value:function(e){var t=e.target.closest(".tui-image-editor-button");if(t){var n=this.getButtonType(t,["free","line"]);if(this.actions.discardSelection(),this.type===n)return void this.changeStandbyMode();this.changeStandbyMode(),this.type=n,this._els.lineSelectButton.classList.add(n),this.setDrawMode()}}},{key:"_changeDrawColor",value:function(e){this.color=e||"transparent",this.type?this.setDrawMode():this.changeStartMode()}},{key:"_changeDrawRange",value:function(e){e=f(e),this._els.drawRangeValue.value=e,this.width=e,this.type?this.setDrawMode():this.changeStartMode()}}])&&at(n.prototype,i),o&&at(n,o),t}(),Filter:function(e){function t(e,n){var i,o=n.iconStyle,r=n.menuBarPosition;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ft(this,pt(t).call(this,e,{name:"filter",iconStyle:o,menuBarPosition:r,templateHtml:ut}))).selectBoxShow=!1,i.checkedMap={},i._makeControlElement(),i}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(t,pe),n=t,(i=[{key:"addEvent",value:function(e){var t=this,n=e.applyFilter,i=this._changeRangeValue.bind(this,n);o.a.forEach(mt,function(e){var n=t.selector("#tie-".concat(e)),o=e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});t.checkedMap[o]=n,n.addEventListener("change",function(){return i(o)})}),this._els.removewhiteThresholdRange.on("change",function(){return i("removeWhite")}),this._els.removewhiteDistanceRange.on("change",function(){return i("removeWhite")}),this._els.gradientTransparencyRange.on("change",function(){return i("gradientTransparency")}),this._els.colorfilterThresholeRange.on("change",function(){return i("colorFilter")}),this._els.pixelateRange.on("change",function(){return i("pixelate")}),this._els.noiseRange.on("change",function(){return i("noise")}),this._els.brightnessRange.on("change",function(){return i("brightness")}),this._els.blendType.addEventListener("change",function(){return i("blend")}),this._els.filterBlendColor.on("change",function(){return i("blend")}),this._els.filterMultiplyColor.on("change",function(){return i("multiply")}),this._els.tintOpacity.on("change",function(){return i("tint")}),this._els.filterTintColor.on("change",function(){return i("tint")}),this._els.blendType.addEventListener("click",function(e){return e.stopPropagation()}),this._els.filterMultiplyColor.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.filterTintColor.on("changeShow",this.colorPickerChangeShow.bind(this)),this._els.filterBlendColor.on("changeShow",this.colorPickerChangeShow.bind(this))}},{key:"_changeRangeValue",value:function(e,t){var n=this.checkedMap[t].checked,i=t,o=this.checkedMap[t].closest(".tui-image-editor-checkbox-group");o&&(n?o.classList.remove("tui-image-editor-disabled"):o.classList.add("tui-image-editor-disabled")),e(n,i,this._getFilterOption(i))}},{key:"_getFilterOption",value:function(e){var t={};switch(e){case"removeWhite":t.threshold=f(this._els.removewhiteThresholdRange.value),t.distance=f(this._els.removewhiteDistanceRange.value);break;case"gradientTransparency":t.threshold=f(this._els.gradientTransparencyRange.value);break;case"colorFilter":t.color="#FFFFFF",t.threshold=this._els.colorfilterThresholeRange.value;break;case"pixelate":t.blocksize=f(this._els.pixelateRange.value);break;case"noise":t.noise=f(this._els.noiseRange.value);break;case"brightness":t.brightness=f(this._els.brightnessRange.value);break;case"blend":t.color=this._els.filterBlendColor.color,t.mode=this._els.blendType.value;break;case"multiply":t.color=this._els.filterMultiplyColor.color;break;case"tint":t.color=this._els.filterTintColor.color,t.opacity=this._els.tintOpacity.value}return t}},{key:"_makeControlElement",value:function(){var e=this.selector;this._els={removewhiteThresholdRange:new de(e("#tie-removewhite-threshold-range"),H),removewhiteDistanceRange:new de(e("#tie-removewhite-distance-range"),z),gradientTransparencyRange:new de(e("#tie-gradient-transparency-range"),U),brightnessRange:new de(e("#tie-brightness-range"),W),noiseRange:new de(e("#tie-noise-range"),X),pixelateRange:new de(e("#tie-pixelate-range"),V),colorfilterThresholeRange:new de(e("#tie-colorfilter-threshole-range"),G),filterTintColor:new le(e("#tie-filter-tint-color"),"#03bd9e",this.toggleDirection),filterMultiplyColor:new le(e("#tie-filter-multiply-color"),"#515ce6",this.toggleDirection),filterBlendColor:new le(e("#tie-filter-blend-color"),"#ffbb3b",this.toggleDirection)},this._els.tintOpacity=this._pickerWithRange(this._els.filterTintColor.pickerControl),this._els.blendType=this._pickerWithSelectbox(this._els.filterBlendColor.pickerControl),this.colorPickerControls.push(this._els.filterTintColor),this.colorPickerControls.push(this._els.filterMultiplyColor),this.colorPickerControls.push(this._els.filterBlendColor)}},{key:"_pickerWithRange",value:function(e){var t=document.createElement("div"),n=document.createElement("label"),i=document.createElement("div");return i.id="tie-filter-tint-opacity",n.innerHTML="Opacity",t.appendChild(n),t.appendChild(i),e.appendChild(t),e.style.height="130px",new de(i,N)}},{key:"_pickerWithSelectbox",value:function(e){var t=document.createElement("div"),n=document.createElement("select"),i=document.createElement("ul");return t.className="tui-image-editor-selectlist-wrap",i.className="tui-image-editor-selectlist",t.appendChild(n),t.appendChild(i),this._makeSelectOptionList(n),e.appendChild(t),e.style.height="130px",this._drawSelectOptionList(n,i),this._pickerWithSelectboxForAddEvent(n,i),n}},{key:"_drawSelectOptionList",value:function(e,t){var n=e.querySelectorAll("option");o.a.forEach(n,function(e){var n=document.createElement("li");n.innerHTML=e.innerHTML,n.setAttribute("data-item",e.value),t.appendChild(n)})}},{key:"_pickerWithSelectboxForAddEvent",value:function(e,t){var n=this;t.addEventListener("click",function(i){var o=i.target.getAttribute("data-item"),r=document.createEvent("HTMLEvents");e.querySelector('[value="'.concat(o,'"]')).selected=!0,r.initEvent("change",!0,!0),e.dispatchEvent(r),n.selectBoxShow=!1,t.style.display="none"}),e.addEventListener("mousedown",function(i){i.preventDefault(),n.selectBoxShow=!n.selectBoxShow,t.style.display=n.selectBoxShow?"block":"none",t.setAttribute("data-selectitem",e.value),t.querySelector("[data-item='".concat(e.value,"']")).classList.add("active")})}},{key:"_makeSelectOptionList",value:function(e){o.a.forEach(vt,function(t){var n=document.createElement("option");n.setAttribute("value",t),n.innerHTML=t.replace(/^[a-z]/,function(e){return e.toUpperCase()}),e.appendChild(n)})}}])&&dt(n.prototype,i),r&&dt(n,r),t}()},_t=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=this._initializeOption(n),this._actions=i,this.submenu=!1,this.imageSize={},this.uiSize={},this.theme=new ie(this.options.theme),this._submenuChangeTransection=!1,this._selectedElement=null,this._mainElement=null,this._editorElementWrap=null,this._editorElement=null,this._menuElement=null,this._subMenuElement=null,this._makeUiElement(t),this._setUiSize(),this._initMenuEvent=!1,this._els={undo:this._menuElement.querySelector("#tie-btn-undo"),redo:this._menuElement.querySelector("#tie-btn-redo"),reset:this._menuElement.querySelector("#tie-btn-reset"),delete:this._menuElement.querySelector("#tie-btn-delete"),deleteAll:this._menuElement.querySelector("#tie-btn-delete-all"),download:this._selectedElement.querySelectorAll(".tui-image-editor-download-btn"),load:this._selectedElement.querySelectorAll(".tui-image-editor-load-btn")},this._makeSubMenu()}var t,n,i;return t=e,(n=[{key:"setUiDefaultSelectionStyle",value:function(e){return o.a.extend({applyCropSelectionStyle:!0,applyGroupSelectionStyle:!0,selectionStyle:{cornerStyle:"circle",cornerSize:16,cornerColor:"#fff",cornerStrokeColor:"#fff",transparentCorners:!1,lineWidth:2,borderColor:"#fff"}},e)}},{key:"resizeEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.uiSize,n=e.imageSize,i=void 0===n?this.imageSize:n;i!==this.imageSize&&(this.imageSize=i),t&&this._setUiSize(t);var o=this._getEditorDimension(),r=o.width,a=o.height,s=this._editorElement.style,c=this.options.menuBarPosition;s.height="".concat(a,"px"),s.width="".concat(r,"px"),this._setEditorPosition(c),this._editorElementWrap.style.bottom="0px",this._editorElementWrap.style.top="0px",this._editorElementWrap.style.left="0px",this._editorElementWrap.style.width="100%";var l=this._selectedElement.classList;"top"===c&&this._selectedElement.offsetWidth<"1300"?l.add("tui-image-editor-top-optimization"):l.remove("tui-image-editor-top-optimization")}},{key:"changeUndoButtonStatus",value:function(e){e?this._els.undo.classList.add("enabled"):this._els.undo.classList.remove("enabled")}},{key:"changeRedoButtonStatus",value:function(e){e?this._els.redo.classList.add("enabled"):this._els.redo.classList.remove("enabled")}},{key:"changeResetButtonStatus",value:function(e){e?this._els.reset.classList.add("enabled"):this._els.reset.classList.remove("enabled")}},{key:"changeDeleteAllButtonEnabled",value:function(e){e?this._els.deleteAll.classList.add("enabled"):this._els.deleteAll.classList.remove("enabled")}},{key:"changeDeleteButtonEnabled",value:function(e){e?this._els.delete.classList.add("enabled"):this._els.delete.classList.remove("enabled")}},{key:"_initializeOption",value:function(e){return o.a.extend({loadImage:{path:"",name:""},menuIconPath:"",menu:["crop","flip","rotate","draw","shape","icon","text","mask","filter"],initMenu:!1,uiSize:{width:"100%",height:"100%"},menuBarPosition:"bottom"},e)}},{key:"_setUiSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.uiSize,t=this._selectedElement.style;t.width=e.width,t.height=e.height}},{key:"_makeSubMenu",value:function(){var e=this;o.a.forEach(this.options.menu,function(t){var n=yt[t.replace(/^[a-z]/,function(e){return e.toUpperCase()})];e._makeMenuElement(t),e._els[t]=e._menuElement.querySelector("#tie-btn-".concat(t)),e[t]=new n(e._subMenuElement,{iconStyle:e.theme.getStyle("submenu.icon"),menuBarPosition:e.options.menuBarPosition})})}},{key:"_makeUiElement",value:function(e){var t;window.snippet=o.a,t=e.jquery?e[0]:e.nodeType?e:document.querySelector(e);var n,i,r,a,s,c,l,u,h,d=(n=t,function(e){return n.querySelector(e)});t.classList.add("tui-image-editor-container"),t.innerHTML=(i={biImage:this.theme.getStyle("common.bi"),iconStyle:this.theme.getStyle("menu.icon"),loadButtonStyle:this.theme.getStyle("loadButton"),downloadButtonStyle:this.theme.getStyle("downloadButton")},r=i.biImage,a=i.iconStyle,s=a.normal,c=a.hover,l=a.disabled,u=i.loadButtonStyle,h=i.downloadButtonStyle,'\n    <div class="tui-image-editor-controls">\n        <div class="tui-image-editor-controls-logo">\n            <img src="'.concat(r,'" />\n        </div>\n        <ul class="tui-image-editor-menu">\n            <li id="tie-btn-undo" class="tui-image-editor-item" title="Undo">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(s.path,"#").concat(s.name,'-ic-undo" class="enabled"/>\n                    <use xlink:href="').concat(l.path,"#").concat(l.name,'-ic-undo" class="normal"/>\n                    <use xlink:href="').concat(c.path,"#").concat(c.name,'-ic-undo" class="hover"/>\n                </svg>\n            </li>\n            <li id="tie-btn-redo" class="tui-image-editor-item" title="Redo">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(s.path,"#").concat(s.name,'-ic-redo" class="enabled"/>\n                    <use xlink:href="').concat(l.path,"#").concat(l.name,'-ic-redo" class="normal"/>\n                    <use xlink:href="').concat(c.path,"#").concat(c.name,'-ic-redo" class="hover"/>\n                </svg>\n            </li>\n            <li id="tie-btn-reset" class="tui-image-editor-item" title="Reset">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(s.path,"#").concat(s.name,'-ic-reset" class="enabled"/>\n                    <use xlink:href="').concat(l.path,"#").concat(l.name,'-ic-reset" class="normal"/>\n                    <use xlink:href="').concat(c.path,"#").concat(c.name,'-ic-reset" class="hover"/>\n                </svg>\n            </li>\n            <li class="tui-image-editor-item">\n                <div class="tui-image-editor-icpartition"></div>\n            </li>\n            <li id="tie-btn-delete" class="tui-image-editor-item" title="Delete">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(s.path,"#").concat(s.name,'-ic-delete" class="enabled"/>\n                    <use xlink:href="').concat(l.path,"#").concat(l.name,'-ic-delete" class="normal"/>\n                    <use xlink:href="').concat(c.path,"#").concat(c.name,'-ic-delete" class="hover"/>\n                </svg>\n            </li>\n            <li id="tie-btn-delete-all" class="tui-image-editor-item" title="Delete-all">\n                <svg class="svg_ic-menu">\n                    <use xlink:href="').concat(s.path,"#").concat(s.name,'-ic-delete-all" class="enabled"/>\n                    <use xlink:href="').concat(l.path,"#").concat(l.name,'-ic-delete-all" class="normal"/>\n                    <use xlink:href="').concat(c.path,"#").concat(c.name,'-ic-delete-all" class="hover"/>\n                </svg>\n            </li>\n            <li class="tui-image-editor-item">\n                <div class="tui-image-editor-icpartition"></div>\n            </li>\n        </ul>\n\n        <div class="tui-image-editor-controls-buttons">\n            <button style="').concat(u,'">\n                Load\n                <input type="file" class="tui-image-editor-load-btn" />\n            </button>\n            <button class="tui-image-editor-download-btn" style="').concat(h,'">\n                Download\n            </button>\n        </div>\n    </div>\n')+function(e){var t=e.biImage,n=e.commonStyle,i=e.headerStyle,o=e.loadButtonStyle,r=e.downloadButtonStyle,a=e.submenuStyle;return'\n    <div class="tui-image-editor-main-container" style="'.concat(n,'">\n        <div class="tui-image-editor-header" style="').concat(i,'">\n            <div class="tui-image-editor-header-logo">\n                <img src="').concat(t,'" />\n            </div>\n            <div class="tui-image-editor-header-buttons">\n                <button style="').concat(o,'">\n                    Load\n                    <input type="file" class="tui-image-editor-load-btn" />\n                </button>\n                <button class="tui-image-editor-download-btn" style="').concat(r,'">\n                    Download\n                </button>\n            </div>\n        </div>\n        <div class="tui-image-editor-main">\n            <div class="tui-image-editor-submenu">\n                <div class="tui-image-editor-submenu-style" style="').concat(a,'"></div>\n            </div>\n            <div class="tui-image-editor-wrap">\n                <div class="tui-image-editor-size-wrap">\n                    <div class="tui-image-editor-align-wrap">\n                        <div class="tui-image-editor"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n')}({biImage:this.theme.getStyle("common.bi"),commonStyle:this.theme.getStyle("common"),headerStyle:this.theme.getStyle("header"),loadButtonStyle:this.theme.getStyle("loadButton"),downloadButtonStyle:this.theme.getStyle("downloadButton"),submenuStyle:this.theme.getStyle("submenu")})),this._selectedElement=t,this._selectedElement.classList.add(this.options.menuBarPosition),this._mainElement=d(".tui-image-editor-main"),this._editorElementWrap=d(".tui-image-editor-wrap"),this._editorElement=d(".tui-image-editor"),this._menuElement=d(".tui-image-editor-menu"),this._subMenuElement=d(".tui-image-editor-submenu")}},{key:"_makeMenuElement",value:function(e){var t=document.createElement("li"),n=this.theme.getStyle("menu.icon"),i=n.normal,o=n.active,r=n.hover,a='\n            <svg class="svg_ic-menu">\n                <use xlink:href="'.concat(i.path,"#").concat(i.name,"-ic-").concat(e,'" class="normal"/>\n                <use xlink:href="').concat(o.path,"#").concat(o.name,"-ic-").concat(e,'" class="active"/>\n                <use xlink:href="').concat(r.path,"#").concat(r.name,"-ic-").concat(e,'" class="hover"/>\n            </svg>\n        ');t.id="tie-btn-".concat(e),t.className="tui-image-editor-item normal",t.title=e.replace(/^[a-z]/g,function(e){return e.toUpperCase()}),t.innerHTML=a,this._menuElement.appendChild(t)}},{key:"_addHelpActionEvent",value:function(e){var t=this;this._els[e].addEventListener("click",function(){t._actions.main[e]()})}},{key:"_addDownloadEvent",value:function(){var e=this;o.a.forEach(this._els.download,function(t){t.addEventListener("click",function(){e._actions.main.download()})})}},{key:"_addLoadEvent",value:function(){var e=this;o.a.forEach(this._els.load,function(t){t.addEventListener("change",function(t){e._actions.main.load(t.target.files[0])})})}},{key:"_addMenuEvent",value:function(e){var t=this;this._els[e].addEventListener("click",function(){t.changeMenu(e)})}},{key:"_addSubMenuEvent",value:function(e){this[e].addEvent(this._actions[e])}},{key:"getEditorArea",value:function(){return this._editorElement}},{key:"activeMenuEvent",value:function(){var e=this;this._initMenuEvent||(this._addHelpActionEvent("undo"),this._addHelpActionEvent("redo"),this._addHelpActionEvent("reset"),this._addHelpActionEvent("delete"),this._addHelpActionEvent("deleteAll"),this._addDownloadEvent(),o.a.forEach(this.options.menu,function(t){e._addMenuEvent(t),e._addSubMenuEvent(t)}),this._initMenu(),this._initMenuEvent=!0)}},{key:"initCanvas",value:function(){var e=this,t=this._getLoadImage();t.path&&this._actions.main.initLoadImage(t.path,t.name).then(function(){e.activeMenuEvent()}),this._addLoadEvent();var n=document.createElement("div");n.className="tui-image-editor-grid-visual";n.innerHTML='<table>\n           <tr><td class="dot left-top"></td><td></td><td class="dot right-top"></td></tr>\n           <tr><td></td><td></td><td></td></tr>\n           <tr><td class="dot left-bottom"></td><td></td><td class="dot right-bottom"></td></tr>\n         </table>',this._editorContainerElement=this._editorElement.querySelector(".tui-image-editor-canvas-container"),this._editorContainerElement.appendChild(n)}},{key:"_getLoadImage",value:function(){return this.options.loadImage}},{key:"changeMenu",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._submenuChangeTransection||(this._submenuChangeTransection=!0,this._changeMenu(e,t,n),this._submenuChangeTransection=!1)}},{key:"_changeMenu",value:function(e,t,n){this.submenu&&(this._els[this.submenu].classList.remove("active"),this._mainElement.classList.remove("tui-image-editor-menu-".concat(this.submenu)),n&&this._actions.main.discardSelection(),this._actions.main.changeSelectableAll(!0),this[this.submenu].changeStandbyMode()),this.submenu===e&&t?this.submenu=null:(this._els[e].classList.add("active"),this._mainElement.classList.add("tui-image-editor-menu-".concat(e)),this.submenu=e,this[this.submenu].changeStartMode()),this.resizeEditor()}},{key:"_initMenu",value:function(){if(this.options.initMenu){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!1),this._els[this.options.initMenu].dispatchEvent(e),this.icon&&this.icon.registDefaultIcon()}}},{key:"_getEditorDimension",value:function(){var e=parseFloat(this._editorContainerElement.style.maxHeight),t=this.imageSize.newHeight>e?e:this.imageSize.newHeight,n=parseFloat(this._editorContainerElement.style.maxWidth);return{width:this.imageSize.newWidth>n?n:this.imageSize.newWidth,height:t}}},{key:"_setEditorPosition",value:function(e){var t=this._getEditorDimension(),n=t.width,i=t.height,o=this._editorElement.style,r=0,a=0;this.submenu&&("bottom"===e?r=i>this._editorElementWrap.scrollHeight-150?(i-this._editorElementWrap.scrollHeight)/2:-75:"top"===e?r=i>this._editorElementWrap.offsetHeight-150?75-(i-(this._editorElementWrap.offsetHeight-150))/2:75:"left"===e?a=n>this._editorElementWrap.offsetWidth-248?124-(n-(this._editorElementWrap.offsetWidth-248))/2:124:"right"===e&&(a=n>this._editorElementWrap.scrollWidth-248?(n-this._editorElementWrap.scrollWidth)/2:-124)),o.top="".concat(r,"px"),o.left="".concat(a,"px")}}])&&bt(t.prototype,n),i&&bt(t,i),e}();function kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wt(e,t,n){return t&&kt(e.prototype,t),n&&kt(e,n),e}var xt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.versionnumber="1.2.4",this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}]}return wt(e,null,[{key:"tracerDefaultOption",value:function(){return{pathomit:100,ltres:.1,qtres:1,scale:1,strokewidth:5,viewbox:!1,linefilter:!0,desc:!1,rightangleenhance:!1,pal:[{r:0,g:0,b:0,a:255},{r:255,g:255,b:255,a:255}]}}}]),wt(e,[{key:"imageToSVG",value:function(e,t,n){var i=this;n=this.checkoptions(n),this.loadImage(e,function(e){t(i.imagedataToSVG(i.getImgdata(e),n))},n)}},{key:"imagedataToSVG",value:function(e,t){t=this.checkoptions(t);var n=this.imagedataToTracedata(e,t);return this.getsvgstring(n,t)}},{key:"imageToTracedata",value:function(e,t,n){var i=this;n=this.checkoptions(n),this.loadImage(e,function(e){t(i.imagedataToTracedata(i.getImgdata(e),n))},n)}},{key:"imagedataToTracedata",value:function(e,t){t=this.checkoptions(t);var n,i=this.colorquantization(e,t);if(0===t.layering){n={layers:[],palette:i.palette,width:i.array[0].length-2,height:i.array.length-2};for(var o=0;o<i.palette.length;o+=1){var r=this.batchtracepaths(this.internodes(this.pathscan(this.layeringstep(i,o),t.pathomit),t),t.ltres,t.qtres);n.layers.push(r)}}else{var a=this.layering(i);t.layercontainerid&&this.drawLayers(a,this.specpalette,t.scale,t.layercontainerid);var s=this.batchpathscan(a,t.pathomit),c=this.batchinternodes(s,t);n={layers:this.batchtracelayers(c,t.ltres,t.qtres),palette:i.palette,width:e.width,height:e.height}}return n}},{key:"checkoptions",value:function(e){"string"==typeof(e=e||{})&&(e=e.toLowerCase(),e=this.optionpresets[e]?this.optionpresets[e]:{});for(var t=Object.keys(this.optionpresets.default),n=0;n<t.length;n+=1)e.hasOwnProperty(t[n])||(e[t[n]]=this.optionpresets.default[t[n]]);return e}},{key:"colorquantization",value:function(e,t){var n,i,o,r,a,s,c,l,u=[],h=0,d=[],f=e.width*e.height;for(a=0;a<e.height+2;a+=1)for(u[a]=[],r=0;r<e.width+2;r+=1)u[a][r]=-1;for(l=t.pal?t.pal:0===t.colorsampling?this.generatepalette(t.numberofcolors):1===t.colorsampling?this.samplepalette(t.numberofcolors,e):this.samplepalette2(t.numberofcolors,e),t.blurradius>0&&(e=this.blur(e,t.blurradius,t.blurdelta)),c=0;c<t.colorquantcycles;c+=1){if(c>0)for(s=0;s<l.length;s+=1)d[s].n>0&&(l[s]={r:Math.floor(d[s].r/d[s].n),g:Math.floor(d[s].g/d[s].n),b:Math.floor(d[s].b/d[s].n),a:Math.floor(d[s].a/d[s].n)}),d[s].n/f<t.mincolorratio&&c<t.colorquantcycles-1&&(l[s]={r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())});for(r=0;r<l.length;r+=1)d[r]={r:0,g:0,b:0,a:0,n:0};for(a=0;a<e.height;a+=1)for(r=0;r<e.width;r+=1){for(h=4*(a*e.width+r),o=0,i=1024,s=0;s<l.length;s+=1)(n=Math.abs(l[s].r-e.data[h])+Math.abs(l[s].g-e.data[h+1])+Math.abs(l[s].b-e.data[h+2])+Math.abs(l[s].a-e.data[h+3]))<i&&(i=n,o=s);d[o].r+=e.data[h],d[o].g+=e.data[h+1],d[o].b+=e.data[h+2],d[o].a+=e.data[h+3],d[o].n+=1,u[a+1][r+1]=o}}return{array:u,palette:l}}},{key:"samplepalette",value:function(e,t){for(var n,i=[],o=0;o<e;o+=1)n=4*Math.floor(Math.random()*t.data.length/4),i.push({r:t.data[n],g:t.data[n+1],b:t.data[n+2],a:t.data[n+3]});return i}},{key:"samplepalette2",value:function(e,t){for(var n,i=[],o=Math.ceil(Math.sqrt(e)),r=Math.ceil(e/o),a=t.width/(o+1),s=t.height/(r+1),c=0;c<r;c+=1)for(var l=0;l<o&&i.length!==e;l+=1)n=4*Math.floor((c+1)*s*t.width+(l+1)*a),i.push({r:t.data[n],g:t.data[n+1],b:t.data[n+2],a:t.data[n+3]});return i}},{key:"generatepalette",value:function(e){var t,n,i,o=[];if(e<8)for(var r=Math.floor(255/(e-1)),a=0;a<e;a+=1)o.push({r:a*r,g:a*r,b:a*r,a:255});else{var s=Math.floor(Math.pow(e,1/3)),c=Math.floor(255/(s-1)),l=e-s*s*s;for(t=0;t<s;t+=1)for(n=0;n<s;n+=1)for(i=0;i<s;i+=1)o.push({r:t*c,g:n*c,b:i*c,a:255});for(t=0;t<l;t+=1)o.push({r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())})}return o}},{key:"layering",value:function(e){var t,n,i,o,r,a,s,c,l,u,h,d=[],f=0,p=e.array.length,g=e.array[0].length;for(h=0;h<e.palette.length;h+=1)for(d[h]=[],u=0;u<p;u+=1)for(d[h][u]=[],l=0;l<g;l+=1)d[h][u][l]=0;for(u=1;u<p-1;u+=1)for(l=1;l<g-1;l+=1)f=e.array[u][l],t=e.array[u-1][l-1]===f?1:0,n=e.array[u-1][l]===f?1:0,i=e.array[u-1][l+1]===f?1:0,o=e.array[u][l-1]===f?1:0,r=e.array[u][l+1]===f?1:0,a=e.array[u+1][l-1]===f?1:0,s=e.array[u+1][l]===f?1:0,c=e.array[u+1][l+1]===f?1:0,d[f][u+1][l+1]=1+2*r+4*c+8*s,o||(d[f][u+1][l]=2+4*s+8*a),n||(d[f][u][l+1]=0+2*i+4*r+8),t||(d[f][u][l]=0+2*n+4+8*o);return d}},{key:"layeringstep",value:function(e,t){var n,i,o=[],r=e.array.length,a=e.array[0].length;for(i=0;i<r;i+=1)for(o[i]=[],n=0;n<a;n+=1)o[i][n]=0;for(i=1;i<r;i+=1)for(n=1;n<a;n+=1)o[i][n]=(e.array[i-1][n-1]===t?1:0)+(e.array[i-1][n]===t?2:0)+(e.array[i][n-1]===t?8:0)+(e.array[i][n]===t?4:0);return o}},{key:"pathscan",value:function(e,t){for(var n,i=[],o=0,r=0,a=0,s=0,c=e[0].length,l=e.length,u=0,h=!0,d=!1,f=0;f<l;f+=1)for(var p=0;p<c;p+=1)if(4===e[f][p]||11===e[f][p])for(a=p,s=f,i[o]={},i[o].points=[],i[o].boundingbox=[a,s,a,s],i[o].holechildren=[],h=!1,r=0,d=11===e[f][p],u=1;!h;){if(i[o].points[r]={},i[o].points[r].x=a-1,i[o].points[r].y=s-1,i[o].points[r].t=e[s][a],a-1<i[o].boundingbox[0]&&(i[o].boundingbox[0]=a-1),a-1>i[o].boundingbox[2]&&(i[o].boundingbox[2]=a-1),s-1<i[o].boundingbox[1]&&(i[o].boundingbox[1]=s-1),s-1>i[o].boundingbox[3]&&(i[o].boundingbox[3]=s-1),n=this.pathscan_combined_lookup[e[s][a]][u],e[s][a]=n[0],u=n[1],a+=n[2],s+=n[3],a-1===i[o].points[0].x&&s-1===i[o].points[0].y)if(h=!0,i[o].points.length<t)i.pop();else{if(i[o].isholepath=!!d,d){for(var g=0,v=[-1,-1,c+1,l+1],m=0;m<o;m++)!i[m].isholepath&&this.boundingboxincludes(i[m].boundingbox,i[o].boundingbox)&&this.boundingboxincludes(v,i[m].boundingbox)&&(g=m,v=i[m].boundingbox);i[g].holechildren.push(o)}o+=1}r+=1}return i}},{key:"boundingboxincludes",value:function(e,t){return e[0]<t[0]&&e[1]<t[1]&&e[2]>t[2]&&e[3]>t[3]}},{key:"batchpathscan",value:function(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&(n[i]=this.pathscan(e[i],t));return n}},{key:"internodes",value:function(e,t){var n,i,o=[],r=0,a=0,s=0,c=0,l=0;for(n=0;n<e.length;n+=1)for(o[n]={},o[n].points=[],o[n].boundingbox=e[n].boundingbox,o[n].holechildren=e[n].holechildren,o[n].isholepath=e[n].isholepath,r=e[n].points.length,i=0;i<r;i+=1)a=(i+1)%r,s=(i+2)%r,c=(i-1+r)%r,l=(i-2+r)%r,t.rightangleenhance&&this.testrightangle(e[n],l,c,i,a,s)&&(o[n].points.length>0&&(o[n].points[o[n].points.length-1].linesegment=this.getdirection(o[n].points[o[n].points.length-1].x,o[n].points[o[n].points.length-1].y,e[n].points[i].x,e[n].points[i].y)),o[n].points.push({x:e[n].points[i].x,y:e[n].points[i].y,linesegment:this.getdirection(e[n].points[i].x,e[n].points[i].y,(e[n].points[i].x+e[n].points[a].x)/2,(e[n].points[i].y+e[n].points[a].y)/2)})),o[n].points.push({x:(e[n].points[i].x+e[n].points[a].x)/2,y:(e[n].points[i].y+e[n].points[a].y)/2,linesegment:this.getdirection((e[n].points[i].x+e[n].points[a].x)/2,(e[n].points[i].y+e[n].points[a].y)/2,(e[n].points[a].x+e[n].points[s].x)/2,(e[n].points[a].y+e[n].points[s].y)/2)});return o}},{key:"testrightangle",value:function(e,t,n,i,o,r){return e.points[i].x===e.points[t].x&&e.points[i].x===e.points[n].x&&e.points[i].y===e.points[o].y&&e.points[i].y===e.points[r].y||e.points[i].y===e.points[t].y&&e.points[i].y===e.points[n].y&&e.points[i].x===e.points[o].x&&e.points[i].x===e.points[r].x}},{key:"getdirection",value:function(e,t,n,i){return e<n?t<i?1:t>i?7:0:e>n?t<i?3:t>i?5:4:t<i?2:t>i?6:8}},{key:"batchinternodes",value:function(e,t){var n=[];for(var i in e)e.hasOwnProperty(i)&&(n[i]=this.internodes(e[i],t));return n}},{key:"tracepath",value:function(e,t,n){var i,o,r,a=0,s={segments:[]};for(s.boundingbox=e.boundingbox,s.holechildren=e.holechildren,s.isholepath=e.isholepath;a<e.points.length;){for(i=e.points[a].linesegment,o=-1,r=a+1;(e.points[r].linesegment===i||e.points[r].linesegment===o||-1===o)&&r<e.points.length-1;)e.points[r].linesegment!==i&&-1===o&&(o=e.points[r].linesegment),r+=1;r===e.points.length-1&&(r=0),s.segments=s.segments.concat(this.fitseq(e,t,n,a,r)),a=r>0?r:e.points.length}return s}},{key:"fitseq",value:function(e,t,n,i,o){if(o>e.points.length||o<0)return[];var r,a,s,c=i,l=0,u=!0,h=o-i;h<0&&(h+=e.points.length);for(var d,f=(e.points[o].x-e.points[i].x)/h,p=(e.points[o].y-e.points[i].y)/h,g=(i+1)%e.points.length;g!=o;)(d=g-i)<0&&(d+=e.points.length),r=e.points[i].x+f*d,a=e.points[i].y+p*d,(s=(e.points[g].x-r)*(e.points[g].x-r)+(e.points[g].y-a)*(e.points[g].y-a))>t&&(u=!1),s>l&&(c=g,l=s),g=(g+1)%e.points.length;if(u)return[{type:"L",x1:e.points[i].x,y1:e.points[i].y,x2:e.points[o].x,y2:e.points[o].y}];var v=c;u=!0,l=0;var m=(v-i)/h,b=(1-m)*(1-m),y=2*(1-m)*m,_=m*m,k=(b*e.points[i].x+_*e.points[o].x-e.points[v].x)/-y,w=(b*e.points[i].y+_*e.points[o].y-e.points[v].y)/-y;for(g=i+1;g!=o;)y=2*(1-(m=(g-i)/h))*m,_=m*m,r=(b=(1-m)*(1-m))*e.points[i].x+y*k+_*e.points[o].x,a=b*e.points[i].y+y*w+_*e.points[o].y,(s=(e.points[g].x-r)*(e.points[g].x-r)+(e.points[g].y-a)*(e.points[g].y-a))>n&&(u=!1),s>l&&(c=g,l=s),g=(g+1)%e.points.length;if(u)return[{type:"Q",x1:e.points[i].x,y1:e.points[i].y,x2:k,y2:w,x3:e.points[o].x,y3:e.points[o].y}];var x=v;return this.fitseq(e,t,n,i,x).concat(this.fitseq(e,t,n,x,o))}},{key:"batchtracepaths",value:function(e,t,n){var i=[];for(var o in e)e.hasOwnProperty(o)&&i.push(this.tracepath(e[o],t,n));return i}},{key:"batchtracelayers",value:function(e,t,n){var i=[];for(var o in e)e.hasOwnProperty(o)&&(i[o]=this.batchtracepaths(e[o],t,n));return i}},{key:"roundtodec",value:function(e,t){return Number(e.toFixed(t))}},{key:"svgpathstring",value:function(e,t,n,i){var o,r=e.layers[t],a=r[n],s="";if(i.linefilter&&a.segments.length<3)return s;if(s="<path ".concat(i.desc?'desc="l '.concat(t," p ").concat(n,'" '):"").concat(this.tosvgcolorstr(e.palette[t],i),'d="'),-1===i.roundcoords){for(s+="M ".concat(a.segments[0].x1*i.scale," ").concat(a.segments[0].y1*i.scale," "),o=0;o<a.segments.length;o++)s+="".concat(a.segments[o].type," ").concat(a.segments[o].x2*i.scale," ").concat(a.segments[o].y2*i.scale," "),a.segments[o].hasOwnProperty("x3")&&(s+="".concat(a.segments[o].x3*i.scale," ").concat(a.segments[o].y3*i.scale," "));s+="Z "}else{for(s+="M ".concat(this.roundtodec(a.segments[0].x1*i.scale,i.roundcoords)," ").concat(this.roundtodec(a.segments[0].y1*i.scale,i.roundcoords)," "),o=0;o<a.segments.length;o++)s+="".concat(a.segments[o].type," ").concat(this.roundtodec(a.segments[o].x2*i.scale,i.roundcoords)," ").concat(this.roundtodec(a.segments[o].y2*i.scale,i.roundcoords)," "),a.segments[o].hasOwnProperty("x3")&&(s+="".concat(this.roundtodec(a.segments[o].x3*i.scale,i.roundcoords)," ").concat(this.roundtodec(a.segments[o].y3*i.scale,i.roundcoords)," "));s+="Z "}for(var c=0;c<a.holechildren.length;c++){var l=r[a.holechildren[c]];if(-1===i.roundcoords)for(l.segments[l.segments.length-1].hasOwnProperty("x3")?s+="M ".concat(l.segments[l.segments.length-1].x3*i.scale," ").concat(l.segments[l.segments.length-1].y3*i.scale," "):s+="M ".concat(l.segments[l.segments.length-1].x2*i.scale," ").concat(l.segments[l.segments.length-1].y2*i.scale," "),o=l.segments.length-1;o>=0;o--)s+="".concat(l.segments[o].type," "),l.segments[o].hasOwnProperty("x3")&&(s+="".concat(l.segments[o].x2*i.scale," ").concat(l.segments[o].y2*i.scale," ")),s+="".concat(l.segments[o].x1*i.scale," ").concat(l.segments[o].y1*i.scale," ");else for(l.segments[l.segments.length-1].hasOwnProperty("x3")?s+="M ".concat(this.roundtodec(l.segments[l.segments.length-1].x3*i.scale)," ").concat(this.roundtodec(l.segments[l.segments.length-1].y3*i.scale)," "):s+="M ".concat(this.roundtodec(l.segments[l.segments.length-1].x2*i.scale)," ").concat(this.roundtodec(l.segments[l.segments.length-1].y2*i.scale)," "),o=l.segments.length-1;o>=0;o--)s+="".concat(l.segments[o].type," "),l.segments[o].hasOwnProperty("x3")&&(s+="".concat(this.roundtodec(l.segments[o].x2*i.scale)," ").concat(this.roundtodec(l.segments[o].y2*i.scale)," ")),s+="".concat(this.roundtodec(l.segments[o].x1*i.scale)," ").concat(this.roundtodec(l.segments[o].y1*i.scale)," ");s+="Z "}if(s+='" />',i.lcpr||i.qcpr){for(o=0;o<a.segments.length;o++)a.segments[o].hasOwnProperty("x3")&&i.qcpr&&(s+='<circle cx="'.concat(a.segments[o].x2*i.scale,'" cy="').concat(a.segments[o].y2*i.scale,'" r="').concat(i.qcpr,'" fill="cyan" stroke-width="').concat(.2*i.qcpr,'" stroke="black" />'),s+='<circle cx="'.concat(a.segments[o].x3*i.scale,'" cy="').concat(a.segments[o].y3*i.scale,'" r="').concat(i.qcpr,'" fill="white" stroke-width="').concat(.2*i.qcpr,'" stroke="black" />'),s+='<line x1="'.concat(a.segments[o].x1*i.scale,'" y1="').concat(a.segments[o].y1*i.scale,'" x2="').concat(a.segments[o].x2*i.scale,'" y2="').concat(a.segments[o].y2*i.scale,'" stroke-width="').concat(.2*i.qcpr,'" stroke="cyan" />'),s+='<line x1="'.concat(a.segments[o].x2*i.scale,'" y1="').concat(a.segments[o].y2*i.scale,'" x2="').concat(a.segments[o].x3*i.scale,'" y2="').concat(a.segments[o].y3*i.scale,'" stroke-width="').concat(.2*i.qcpr,'" stroke="cyan" />')),!a.segments[o].hasOwnProperty("x3")&&i.lcpr&&(s+='<circle cx="'.concat(a.segments[o].x2*i.scale,'" cy="').concat(a.segments[o].y2*i.scale,'" r="').concat(i.lcpr,'" fill="white" stroke-width="').concat(.2*i.lcpr,'" stroke="black" />'));for(c=0;c<a.holechildren.length;c++){l=r[a.holechildren[c]];for(o=0;o<l.segments.length;o++)l.segments[o].hasOwnProperty("x3")&&i.qcpr&&(s+='<circle cx="'.concat(l.segments[o].x2*i.scale,'" cy="').concat(l.segments[o].y2*i.scale,'" r="').concat(i.qcpr,'" fill="cyan" stroke-width="').concat(.2*i.qcpr,'" stroke="black" />'),s+='<circle cx="'.concat(l.segments[o].x3*i.scale,'" cy="').concat(l.segments[o].y3*i.scale,'" r="').concat(i.qcpr,'" fill="white" stroke-width="').concat(.2*i.qcpr,'" stroke="black" />'),s+='<line x1="'.concat(l.segments[o].x1*i.scale,'" y1="').concat(l.segments[o].y1*i.scale,'" x2="').concat(l.segments[o].x2*i.scale,'" y2="').concat(l.segments[o].y2*i.scale,'" stroke-width="').concat(.2*i.qcpr,'" stroke="cyan" />'),s+='<line x1="'.concat(l.segments[o].x2*i.scale,'" y1="').concat(l.segments[o].y2*i.scale,'" x2="').concat(l.segments[o].x3*i.scale,'" y2="').concat(l.segments[o].y3*i.scale,'" stroke-width="').concat(.2*i.qcpr,'" stroke="cyan" />')),!l.segments[o].hasOwnProperty("x3")&&i.lcpr&&(s+='<circle cx="'.concat(l.segments[o].x2*i.scale,'" cy="').concat(l.segments[o].y2*i.scale,'" r="').concat(i.lcpr,'" fill="white" stroke-width="').concat(.2*i.lcpr,'" stroke="black" />'))}}return s}},{key:"getsvgstring",value:function(e,t){t=this.checkoptions(t);for(var n=e.width*t.scale,i=e.height*t.scale,o="<svg ".concat(t.viewbox?'viewBox="0 0 '.concat(n," ").concat(i,'" '):'width="'.concat(n,'" height="').concat(i,'" '),'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version ').concat(this.versionnumber,'" >'),r=0;r<e.layers.length;r+=1)for(var a=0;a<e.layers[r].length;a+=1)e.layers[r][a].isholepath||(o+=this.svgpathstring(e,r,a,t));return o+="</svg>"}},{key:"compareNumbers",value:function(e,t){return e-t}},{key:"torgbastr",value:function(e){return"rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")")}},{key:"tosvgcolorstr",value:function(e,t){return'fill="rgb('.concat(e.r,",").concat(e.g,",").concat(e.b,')" stroke="rgb(').concat(e.r,",").concat(e.g,",").concat(e.b,')" stroke-width="').concat(t.strokewidth,'" opacity="').concat(e.a/255,'" ')}},{key:"appendSVGString",value:function(e,t){var n;t?(n=document.getElementById(t))||((n=document.createElement("div")).id=t,document.body.appendChild(n)):(n=document.createElement("div"),document.body.appendChild(n)),n.innerHTML+=e}},{key:"blur",value:function(e,t,n){var i,o,r,a,s,c,l,u,h,d={width:e.width,height:e.height,data:[]};if((t=Math.floor(t))<1)return e;t>5&&(t=5),(n=Math.abs(n))>1024&&(n=1024);var f=this.gks[t-1];for(o=0;o<e.height;o++)for(i=0;i<e.width;i++){for(s=0,c=0,l=0,u=0,h=0,r=-t;r<t+1;r++)i+r>0&&i+r<e.width&&(a=4*(o*e.width+i+r),s+=e.data[a]*f[r+t],c+=e.data[a+1]*f[r+t],l+=e.data[a+2]*f[r+t],u+=e.data[a+3]*f[r+t],h+=f[r+t]);a=4*(o*e.width+i),d.data[a]=Math.floor(s/h),d.data[a+1]=Math.floor(c/h),d.data[a+2]=Math.floor(l/h),d.data[a+3]=Math.floor(u/h)}var p=new Uint8ClampedArray(d.data);for(o=0;o<e.height;o++)for(i=0;i<e.width;i++){for(s=0,c=0,l=0,u=0,h=0,r=-t;r<t+1;r++)o+r>0&&o+r<e.height&&(s+=p[a=4*((o+r)*e.width+i)]*f[r+t],c+=p[a+1]*f[r+t],l+=p[a+2]*f[r+t],u+=p[a+3]*f[r+t],h+=f[r+t]);a=4*(o*e.width+i),d.data[a]=Math.floor(s/h),d.data[a+1]=Math.floor(c/h),d.data[a+2]=Math.floor(l/h),d.data[a+3]=Math.floor(u/h)}for(o=0;o<e.height;o++)for(i=0;i<e.width;i++)a=4*(o*e.width+i),Math.abs(d.data[a]-e.data[a])+Math.abs(d.data[a+1]-e.data[a+1])+Math.abs(d.data[a+2]-e.data[a+2])+Math.abs(d.data[a+3]-e.data[a+3])>n&&(d.data[a]=e.data[a],d.data[a+1]=e.data[a+1],d.data[a+2]=e.data[a+2],d.data[a+3]=e.data[a+3]);return d}},{key:"loadImage",value:function(e,t,n){var i=new Image;n&&n.corsenabled&&(i.crossOrigin="Anonymous"),i.src=e,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0),t(e)}}},{key:"getImgdata",value:function(e){return e.getContext("2d").getImageData(0,0,e.width,e.height)}},{key:"drawLayers",value:function(e,t,n,i){var o,r,a,s,c,l;for(c in n=n||1,i?(l=document.getElementById(i))||((l=document.createElement("div")).id=i,document.body.appendChild(l)):(l=document.createElement("div"),document.body.appendChild(l)),e)if(e.hasOwnProperty(c)){o=e[c][0].length,r=e[c].length;var u=document.createElement("canvas");u.width=o*n,u.height=r*n;var h=u.getContext("2d");for(s=0;s<r;s+=1)for(a=0;a<o;a+=1)h.fillStyle=this.torgbastr(t[e[c][s][a]%t.length]),h.fillRect(a*n,s*n,n,n);l.appendChild(u)}}}]),e}(),Et={getActions:function(){return{main:this._mainAction(),shape:this._shapeAction(),crop:this._cropAction(),flip:this._flipAction(),rotate:this._rotateAction(),text:this._textAction(),mask:this._maskAction(),draw:this._drawAction(),icon:this._iconAction(),filter:this._filterAction()}},_mainAction:function(){var e=this,t=function(){"crop"===e.ui.submenu&&(e.stopDrawingMode(),e.ui.changeMenu("crop"))};return Object(i.extend)({initLoadImage:function(n,i){return e.loadImageFromURL(n,i).then(function(i){t(),e.ui.initializeImgUrl=n,e.ui.resizeEditor({imageSize:i}),e.clearUndoStack()})},undo:function(){e.isEmptyUndoStack()||(t(),e.undo())},redo:function(){e.isEmptyRedoStack()||(t(),e.redo())},reset:function(){t(),e.loadImageFromURL(e.ui.initializeImgUrl,"resetImage").then(function(n){t(),e.ui.resizeEditor({imageSize:n}),e.clearUndoStack()})},delete:function(){e.ui.changeDeleteButtonEnabled(!1),t(),e.removeActiveObject(),e.activeObjectId=null},deleteAll:function(){t(),e.clearObjects(),e.ui.changeDeleteButtonEnabled(!1),e.ui.changeDeleteAllButtonEnabled(!1)},load:function(n){p()||alert("This browser does not support file-api"),e.ui.initializeImgUrl=URL.createObjectURL(n),e.loadImageFromFile(n).then(function(n){t(),e.clearUndoStack(),e.ui.activeMenuEvent(),e.ui.resizeEditor({imageSize:n})}).catch(function(e){return Promise.reject(e)})},download:function(){var t,n,i=e.toDataURL(),o=e.getImageName();p()&&window.saveAs?(n=(t=function(e){var t,n,i,o="";t=e.replace(/data:(image\/.+);base64,/,function(e,t){return o=t,""});var r=(t=atob(t)).length;for(n=new Uint8Array(r),i=0;i<r;i+=1)n[i]=t.charCodeAt(i);return new Blob([n],{type:o})}(i)).type.split("/")[1],o.split(".").pop()!==n&&(o+=".".concat(n)),saveAs(t,o)):window.open().document.body.innerHTML="<img src='".concat(i,"'>")}},this._commonAction())},_iconAction:function(){var e,t,n,o,r,a,s,c=this;this.on({iconCreateResize:function(e){var t=e.moveOriginPointer,i=(t.x-n)/r,l=(t.y-o)/a;c.setObjectPropertiesQuietly(s,{scaleX:Math.abs(2*i),scaleY:Math.abs(2*l)})},iconCreateEnd:function(){c.ui.icon.clearIconType(),c.changeSelectableAll(!0)}});return Object(i.extend)({changeColor:function(e){c.activeObjectId&&c.changeIconColor(c.activeObjectId,e)},addIcon:function(i,l){e=i,t=l,c.changeCursor("crosshair"),c.off("mousedown"),c.once("mousedown",function(i,l){n=l.x,o=l.y,c.addIcon(e,{left:l.x,top:l.y,fill:t}).then(function(e){s=e.id,r=e.width,a=e.height})}.bind(c))},cancelAddIcon:function(){c.off("mousedown"),c.ui.icon.clearIconType(),c.changeSelectableAll(!0),c.changeCursor("default")},registDefalutIcons:function(e,t){var n={};n[e]=t,c.registerIcons(n)},registCustomIcon:function(e,t){(new xt).imageToSVG(e,function(e){var n=e.match(/path[^>]*d="([^"]*)"/)[1],i={};i[t.name]=n,c.registerIcons(i),c.addIcon(t.name,{left:100,top:100})},xt.tracerDefaultOption())}},this._commonAction())},_drawAction:function(){var e=this;return Object(i.extend)({setDrawMode:function(t,n){e.stopDrawingMode(),"free"===t?e.startDrawingMode("FREE_DRAWING",n):e.startDrawingMode("LINE_DRAWING",n)},setColor:function(t){e.setBrush({color:t})}},this._commonAction())},_maskAction:function(){var e=this;return Object(i.extend)({loadImageFromURL:function(t,n){return e.loadImageFromURL(e.toDataURL(),"FilterImage").then(function(){e.addImageObject(t).then(function(){URL.revokeObjectURL(n)})})},applyFilter:function(){e.applyFilter("mask",{maskObjId:e.activeObjectId})}},this._commonAction())},_textAction:function(){var e=this;return Object(i.extend)({changeTextStyle:function(t){e.activeObjectId&&e.changeTextStyle(e.activeObjectId,t)}},this._commonAction())},_rotateAction:function(){var e=this;return Object(i.extend)({rotate:function(t){e.rotate(t),e.ui.resizeEditor()},setAngle:function(t){e.setAngle(t),e.ui.resizeEditor()}},this._commonAction())},_shapeAction:function(){var e=this;return Object(i.extend)({changeShape:function(t){e.activeObjectId&&e.changeShape(e.activeObjectId,t)},setDrawingShape:function(t){e.setDrawingShape(t)}},this._commonAction())},_cropAction:function(){var e=this;return Object(i.extend)({crop:function(){var t=e.getCropzoneRect();t&&e.crop(t).then(function(){e.stopDrawingMode(),e.ui.resizeEditor(),e.ui.changeMenu("crop")}).catch(function(e){return Promise.reject(e)})},cancel:function(){e.stopDrawingMode(),e.ui.changeMenu("crop")},preset:function(t){switch(t){case"preset-square":e.setCropzoneRect(1);break;case"preset-3-2":e.setCropzoneRect(1.5);break;case"preset-4-3":e.setCropzoneRect(4/3);break;case"preset-5-4":e.setCropzoneRect(5/4);break;case"preset-7-5":e.setCropzoneRect(1.4);break;case"preset-16-9":e.setCropzoneRect(16/9);break;default:e.setCropzoneRect(),e.ui.crop.changeApplyButtonStatus(!1)}}},this._commonAction())},_flipAction:function(){var e=this;return Object(i.extend)({flip:function(t){return e[t]()}},this._commonAction())},_filterAction:function(){var e=this;return Object(i.extend)({applyFilter:function(t,n,i){t?e.applyFilter(n,i):e.hasFilter(n)&&e.removeFilter(n)}},this._commonAction())},setReAction:function(){var e=this;this.on({undoStackChanged:function(t){t?(e.ui.changeUndoButtonStatus(!0),e.ui.changeResetButtonStatus(!0)):(e.ui.changeUndoButtonStatus(!1),e.ui.changeResetButtonStatus(!1)),e.ui.resizeEditor()},redoStackChanged:function(t){t?e.ui.changeRedoButtonStatus(!0):e.ui.changeRedoButtonStatus(!1),e.ui.resizeEditor()},objectActivated:function(t){e.activeObjectId=t.id,e.ui.changeDeleteButtonEnabled(!0),e.ui.changeDeleteAllButtonEnabled(!0),"cropzone"===t.type?e.ui.crop.changeApplyButtonStatus(!0):["rect","circle","triangle"].indexOf(t.type)>-1?(e.stopDrawingMode(),"shape"!==e.ui.submenu&&e.ui.changeMenu("shape",!1,!1),e.ui.shape.setShapeStatus({strokeColor:t.stroke,strokeWidth:t.strokeWidth,fillColor:t.fill}),e.ui.shape.setMaxStrokeValue(Math.min(t.width,t.height))):"path"===t.type||"line"===t.type?"draw"!==e.ui.submenu&&(e.ui.changeMenu("draw",!1,!1),e.ui.draw.changeStandbyMode()):["i-text","text"].indexOf(t.type)>-1?"text"!==e.ui.submenu&&e.ui.changeMenu("text",!1,!1):"icon"===t.type&&(e.stopDrawingMode(),"icon"!==e.ui.submenu&&e.ui.changeMenu("icon",!1,!1),e.ui.icon.setIconPickerColor(t.fill))},addText:function(t){e.addText("Double Click",{position:t.originPosition,styles:{fill:e.ui.text.textColor,fontSize:f(e.ui.text.fontSize),fontFamily:"Noto Sans"}}).then(function(){e.changeCursor("default")})},addObjectAfter:function(t){["rect","circle","triangle"].indexOf(t.type)>-1&&(e.ui.shape.setMaxStrokeValue(Math.min(t.width,t.height)),e.ui.shape.changeStandbyMode())},objectScaled:function(t){if(["i-text","text"].indexOf(t.type)>-1)e.ui.text.fontSize=f(t.fontSize);else if(["rect","circle","triangle"].indexOf(t.type)>=0){var n=t.width,i=t.height,o=e.ui.shape.getStrokeValue();n<o&&e.ui.shape.setStrokeValue(n),i<o&&e.ui.shape.setStrokeValue(i)}},selectionCleared:function(){e.activeObjectId=null,"text"===e.ui.submenu?e.changeCursor("text"):"draw"!==e.ui.submenu&&"crop"!==e.ui.submenu&&e.stopDrawingMode()}})},_commonAction:function(){var e=this;return{modeChange:function(t){switch(t){case"text":e._changeActivateMode("TEXT");break;case"crop":e.startDrawingMode("CROPPER");break;case"shape":e._changeActivateMode("SHAPE"),e.setDrawingShape(e.ui.shape.type,e.ui.shape.options)}},deactivateAll:this.deactivateAll.bind(this),changeSelectableAll:this.changeSelectableAll.bind(this),discardSelection:this.discardSelection.bind(this),stopDrawingMode:this.stopDrawingMode.bind(this)}},mixin:function(e){Object(i.extend)(e.prototype,this)}},St=n(2),Ct=n.n(St);function Ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.graphics=n}var t,n,i;return t=e,(n=[{key:"fire",value:function(){for(var e=this.graphics,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.graphics.fire.apply(e,n)}},{key:"setCanvasImage",value:function(e,t){this.graphics.setCanvasImage(e,t)}},{key:"getCanvasElement",value:function(){return this.graphics.getCanvasElement()}},{key:"getCanvas",value:function(){return this.graphics.getCanvas()}},{key:"getCanvasImage",value:function(){return this.graphics.getCanvasImage()}},{key:"getImageName",value:function(){return this.graphics.getImageName()}},{key:"getEditor",value:function(){return this.graphics.getEditor()}},{key:"getName",value:function(){return this.name}},{key:"setImageProperties",value:function(e,t){this.graphics.setImageProperties(e,t)}},{key:"setCanvasCssDimension",value:function(e){this.graphics.setCanvasCssDimension(e)}},{key:"setCanvasBackstoreDimension",value:function(e){this.graphics.setCanvasBackstoreDimension(e)}},{key:"adjustCanvasDimension",value:function(){this.graphics.adjustCanvasDimension()}}])&&Ot(t.prototype,n),i&&Ot(t,i),e}();function Pt(e){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mt(e,t){return!t||"object"!==Pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var It=O,Rt=D,Lt={padding:0,crossOrigin:"Anonymous"},Bt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Mt(this,At(t).call(this,It.IMAGE_LOADER,e))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,jt),n=t,(i=[{key:"load",value:function(e,t){var n,i=this;if(e||t)n=this._setBackgroundImage(t).then(function(t){return i.setCanvasImage(e,t),i.adjustCanvasDimension(),t});else{var o=this.getCanvas();o.backgroundImage=null,o.renderAll(),n=new a.a(function(e){i.setCanvasImage("",null),e()})}return n}},{key:"_setBackgroundImage",value:function(e){var t=this;return e?new a.a(function(n,i){var o=t.getCanvas();o.setBackgroundImage(e,function(){var e=o.backgroundImage;e.getElement()?n(e):i(Rt.loadingImageFailed)},Lt)}):a.a.reject(Rt.loadImage)}}])&&Tt(n.prototype,i),o&&Tt(n,o),t}(),Ft=Ct.a.util.createClass(Ct.a.Rect,{initialize:function(e,t){(e=o.a.extend(e,t)).type="cropzone",this.callSuper("initialize",e),this.options=e,this.on({moving:this._onMoving,scaling:this._onScaling})},_render:function(e){this.callSuper("_render",e);var t=this.flipX?-1:1,n=this.flipY?-1:1,i=t/this.scaleX,o=n/this.scaleY;e.scale(i,o),this._fillOuterRect(e,"rgba(0, 0, 0, 0.55)"),this.options.lineWidth?(this._fillInnerRect(e),this._strokeBorder(e,"rgb(255, 255, 255)",{lineWidth:this.options.lineWidth})):(this._strokeBorder(e,"rgb(0, 0, 0)",{lineDashWidth:7}),this._strokeBorder(e,"rgb(255, 255, 255)",{lineDashWidth:7,lineDashOffset:7})),e.scale(1/i,1/o)},_fillOuterRect:function(e,t){var n=this._getCoordinates(e),i=n.x,o=n.y;e.save(),e.fillStyle=t,e.beginPath(),e.moveTo(i[0]-1,o[0]-1),e.lineTo(i[3]+1,o[0]-1),e.lineTo(i[3]+1,o[3]+1),e.lineTo(i[0]-1,o[3]+1),e.lineTo(i[0]-1,o[0]-1),e.closePath(),e.moveTo(i[1],o[1]),e.lineTo(i[1],o[2]),e.lineTo(i[2],o[2]),e.lineTo(i[2],o[1]),e.lineTo(i[1],o[1]),e.closePath(),e.fill(),e.restore()},_fillInnerRect:function(e){var t=this._getCoordinates(e),n=t.x,i=t.y,o=this._caculateInnerPosition(n,(n[2]-n[1])/3),r=this._caculateInnerPosition(i,(i[2]-i[1])/3);e.save(),e.strokeStyle="rgba(255, 255, 255, 0.7)",e.lineWidth=this.options.lineWidth,e.beginPath(),e.moveTo(o[0],r[1]),e.lineTo(o[3],r[1]),e.moveTo(o[0],r[2]),e.lineTo(o[3],r[2]),e.moveTo(o[1],r[0]),e.lineTo(o[1],r[3]),e.moveTo(o[2],r[0]),e.lineTo(o[2],r[3]),e.stroke(),e.closePath(),e.restore()},_caculateInnerPosition:function(e,t){var n=[];return n[0]=e[1],n[1]=e[1]+t,n[2]=e[1]+2*t,n[3]=e[2],n},_getCoordinates:function(e){var t=this.getWidth(),n=this.getHeight(),i=t/2,r=n/2,a=this.getLeft(),s=this.getTop(),c=e.canvas;return{x:o.a.map([-(i+a),-i,i,i+(c.width-a-t)],Math.ceil),y:o.a.map([-(r+s),-r,r,r+(c.height-s-n)],Math.ceil)}},_strokeBorder:function(e,t,n){var i=n.lineDashWidth,o=n.lineDashOffset,r=n.lineWidth,a=this.getWidth()/2,s=this.getHeight()/2;e.save(),e.strokeStyle=t,e.setLineDash&&e.setLineDash([i,i]),o&&(e.lineDashOffset=o),r&&(e.lineWidth=r),e.beginPath(),e.moveTo(-a,-s),e.lineTo(a,-s),e.lineTo(a,s),e.lineTo(-a,s),e.lineTo(-a,-s),e.stroke(),e.restore()},_onMoving:function(){var e=this.getLeft(),t=this.getTop(),n=this.getWidth(),i=this.getHeight(),o=this.canvas.getWidth()-n,r=this.canvas.getHeight()-i;this.setLeft(u(e,0,o)),this.setTop(u(t,0,r))},_onScaling:function(e){var t=this.canvas.getPointer(e.e),n=this._calcScalingSizeFromPointer(t);this.scale(1).set(n)},_calcScalingSizeFromPointer:function(e){var t=e.x,n=e.y,i=this._calcTopLeftScalingSizeFromPointer(t,n),o=this._calcBottomRightScalingSizeFromPointer(t,n);return this._makeScalingSettings(i,o)},_calcTopLeftScalingSizeFromPointer:function(e,t){var n=this.getHeight()+this.top,i=this.getWidth()+this.left,o=u(t,0,n-1),r=u(e,0,i-1);return{top:o,left:r,width:i-r,height:n-o}},_calcBottomRightScalingSizeFromPointer:function(e,t){var n=this.canvas,i=n.width,o=n.height,r=this.left,a=this.top;return{width:u(e,r+1,i)-r,height:u(t,a+1,o)-a}},_makeScalingSettings:function(e,t){var n,i=e.width,o=e.height,r=t.height,a=t.width,s=e.left,c=e.top;switch(this.__corner){case"tl":n=e;break;case"tr":n={width:a,height:o,top:c};break;case"bl":n={width:i,height:r,left:s};break;case"br":n=t;break;case"ml":n={width:i,left:s};break;case"mt":n={height:o,top:c};break;case"mr":n={width:a};break;case"mb":n={height:r}}return n},isValid:function(){return this.left>=0&&this.top>=0&&this.width>0&&this.height>0}});function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ht(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zt(e){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ut(e,t){return(Ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Xt={top:-10,left:-10,height:1,width:1},Vt=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=zt(t).call(this,O.CROPPER,e))||"object"!==Nt(o)&&"function"!=typeof o?Wt(i):o)._cropzone=null,n._startX=null,n._startY=null,n._withShiftKey=!1,n._listeners={keydown:n._onKeyDown.bind(Wt(Wt(n))),keyup:n._onKeyUp.bind(Wt(Wt(n))),mousedown:n._onFabricMouseDown.bind(Wt(Wt(n))),mousemove:n._onFabricMouseMove.bind(Wt(Wt(n))),mouseup:n._onFabricMouseUp.bind(Wt(Wt(n)))},n}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ut(e,t)}(t,jt),n=t,(i=[{key:"start",value:function(){if(!this._cropzone){var e=this.getCanvas();e.forEachObject(function(e){e.evented=!1}),this._cropzone=new Ft({left:-10,top:-10,width:1,height:1,strokeWidth:0,cornerSize:10,cornerColor:"black",fill:"transparent",hasRotatingPoint:!1,hasBorders:!1,lockScalingFlip:!0,lockRotation:!0},this.graphics.cropSelectionStyle),e.deactivateAll(),e.add(this._cropzone),e.on("mouse:down",this._listeners.mousedown),e.selection=!1,e.defaultCursor="crosshair",Ct.a.util.addListener(document,"keydown",this._listeners.keydown),Ct.a.util.addListener(document,"keyup",this._listeners.keyup)}}},{key:"end",value:function(){var e=this.getCanvas(),t=this._cropzone;t&&(t.remove(),e.selection=!0,e.defaultCursor="default",e.off("mouse:down",this._listeners.mousedown),e.forEachObject(function(e){e.evented=!0}),this._cropzone=null,Ct.a.util.removeListener(document,"keydown",this._listeners.keydown),Ct.a.util.removeListener(document,"keyup",this._listeners.keyup))}},{key:"_onFabricMouseDown",value:function(e){var t=this.getCanvas();if(!e.target){t.selection=!1;var n=t.getPointer(e.e);this._startX=n.x,this._startY=n.y,t.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}}},{key:"_onFabricMouseMove",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e),i=n.x,o=n.y,r=this._cropzone;Math.abs(i-this._startX)+Math.abs(o-this._startY)>10&&(r.remove(),r.set(this._calcRectDimensionFromPoint(i,o)),t.add(r))}},{key:"_calcRectDimensionFromPoint",value:function(e,t){var n=this.getCanvas(),i=n.getWidth(),o=n.getHeight(),r=this._startX,a=this._startY,s=u(e,0,r),c=u(t,0,a),l=u(e,r,i)-s,h=u(t,a,o)-c;return this._withShiftKey&&(l>h?h=l:h>l&&(l=h),r>=e&&(s=r-l),a>=t&&(c=a-h)),{left:s,top:c,width:l,height:h}}},{key:"_onFabricMouseUp",value:function(){var e=this._cropzone,t=this._listeners,n=this.getCanvas();n.setActiveObject(e),n.off({"mouse:move":t.mousemove,"mouse:up":t.mouseup})}},{key:"getCroppedImageData",value:function(e){var t=this.getCanvas(),n=t.contains(this._cropzone);if(!e)return null;n&&this._cropzone.remove();var i={imageName:this.getImageName(),url:t.toDataURL(e)};return n&&t.add(this._cropzone),i}},{key:"getCropzoneRect",value:function(){var e=this._cropzone;return e.isValid()?{left:e.getLeft(),top:e.getTop(),width:e.getWidth(),height:e.getHeight()}:null}},{key:"setCropzoneRect",value:function(e){var t=this.getCanvas(),n=this._cropzone;t.deactivateAll(),t.selection=!1,n.remove(),n.set(e?this._getPresetCropSizePosition(e):Xt),t.add(n),t.selection=!0,e&&t.setActiveObject(n)}},{key:"_getPresetCropSizePosition",value:function(e){var t=this.getCanvas(),n=t.getWidth(),i=t.getHeight(),r=n>=i?n:i,a=function(e,t){return e>t?t/e:1},s=r*e,c=r,l=a(s,n),u=o.a.map([s,c],function(e){return e*l});s=u[0];var h=a(c=u[1],i),d=o.a.map([s,c],function(e){return e*h});return s=d[0],{top:(i-(c=d[1]))/2,left:(n-s)/2,width:s,height:c}}},{key:"_onKeyDown",value:function(e){e.keyCode===M.SHIFT&&(this._withShiftKey=!0)}},{key:"_onKeyUp",value:function(e){e.keyCode===M.SHIFT&&(this._withShiftKey=!1)}}])&&Ht(n.prototype,i),r&&Ht(n,r),t}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qt(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kt(e){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jt(e,t){return(Jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=O,$t=D,Qt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qt(this,Kt(t).call(this,Zt.FLIP,e))}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jt(e,t)}(t,jt),n=t,(i=[{key:"getCurrentSetting",value:function(){var e=this.getCanvasImage();return{flipX:e.flipX,flipY:e.flipY}}},{key:"set",value:function(e){var t=this.getCurrentSetting(),n=t.flipX!==e.flipX,i=t.flipY!==e.flipY;return n||i?(o.a.extend(t,e),this.setImageProperties(t,!0),this._invertAngle(n,i),this._flipObjects(n,i),a.a.resolve({flipX:t.flipX,flipY:t.flipY,angle:this.getCanvasImage().angle})):a.a.reject($t.flip)}},{key:"_invertAngle",value:function(e,t){var n=this.getCanvasImage(),i=n.angle;e&&(i*=-1),t&&(i*=-1),n.setAngle(parseFloat(i)).setCoords()}},{key:"_flipObjects",value:function(e,t){var n=this.getCanvas();e&&n.forEachObject(function(e){e.set({angle:parseFloat(-1*e.angle),flipX:!e.flipX,left:n.width-e.left}).setCoords()}),t&&n.forEachObject(function(e){e.set({angle:parseFloat(-1*e.angle),flipY:!e.flipY,top:n.height-e.top}).setCoords()}),n.renderAll()}},{key:"reset",value:function(){return this.set({flipX:!1,flipY:!1})}},{key:"flipX",value:function(){var e=this.getCurrentSetting();return this.set({flipX:!e.flipX,flipY:e.flipY})}},{key:"flipY",value:function(){var e=this.getCurrentSetting();return this.set({flipX:e.flipX,flipY:!e.flipY})}}])&&Yt(n.prototype,i),r&&Yt(n,r),t}();function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nn(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function on(e){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var an=O,sn=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nn(this,on(t).call(this,an.ROTATION,e))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(t,jt),n=t,(i=[{key:"getCurrentAngle",value:function(){return this.getCanvasImage().angle}},{key:"setAngle",value:function(e){var t=this.getCurrentAngle()%360;e%=360;var n=this.getCanvasImage(),i=n.getCenterPoint();n.setAngle(e).setCoords(),this.adjustCanvasDimension();var o=n.getCenterPoint();return this._rotateForEachObject(i,o,e-t),a.a.resolve(e)}},{key:"_rotateForEachObject",value:function(e,t,n){var i=this.getCanvas(),o=e.x-t.x,r=e.y-t.y;i.forEachObject(function(t){var i=t.getCenterPoint(),a=Ct.a.util.degreesToRadians(n),s=Ct.a.util.rotatePoint(i,e,a);t.set({left:s.x-o,top:s.y-r,angle:(t.angle+n)%360}),t.setCoords()}),i.renderAll()}},{key:"rotate",value:function(e){var t=this.getCurrentAngle();return this.setAngle(t+e)}}])&&tn(n.prototype,i),o&&tn(n,o),t}();function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function un(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dn(e,t){return(dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=un(this,hn(t).call(this,O.FREE_DRAWING,e))).width=12,n.oColor=new Ct.a.Color("rgba(0, 0, 0, 0.5)"),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(t,jt),n=t,(i=[{key:"start",value:function(e){this.getCanvas().isDrawingMode=!0,this.setBrush(e)}},{key:"setBrush",value:function(e){var t=this.getCanvas().freeDrawingBrush;e=e||{},this.width=e.width||this.width,e.color&&(this.oColor=new Ct.a.Color(e.color)),t.width=this.width,t.color=this.oColor.toRgba()}},{key:"end",value:function(){this.getCanvas().isDrawingMode=!1}}])&&ln(n.prototype,i),o&&ln(n,o),t}();function pn(e){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vn(e){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mn(e,t){return(mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var yn=P,_n=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=vn(t).call(this,O.LINE,e))||"object"!==pn(o)&&"function"!=typeof o?bn(i):o)._width=12,n._oColor=new Ct.a.Color("rgba(0, 0, 0, 0.5)"),n._listeners={mousedown:n._onFabricMouseDown.bind(bn(bn(n))),mousemove:n._onFabricMouseMove.bind(bn(bn(n))),mouseup:n._onFabricMouseUp.bind(bn(bn(n)))},n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mn(e,t)}(t,jt),n=t,(i=[{key:"start",value:function(e){var t=this.getCanvas();t.defaultCursor="crosshair",t.selection=!1,this.setBrush(e),t.forEachObject(function(e){e.set({evented:!1})}),t.on({"mouse:down":this._listeners.mousedown})}},{key:"setBrush",value:function(e){var t=this.getCanvas().freeDrawingBrush;e=e||{},this._width=e.width||this._width,e.color&&(this._oColor=new Ct.a.Color(e.color)),t.width=this._width,t.color=this._oColor.toRgba()}},{key:"end",value:function(){var e=this.getCanvas();e.defaultCursor="default",e.selection=!0,e.forEachObject(function(e){e.set({evented:!0})}),e.off("mouse:down",this._listeners.mousedown)}},{key:"_onFabricMouseDown",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e),i=[n.x,n.y,n.x,n.y];this._line=new Ct.a.Line(i,{stroke:this._oColor.toRgba(),strokeWidth:this._width,evented:!1}),this._line.set(A.SELECTION_STYLE),t.add(this._line),t.on({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}},{key:"_onFabricMouseMove",value:function(e){var t=this.getCanvas(),n=t.getPointer(e.e);this._line.set({x2:n.x,y2:n.y}),this._line.setCoords(),t.renderAll()}},{key:"_onFabricMouseUp",value:function(){var e=this.getCanvas(),t=this.graphics.createObjectProperties(this._line);this.fire(yn.ADD_OBJECT,t),this._line=null,e.off({"mouse:move":this._listeners.mousemove,"mouse:up":this._listeners.mouseup})}}])&&gn(n.prototype,i),o&&gn(n,o),t}();function kn(e){return(kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xn(e){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Cn,On,jn=P,Pn={fill:"#000000",left:0,top:0},Tn={fill:"#000000",fontStyle:"normal",fontWeight:"normal",textAlign:"left",textDecoraiton:""},Mn=o.a.browser,An=(Cn={position:"absolute",padding:0,display:"none",border:"1px dotted red",overflow:"hidden",resize:"none",outline:"none","border-radius":0,"background-color":"transparent","-webkit-appearance":"none","z-index":9999,"white-space":"pre"},On="",Object(i.forEach)(Cn,function(e,t){On+="".concat(t,": ").concat(e,";")}),On),Dn=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=xn(t).call(this,O.TEXT,e))||"object"!==kn(o)&&"function"!=typeof o?Sn(i):o)._defaultStyles=Pn,n._isSelected=!1,n._selectedObj={},n._editingObj={},n._listeners={mousedown:n._onFabricMouseDown.bind(Sn(Sn(n))),select:n._onFabricSelect.bind(Sn(Sn(n))),selectClear:n._onFabricSelectClear.bind(Sn(Sn(n))),scaling:n._onFabricScaling.bind(Sn(Sn(n)))},n._textarea=null,n._ratio=1,n._lastClickTime=(new Date).getTime(),n._editingObjInfos={},n.isPrevEditing=!1,n.useItext=e.useItext,n}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,jt),n=t,(i=[{key:"start",value:function(){var e=this.getCanvas();e.selection=!1,e.defaultCursor="text",e.on({"mouse:down":this._listeners.mousedown,"object:selected":this._listeners.select,"before:selection:cleared":this._listeners.selectClear,"object:scaling":this._listeners.scaling,"text:editing":this._listeners.modify}),this.useItext?e.forEachObject(function(e){"i-text"===e.type&&e.set({left:e.left-e.width/2,top:e.top-e.height/2,originX:"left",originY:"top"})}):this._createTextarea(),this.setCanvasRatio()}},{key:"end",value:function(){var e=this.getCanvas();e.selection=!0,e.defaultCursor="default",this.useItext?e.forEachObject(function(e){"i-text"===e.type&&(""===e.text?e.remove():e.set({left:e.left+e.width/2,top:e.top+e.height/2,originX:"center",originY:"center"}))}):(e.deactivateAllWithDispatch(),this._removeTextarea()),e.off({"mouse:down":this._listeners.mousedown,"object:selected":this._listeners.select,"before:selection:cleared":this._listeners.selectClear,"object:scaling":this._listeners.scaling,"text:editing":this._listeners.modify})}},{key:"add",value:function(e,t){var n=this;return new a.a(function(i){var r=n.getCanvas(),a=null,s=A.SELECTION_STYLE,c=n._defaultStyles;n._setInitPos(t.position),t.styles&&(c=o.a.extend(c,t.styles)),n.useItext?(a=new Ct.a.IText(e,c),s=o.a.extend({},s,{originX:"left",originY:"top"})):a=new Ct.a.Text(e,c),a.set(s),a.on({mouseup:n._onFabricMouseUp.bind(n)}),r.add(a),r.getActiveObject()||r.setActiveObject(a),n.isPrevEditing=!0,i(n.graphics.createObjectProperties(a))})}},{key:"change",value:function(e,t){var n=this;return new a.a(function(i){e.set("text",t),n.getCanvas().renderAll(),i()})}},{key:"setStyle",value:function(e,t){var n=this;return new a.a(function(i){o.a.forEach(t,function(n,i){e[i]===n&&(t[i]=Tn[i]||"")},n),e.set(t),n.getCanvas().renderAll(),i()})}},{key:"getText",value:function(e){return e.getText()}},{key:"setSelectedInfo",value:function(e,t){this._selectedObj=e,this._isSelected=t}},{key:"isSelected",value:function(){return this._isSelected}},{key:"getSelectedObj",value:function(){return this._selectedObj}},{key:"setCanvasRatio",value:function(){var e=this.getCanvasElement(),t=parseInt(e.style.maxWidth,10),n=e.width/t;this._ratio=n}},{key:"getCanvasRatio",value:function(){return this._ratio}},{key:"_setInitPos",value:function(e){e=e||this.getCanvasImage().getCenterPoint(),this._defaultStyles.left=e.x,this._defaultStyles.top=e.y}},{key:"_createTextarea",value:function(){var e=this.getCanvasElement().parentNode,t=document.createElement("textarea");t.className="tui-image-eidtor-textarea",t.setAttribute("style",An),t.setAttribute("wrap","off"),e.appendChild(t),this._textarea=t,this._listeners=o.a.extend(this._listeners,{input:this._onInput.bind(this),keydown:this._onKeyDown.bind(this),blur:this._onBlur.bind(this),scroll:this._onScroll.bind(this)}),Mn.msie&&9===Mn.version?Ct.a.util.addListener(t,"keydown",this._listeners.keydown):Ct.a.util.addListener(t,"input",this._listeners.input),Ct.a.util.addListener(t,"blur",this._listeners.blur),Ct.a.util.addListener(t,"scroll",this._listeners.scroll)}},{key:"_removeTextarea",value:function(){var e=this.getCanvasElement().parentNode,t=e.querySelector("textarea");e.removeChild(t),this._textarea=null,Mn.msie&&Mn.version<10?Ct.a.util.removeListener(t,"keydown",this._listeners.keydown):Ct.a.util.removeListener(t,"input",this._listeners.input),Ct.a.util.removeListener(t,"blur",this._listeners.blur),Ct.a.util.removeListener(t,"scroll",this._listeners.scroll)}},{key:"_onInput",value:function(){var e=this.getCanvasRatio(),t=this._editingObj,n=this._textarea.style;n.width="".concat(Math.ceil(t.getWidth()/e),"px"),n.height="".concat(Math.ceil(t.getHeight()/e),"px")}},{key:"_onKeyDown",value:function(){var e=this,t=this.getCanvasRatio(),n=this._editingObj,i=this._textarea.style;setTimeout(function(){n.setText(e._textarea.value),i.width="".concat(Math.ceil(n.getWidth()/t),"px"),i.height="".concat(Math.ceil(n.getHeight()/t),"px")},0)}},{key:"_onBlur",value:function(){var e=this.getCanvasRatio(),t=this._editingObj,n=this._editingObjInfos,i=this._textarea.value,r=t.getWidth()/e-n.width/e,a=t.getHeight()/e-n.height/e;if(1===e&&(r/=2,a/=2),this._textarea.style.display="none",t.set({left:n.left+r,top:n.top+a}),i.length){this.getCanvas().add(t);var s={id:o.a.stamp(t),type:t.type,text:i};this.fire(jn.TEXT_CHANGED,s)}}},{key:"_onScroll",value:function(){this._textarea.scrollLeft=0,this._textarea.scrollTop=0}},{key:"_onFabricScaling",value:function(e){var t=e.target,n=t.getFontSize()*t.getScaleY();t.setFontSize(n),t.setScaleX(1),t.setScaleY(1)}},{key:"_onFabricSelectClear",value:function(e){var t=this.getSelectedObj();this.isPrevEditing=!0,this.setSelectedInfo(e.target,!1),t&&""===t.text&&t.remove()}},{key:"_onFabricSelect",value:function(e){this.isPrevEditing=!0,this.setSelectedInfo(e.target,!0)}},{key:"_onFabricMouseDown",value:function(e){var t=e.target;t&&!t.isType("text")||(this.isPrevEditing?this.isPrevEditing=!1:this._fireAddText(e))}},{key:"_fireAddText",value:function(e){var t=e.target,n=e.e||{},i=this.getCanvas().getPointer(n);t||this.fire(jn.ADD_TEXT,{originPosition:{x:i.x,y:i.y},clientPosition:{x:n.clientX||0,y:n.clientY||0}})}},{key:"_onFabricMouseUp",value:function(e){var t=(new Date).getTime();this._isDoubleClick(t)&&(this.useItext||this._changeToEditingMode(e.target),this.fire(jn.TEXT_EDITING)),this._lastClickTime=t}},{key:"_isDoubleClick",value:function(e){return e-this._lastClickTime<500}},{key:"_changeToEditingMode",value:function(e){var t=this.getCanvasRatio(),n=this._textarea.style;this.isPrevEditing=!0,e.remove(),this._editingObj=e,this._textarea.value=e.getText(),this._editingObjInfos={left:this._editingObj.getLeft(),top:this._editingObj.getTop(),width:this._editingObj.getWidth(),height:this._editingObj.getHeight()},n.display="block",n.left="".concat(e.oCoords.tl.x/t,"px"),n.top="".concat(e.oCoords.tl.y/t,"px"),n.width="".concat(Math.ceil(e.getWidth()/t),"px"),n.height="".concat(Math.ceil(e.getHeight()/t),"px"),n.transform="rotate(".concat(e.getAngle(),"deg)"),n.color=e.getFill(),n["font-size"]="".concat(e.getFontSize()/t,"px"),n["font-family"]=e.getFontFamily(),n["font-style"]=e.getFontStyle(),n["font-weight"]=e.getFontWeight(),n["text-align"]=e.getTextAlign(),n["line-height"]=e.getLineHeight()+.1,n["transform-origin"]="left top",this._textarea.focus()}}])&&wn(n.prototype,i),r&&wn(n,r),t}();function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ln(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fn(e,t){return(Fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nn=P,Hn=D,zn={arrow:"M 0 90 H 105 V 120 L 160 60 L 105 0 V 30 H 0 Z",cancel:"M 0 30 L 30 60 L 0 90 L 30 120 L 60 90 L 90 120 L 120 90 L 90 60 L 120 30 L 90 0 L 60 30 L 30 0 Z"},Un=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ln(this,Bn(t).call(this,O.ICON,e)))._oColor="#000000",n._pathMap=zn,n.useDragAddIcon=e.useDragAddIcon,n}var n,i,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fn(e,t)}(t,jt),n=t,(i=[{key:"add",value:function(e,t){var n=this;return new a.a(function(i,r){var a=n.getCanvas(),s=n._pathMap[e],c=A.SELECTION_STYLE,l=Object.keys(I).indexOf(e)>=0,u=n.useDragAddIcon&&l,h=s?n._createIcon(s):null;h||r(Hn.invalidParameters),h.set(o.a.extend({type:"icon",fill:n._oColor},c,t,n.graphics.controlStyle)),a.add(h).setActiveObject(h),u&&n._addWithDragEvent(a),i(n.graphics.createObjectProperties(h))})}},{key:"_addWithDragEvent",value:function(e){var t=this;e.on({"mouse:move":function(n){e.selection=!1,t.fire(Nn.ICON_CREATE_RESIZE,{moveOriginPointer:e.getPointer(n.e)})},"mouse:up":function(n){t.fire(Nn.ICON_CREATE_END,{moveOriginPointer:e.getPointer(n.e)}),e.defaultCursor="default",e.off("mouse:up"),e.off("mouse:move"),e.selection=!0}})}},{key:"registerPaths",value:function(e){var t=this;o.a.forEach(e,function(e,n){t._pathMap[n]=e},this)}},{key:"setColor",value:function(e,t){this._oColor=e,t&&"icon"===t.get("type")&&(t.setFill(this._oColor),this.getCanvas().renderAll())}},{key:"getColor",value:function(e){return e.fill}},{key:"_createIcon",value:function(e){return new Ct.a.Path(e)}}])&&Rn(n.prototype,i),r&&Rn(n,r),t}(),Wn=Ct.a.util.createClass(Ct.a.Image.filters.Mask,{applyTo:function(e){if(this.mask){var t=e.width,n=e.height,i=this._createCanvasOfMask(t,n),o=e.getContext("2d"),r=i.getContext("2d"),a=o.getImageData(0,0,t,n);this._drawMask(r,e,o),this._mapData(r,a,t,n),o.putImageData(a,0,0)}},_createCanvasOfMask:function(e,t){var n=Ct.a.util.createCanvasElement();return n.width=e,n.height=t,n},_drawMask:function(e){var t=this.mask,n=t.getElement(),i=t.getLeft(),o=t.getTop(),r=t.getAngle();e.save(),e.translate(i,o),e.rotate(r*Math.PI/180),e.scale(t.scaleX,t.scaleY),e.drawImage(n,-n.width/2,-n.height/2),e.restore()},_mapData:function(e,t,n,i){for(var o=t.data,r=e.getImageData(0,0,n,i).data,a=this.channel,s=t.width*t.height*4,c=0;c<s;c+=4)o[c+3]=r[c+a]}}),Xn=Ct.a.util.createClass(Ct.a.Image.filters.Convolute,{type:"Blur",initialize:function(){this.matrix=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]}}),Vn=Ct.a.util.createClass(Ct.a.Image.filters.Convolute,{type:"Sharpen",initialize:function(){this.matrix=[0,-1,0,-1,5,-1,0,-1,0]}}),Gn=Ct.a.util.createClass(Ct.a.Image.filters.Convolute,{type:"Emboss",initialize:function(){this.matrix=[1,1,1,1,.7,-1,-1,-1,-1]}}),Yn=Ct.a.util.createClass(Ct.a.Image.filters.BaseFilter,{type:"ColorFilter",initialize:function(e){e||(e={}),this.color=e.color||"#FFFFFF",this.threshold=e.threshold||45,this.x=e.x||null,this.y=e.y||null},applyTo:function(e){var t,n,i=e.getContext("2d"),o=i.getImageData(0,0,e.width,e.height),r=o.data,a=this.threshold,s=Ct.a.Color.sourceFromHex(this.color);for(this.x&&this.y&&(s=this._getColor(o,this.x,this.y)),t=0,n=r.length;t<n;t+=4)this._isOutsideThreshold(r[t],s[0],a)||this._isOutsideThreshold(r[t+1],s[1],a)||this._isOutsideThreshold(r[t+2],s[2],a)||(r[t]=r[t+1]=r[t+2]=r[t+3]=0);i.putImageData(o,0,0)},_isOutsideThreshold:function(e,t,n){var i=e-t;return Math.abs(i)>n},_getColor:function(e,t,n){var i=[0,0,0,0],o=e.data,r=4*(e.width*n+t);return i[0]=o[r],i[1]=o[r+1],i[2]=o[r+2],i[3]=o[r+3],i}});function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jn(e,t){return!t||"object"!==qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zn(e){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $n(e,t){return($n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qn=D,ei=Ct.a.Image.filters;ei.Mask=Wn,ei.Blur=Xn,ei.Sharpen=Vn,ei.Emboss=Gn,ei.ColorFilter=Yn;var ti=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jn(this,Zn(t).call(this,O.FILTER,e))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$n(e,t)}(t,jt),n=t,(o=[{key:"add",value:function(e,t){var n=this;return new a.a(function(i,o){var r=n._getSourceImage(),a=n.getCanvas(),s=n._getFilter(r,e);s||(s=n._createFilter(r,e,t)),s||o(Qn.invalidParameters),n._changeFilterValues(s,t),n._apply(r,function(){a.renderAll(),i({type:e,action:"add"})})})}},{key:"remove",value:function(e){var t=this;return new a.a(function(n,i){var o=t._getSourceImage(),r=t.getCanvas();o.filters.length||i(Qn.unsupportedOperation),t._removeFilter(o,e),t._apply(o,function(){r.renderAll(),n({type:e,action:"remove"})})})}},{key:"hasFilter",value:function(e){return!!this._getFilter(this._getSourceImage(),e)}},{key:"getOptions",value:function(e){var t=this._getSourceImage(),n=this._getFilter(t,e);return n?Object(i.extend)({},n.options):null}},{key:"_changeFilterValues",value:function(e,t){Object(i.forEach)(t,function(t,n){Object(i.isUndefined)(e[n])||(e[n]=t)}),Object(i.forEach)(e.options,function(n,o){Object(i.isUndefined)(t[o])||(e.options[o]=t[o])})}},{key:"_apply",value:function(e,t){e.applyFilters(t)}},{key:"_getSourceImage",value:function(){return this.getCanvasImage()}},{key:"_createFilter",value:function(e,t,n){var i,o=this._getFabricFilterType(t),r=Ct.a.Image.filters[o];return r&&((i=new r(n)).options=n,e.filters.push(i)),i}},{key:"_getFilter",value:function(e,t){var n=null;if(e){var i,o,r=this._getFabricFilterType(t),a=e.filters.length;for(o=0;o<a;o+=1)if((i=e.filters[o]).type===r){n=i;break}}return n}},{key:"_removeFilter",value:function(e,t){var n=this._getFabricFilterType(t);e.filters=Object(i.filter)(e.filters,function(e){return e.type!==n})}},{key:"_getFabricFilterType",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}])&&Kn(n.prototype,o),r&&Kn(n,r),t}(),ni={rect:1,circle:2,triangle:1},ii={rect:{w:"width",h:"height"},circle:{w:"rx",h:"ry"},triangle:{w:"width",h:"height"}};function oi(e,t,n){var i=e.x,o=e.y,r=t.x,a=t.y,s=n*Math.PI/180;return{originX:i>(r-i)*Math.cos(s)-(a-o)*Math.sin(s)+i?"right":"left",originY:o>(r-i)*Math.sin(s)+(a-o)*Math.cos(s)+o?"bottom":"top"}}var ri=function(e){var t=e.getPointByOrigin("left","top"),n=e.getPointByOrigin("right","top"),i=e.getPointByOrigin("right","bottom"),o=e.getPointByOrigin("left","bottom");e.origins={lt:t,rt:n,rb:i,lb:o}},ai=function(e,t,n){(function(e){return"center"===e.getOriginX()&&"center"===e.getOriginY()})(e)&&(function(e,t){var n=t.getPointByOrigin("center","center"),i=oi(n,e,-t.getAngle()),o=i.originX,r=i.originY,a=t.getPointByOrigin(o,r),s=t.getLeft()-(n.x-a.x),c=t.getTop()-(n.x-a.y);t.set({originX:o,originY:r,left:s,top:c}),t.setCoords()}(t,e),function(e){var t=e.getOriginX(),n=e.getOriginY(),i=t.substring(0,1)+n.substring(0,1);e.startPoint=e.origins[i]}(e)),n?function(e){var t=e.type,n=e.scaleX,i=e.scaleY,o=ii[t],r=e[o.w]*n,a=e[o.h]*i;if(e.isRegular){var s=Math.max(n,i);r=e[o.w]*s,a=e[o.h]*s}var c={hasControls:!1,hasBorders:!1,scaleX:1,scaleY:1};c[o.w]=r,c[o.h]=a,e.set(c)}(e):function(e,t){var n=t.type,i=t.strokeWidth,o=t.startPoint,r=ni[n],a=ii[n],s=!("triangle"!==t.type),c={},l=Math.abs(o.x-e.x)/r,u=Math.abs(o.y-e.y)/r;l>i&&(l-=i/r),u>i&&(u-=i/r),t.isRegular&&(l=u=Math.max(l,u),s&&(u=Math.sqrt(3)/2*l)),c[a.w]=l,c[a.h]=u,t.set(c)}(t,e),function(e,t){var n=t.startPoint,i=oi(n,e,-t.getAngle()),o=i.originX,r=i.originY;t.setPositionByOrigin(n,o,r)}(t,e)},si=function(e){var t=e.getPointByOrigin("center","center"),n=e.getOriginX(),i=e.getOriginY(),o=e.getPointByOrigin(n,i),r=e.getLeft()+(t.x-o.x),a=e.getTop()+(t.y-o.y);e.set({hasControls:!0,hasBorders:!0,originX:"center",originY:"center",left:r,top:a}),e.setCoords()};function ci(e){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function li(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ui(e){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hi(e,t){return(hi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function di(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var fi=D,pi=P,gi=M,vi="rect",mi={strokeWidth:1,stroke:"#000000",fill:"#ffffff",width:1,height:1,rx:0,ry:0,lockSkewingX:!0,lockSkewingY:!0,lockUniScaling:!1,bringForward:!0,isRegular:!1},bi=["rect","circle","triangle"],yi=function(e){function t(e){var n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(n=!(r=ui(t).call(this,O.SHAPE,e))||"object"!==ci(r)&&"function"!=typeof r?di(o):r)._shapeObj=null,n._type=vi,n._options=Object(i.extend)({},mi),n._isSelected=!1,n._startPoint={},n._withShiftKey=!1,n._handlers={mousedown:n._onFabricMouseDown.bind(di(di(n))),mousemove:n._onFabricMouseMove.bind(di(di(n))),mouseup:n._onFabricMouseUp.bind(di(di(n))),keydown:n._onKeyDown.bind(di(di(n))),keyup:n._onKeyUp.bind(di(di(n)))},n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hi(e,t)}(t,jt),n=t,(o=[{key:"start",value:function(){var e=this.getCanvas();this._isSelected=!1,e.defaultCursor="crosshair",e.selection=!1,e.uniScaleTransform=!0,e.on({"mouse:down":this._handlers.mousedown}),Ct.a.util.addListener(document,"keydown",this._handlers.keydown),Ct.a.util.addListener(document,"keyup",this._handlers.keyup)}},{key:"end",value:function(){var e=this.getCanvas();this._isSelected=!1,e.defaultCursor="default",e.selection=!0,e.uniScaleTransform=!1,e.off({"mouse:down":this._handlers.mousedown}),Ct.a.util.removeListener(document,"keydown",this._handlers.keydown),Ct.a.util.removeListener(document,"keyup",this._handlers.keyup)}},{key:"setStates",value:function(e,t){this._type=e,t&&(this._options=Object(i.extend)(this._options,t))}},{key:"add",value:function(e,t){var n=this;return new a.a(function(i){var o=n.getCanvas();t=n._createOptions(t);var r=n._createInstance(e,t);n._bindEventOnShape(r),o.add(r).setActiveObject(r),i(n.graphics.createObjectProperties(r))})}},{key:"change",value:function(e,t){var n=this;return new a.a(function(o,r){Object(i.inArray)(e.get("type"),bi)<0&&r(fi.unsupportedType),e.set(t),n.getCanvas().renderAll(),o()})}},{key:"_createInstance",value:function(e,t){var n;switch(e){case"rect":n=new Ct.a.Rect(t);break;case"circle":n=new Ct.a.Ellipse(Object(i.extend)({type:"circle"},t));break;case"triangle":n=new Ct.a.Triangle(t);break;default:n={}}return n}},{key:"_createOptions",value:function(e){var t=A.SELECTION_STYLE;return(e=Object(i.extend)({},mi,this._options,t,e)).isRegular&&(e.lockUniScaling=!0),e}},{key:"_bindEventOnShape",value:function(e){var t=this,n=this.getCanvas();e.on({added:function(){t._shapeObj=this,ri(t._shapeObj)},selected:function(){t._isSelected=!0,t._shapeObj=this,n.uniScaleTransform=!0,n.defaultCursor="default",ri(t._shapeObj)},deselected:function(){t._isSelected=!1,t._shapeObj=null,n.defaultCursor="crosshair",n.uniScaleTransform=!1},modified:function(){var e=t._shapeObj;si(e),ri(e)},scaling:function(e){var i=n.getPointer(e.e),o=t._shapeObj;n.setCursor("crosshair"),ai(o,i,!0)}})}},{key:"_onFabricMouseDown",value:function(e){if(e.target||(this._isSelected=!1,this._shapeObj=!1),!this._isSelected&&!this._shapeObj){var t=this.getCanvas();this._startPoint=t.getPointer(e.e),t.on({"mouse:move":this._handlers.mousemove,"mouse:up":this._handlers.mouseup})}}},{key:"_onFabricMouseMove",value:function(e){var t=this,n=this.getCanvas(),i=n.getPointer(e.e),o=this._startPoint.x,r=this._startPoint.y,a=o-i.x,s=r-i.y,c=this._shapeObj;c?(this._shapeObj.set({isRegular:this._withShiftKey}),ai(c,i),n.renderAll()):this.add(this._type,{left:o,top:r,width:a,height:s}).then(function(e){t.fire(pi.ADD_OBJECT,e)})}},{key:"_onFabricMouseUp",value:function(){var e=this.getCanvas(),t=this._shapeObj;t&&si(t),this.fire(pi.ADD_OBJECT_AFTER,this.graphics.createObjectProperties(t)),e.off({"mouse:move":this._handlers.mousemove,"mouse:up":this._handlers.mouseup})}},{key:"_onKeyDown",value:function(e){e.keyCode===gi.SHIFT&&(this._withShiftKey=!0,this._shapeObj&&(this._shapeObj.isRegular=!0))}},{key:"_onKeyUp",value:function(e){e.keyCode===gi.SHIFT&&(this._withShiftKey=!1,this._shapeObj&&(this._shapeObj.isRegular=!1))}}])&&li(n.prototype,o),r&&li(n,r),t}();function _i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ki=_.create,wi=_.types,xi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t}var t,n,i;return t=e,(n=[{key:"getName",value:function(){return this.name}},{key:"start",value:function(){throw new Error(ki(wi.UN_IMPLEMENTATION,"start"))}},{key:"stop",value:function(){throw new Error(ki(wi.UN_IMPLEMENTATION,"stop"))}}])&&_i(t.prototype,n),i&&_i(t,i),e}();function Ei(e){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Si(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ci(e,t){return!t||"object"!==Ei(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ji(e,t){return(ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pi=T,Ti=O,Mi=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ci(this,Oi(t).call(this,Pi.CROPPER))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}(t,xi),n=t,(i=[{key:"start",value:function(e){e.getComponent(Ti.CROPPER).start()}},{key:"end",value:function(e){e.getComponent(Ti.CROPPER).end()}}])&&Si(n.prototype,i),o&&Si(n,o),t}();function Ai(e){return(Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Di(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ii(e,t){return!t||"object"!==Ai(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ri(e){return(Ri=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Li(e,t){return(Li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bi=T,Fi=O,Ni=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ii(this,Ri(t).call(this,Bi.FREE_DRAWING))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Li(e,t)}(t,xi),n=t,(i=[{key:"start",value:function(e,t){e.getComponent(Fi.FREE_DRAWING).start(t)}},{key:"end",value:function(e){e.getComponent(Fi.FREE_DRAWING).end()}}])&&Di(n.prototype,i),o&&Di(n,o),t}();function Hi(e){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ui(e,t){return!t||"object"!==Hi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wi(e){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vi=T,Gi=O,Yi=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ui(this,Wi(t).call(this,Vi.LINE_DRAWING))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(t,xi),n=t,(i=[{key:"start",value:function(e,t){e.getComponent(Gi.LINE).start(t)}},{key:"end",value:function(e){e.getComponent(Gi.LINE).end()}}])&&zi(n.prototype,i),o&&zi(n,o),t}();function qi(e){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ki(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ji(e,t){return!t||"object"!==qi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zi(e){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $i(e,t){return($i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qi=T,eo=O,to=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ji(this,Zi(t).call(this,Qi.SHAPE))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$i(e,t)}(t,xi),n=t,(i=[{key:"start",value:function(e){e.getComponent(eo.SHAPE).start()}},{key:"end",value:function(e){e.getComponent(eo.SHAPE).end()}}])&&Ki(n.prototype,i),o&&Ki(n,o),t}();function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function io(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oo(e,t){return!t||"object"!==no(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ro(e){return(ro=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ao(e,t){return(ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var so=T,co=O,lo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),oo(this,ro(t).call(this,so.TEXT))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ao(e,t)}(t,xi),n=t,(i=[{key:"start",value:function(e){e.getComponent(co.TEXT).start()}},{key:"end",value:function(e){e.getComponent(co.TEXT).end()}}])&&io(n.prototype,i),o&&io(n,o),t}();function uo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ho=O,fo=P,po=T,go=A,vo=o.a.extend,mo=o.a.stamp,bo=o.a.isArray,yo=o.a.isString,_o=o.a.forEachArray,ko=o.a.forEachOwnProperties,wo=o.a.CustomEvents,xo=1e3,Eo=800,So={cssOnly:!0},Co={backstoreOnly:!0},Oo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.cssMaxWidth,o=n.cssMaxHeight,r=n.useItext,a=void 0!==r&&r,s=n.useDragAddIcon,c=void 0!==s&&s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasImage=null,this.cssMaxWidth=i||xo,this.cssMaxHeight=o||Eo,this.useItext=a,this.useDragAddIcon=c,this.cropSelectionStyle={},this.imageName="",this._objects={},this._canvas=null,this._drawingMode=po.NORMAL,this._drawingModeMap={},this._componentMap={},this._handler={onMouseDown:this._onMouseDown.bind(this),onObjectAdded:this._onObjectAdded.bind(this),onObjectRemoved:this._onObjectRemoved.bind(this),onObjectMoved:this._onObjectMoved.bind(this),onObjectScaled:this._onObjectScaled.bind(this),onObjectSelected:this._onObjectSelected.bind(this),onPathCreated:this._onPathCreated.bind(this),onSelectionCleared:this._onSelectionCleared.bind(this),onSelectionCreated:this._onSelectionCreated.bind(this)},this._setCanvasElement(t),this._createDrawingModeInstances(),this._createComponents(),this._attachCanvasEvents()}var t,n,i;return t=e,(n=[{key:"destroy",value:function(){var e=this._canvas.wrapperEl;this._canvas.clear(),e.parentNode.removeChild(e)}},{key:"deactivateAll",value:function(){return this._canvas.deactivateAll(),this}},{key:"renderAll",value:function(){return this._canvas.renderAll(),this}},{key:"add",value:function(e){var t,n=[];bo(e)?n=e:n.push(e),(t=this._canvas).add.apply(t,n)}},{key:"contains",value:function(e){return this._canvas.contains(e)}},{key:"getObjects",value:function(){return this._canvas.getObjects().slice()}},{key:"getObject",value:function(e){return this._objects[e]}},{key:"remove",value:function(e){this._canvas.remove(e)}},{key:"removeAll",value:function(e){var t=this._canvas,n=t.getObjects().slice();return t.remove.apply(t,this._canvas.getObjects()),e&&t.clear(),n}},{key:"removeObjectById",value:function(e){var t=[],n=this._canvas,i=this.getObject(e);return i&&i.isType("group")&&!i.isEmpty()?(n.discardActiveGroup(),i.forEachObject(function(e){t.push(e),e.remove()})):n.contains(i)&&(t.push(i),i.remove()),t}},{key:"getObjectId",value:function(e){var t=null;for(t in this._objects)if(this._objects.hasOwnProperty(t)&&e===this._objects[t])return t;return null}},{key:"getActiveObject",value:function(){return this._canvas.getActiveObject()}},{key:"getActiveGroupObject",value:function(){return this._canvas.getActiveGroup()}},{key:"setActiveObject",value:function(e){this._canvas.setActiveObject(e)}},{key:"setCropSelectionStyle",value:function(e){this.cropSelectionStyle=e}},{key:"getComponent",value:function(e){return this._componentMap[e]}},{key:"getDrawingMode",value:function(){return this._drawingMode}},{key:"startDrawingMode",value:function(e,t){if(this._isSameDrawingMode(e))return!0;this.stopDrawingMode();var n=this._getDrawingModeInstance(e);return n&&n.start&&(n.start(this,t),this._drawingMode=e),!!n}},{key:"stopDrawingMode",value:function(){if(!this._isSameDrawingMode(po.NORMAL)){var e=this._getDrawingModeInstance(this.getDrawingMode());e&&e.end&&e.end(this),this._drawingMode=po.NORMAL}}},{key:"toDataURL",value:function(e){return this._canvas&&this._canvas.toDataURL(e)}},{key:"setCanvasImage",value:function(e,t){t&&mo(t),this.imageName=e,this.canvasImage=t}},{key:"setCssMaxDimension",value:function(e){this.cssMaxWidth=e.width||this.cssMaxWidth,this.cssMaxHeight=e.height||this.cssMaxHeight}},{key:"adjustCanvasDimension",value:function(){var e=this.canvasImage.scale(1),t=e.getBoundingRect(),n=t.width,i=t.height,o=this._calcMaxDimension(n,i);this.setCanvasCssDimension({width:"100%",height:"100%","max-width":"".concat(o.width,"px"),"max-height":"".concat(o.height,"px")}),this.setCanvasBackstoreDimension({width:n,height:i}),this._canvas.centerObject(e)}},{key:"setCanvasCssDimension",value:function(e){this._canvas.setDimensions(e,So)}},{key:"setCanvasBackstoreDimension",value:function(e){this._canvas.setDimensions(e,Co)}},{key:"setImageProperties",value:function(e,t){var n=this.canvasImage;n&&(n.set(e).setCoords(),t&&this._canvas.renderAll())}},{key:"getCanvasElement",value:function(){return this._canvas.getElement()}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getCanvasImage",value:function(){return this.canvasImage}},{key:"getImageName",value:function(){return this.imageName}},{key:"addImageObject",value:function(e){var t=this,n=this._callbackAfterLoadingImageObject.bind(this);return new a.a(function(i){Ct.a.Image.fromURL(e,function(e){n(e),i(t.createObjectProperties(e))},{crossOrigin:"Anonymous"})})}},{key:"getCenter",value:function(){return this._canvas.getCenter()}},{key:"getCropzoneRect",value:function(){return this.getComponent(ho.CROPPER).getCropzoneRect()}},{key:"setCropzoneRect",value:function(e){return this.getComponent(ho.CROPPER).setCropzoneRect(e)}},{key:"getCroppedImageData",value:function(e){return this.getComponent(ho.CROPPER).getCroppedImageData(e)}},{key:"setBrush",value:function(e){var t=this._drawingMode,n=ho.FREE_DRAWING;t===po.LINE&&(n=po.LINE),this.getComponent(n).setBrush(e)}},{key:"setDrawingShape",value:function(e,t){this.getComponent(ho.SHAPE).setStates(e,t)}},{key:"registerPaths",value:function(e){this.getComponent(ho.ICON).registerPaths(e)}},{key:"changeCursor",value:function(e){var t=this.getCanvas();t.defaultCursor=e,t.renderAll()}},{key:"hasFilter",value:function(e){return this.getComponent(ho.FILTER).hasFilter(e)}},{key:"setSelectionStyle",value:function(e){vo(go.SELECTION_STYLE,e)}},{key:"setObjectProperties",value:function(e,t){var n=this.getObject(e),i=vo({},t);return n.set(i),n.setCoords(),this.getCanvas().renderAll(),i}},{key:"getObjectProperties",value:function(e,t){var n=this.getObject(e),i={};return yo(t)?i[t]=n[t]:bo(t)?_o(t,function(e){i[e]=n[e]}):ko(t,function(e,t){i[t]=n[t]}),i}},{key:"getObjectPosition",value:function(e,t,n){var i=this.getObject(e);return i?i.getPointByOrigin(t,n):null}},{key:"setObjectPosition",value:function(e,t){var n=this.getObject(e),i=t.x,o=t.y,r=t.originX,a=t.originY;if(!n)return!1;var s=n.getPointByOrigin(r,a),c=n.getPointByOrigin("center","center"),l=c.x-s.x,u=c.y-s.y;return n.set({left:i+l,top:o+u}),n.setCoords(),!0}},{key:"getCanvasSize",value:function(){var e=this.getCanvasImage();return{width:e?e.width:0,height:e?e.height:0}}},{key:"_getDrawingModeInstance",value:function(e){return this._drawingModeMap[e]}},{key:"_setCanvasElement",value:function(e){var t,n;"CANVAS"!==(t=e.jquery?e[0]:e.nodeType?e:document.querySelector(e)).nodeName.toUpperCase()&&(n=document.createElement("canvas"),t.appendChild(n)),this._canvas=new Ct.a.Canvas(n,{containerClass:"tui-image-editor-canvas-container",enableRetinaScaling:!1})}},{key:"_createDrawingModeInstances",value:function(){this._register(this._drawingModeMap,new Mi),this._register(this._drawingModeMap,new Ni),this._register(this._drawingModeMap,new Yi),this._register(this._drawingModeMap,new to),this._register(this._drawingModeMap,new lo)}},{key:"_createComponents",value:function(){this._register(this._componentMap,new Bt(this)),this._register(this._componentMap,new Vt(this)),this._register(this._componentMap,new Qt(this)),this._register(this._componentMap,new sn(this)),this._register(this._componentMap,new fn(this)),this._register(this._componentMap,new _n(this)),this._register(this._componentMap,new Dn(this)),this._register(this._componentMap,new Un(this)),this._register(this._componentMap,new ti(this)),this._register(this._componentMap,new yi(this))}},{key:"_register",value:function(e,t){e[t.getName()]=t}},{key:"_isSameDrawingMode",value:function(e){return this.getDrawingMode()===e}},{key:"_calcMaxDimension",value:function(e,t){var n=this.cssMaxWidth/e,i=this.cssMaxHeight/t,o=Math.min(e,this.cssMaxWidth),r=Math.min(t,this.cssMaxHeight);return n<1&&n<i?(o=e*n,r=t*n):i<1&&i<n&&(o=e*i,r=t*i),{width:Math.floor(o),height:Math.floor(r)}}},{key:"_callbackAfterLoadingImageObject",value:function(e){var t=this.getCanvasImage().getCenterPoint();e.set(A.SELECTION_STYLE),e.set({left:t.x,top:t.y,crossOrigin:"Anonymous"}),this.getCanvas().add(e).setActiveObject(e)}},{key:"_attachCanvasEvents",value:function(){var e=this._canvas,t=this._handler;e.on({"mouse:down":t.onMouseDown,"object:added":t.onObjectAdded,"object:removed":t.onObjectRemoved,"object:moving":t.onObjectMoved,"object:scaling":t.onObjectScaled,"object:selected":t.onObjectSelected,"path:created":t.onPathCreated,"selection:cleared":t.onSelectionCleared,"selection:created":t.onSelectionCreated})}},{key:"_onMouseDown",value:function(e){var t=this._canvas.getPointer(e.e);this.fire(fo.MOUSE_DOWN,e.e,t)}},{key:"_onObjectAdded",value:function(e){var t=e.target;t.isType("cropzone")||this._addFabricObject(t)}},{key:"_onObjectRemoved",value:function(e){var t=e.target;this._removeFabricObject(mo(t))}},{key:"_onObjectMoved",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(fo.OBJECT_MOVED,n)}},{key:"_onObjectScaled",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(fo.OBJECT_SCALED,n)}},{key:"_onObjectSelected",value:function(e){var t=e.target,n=this.createObjectProperties(t);this.fire(fo.OBJECT_ACTIVATED,n)}},{key:"_onPathCreated",value:function(e){e.path.set(A.SELECTION_STYLE);var t=this.createObjectProperties(e.path);this.fire(fo.ADD_OBJECT,t)}},{key:"_onSelectionCleared",value:function(){this.fire(fo.SELECTION_CLEARED)}},{key:"_onSelectionCreated",value:function(e){this.fire(fo.SELECTION_CREATED,e.target)}},{key:"discardSelection",value:function(){this._canvas.discardActiveGroup(),this._canvas.discardActiveObject(),this._canvas.renderAll()}},{key:"changeSelectableAll",value:function(e){this._canvas.forEachObject(function(t){t.selectable=e,t.hoverCursor=e?"move":"crosshair"})}},{key:"createObjectProperties",value:function(e){var t={id:mo(e),type:e.type};return vo(t,d(e,["left","top","width","height","fill","stroke","strokeWidth","opacity"])),["i-text","text"].indexOf(e.type)>-1&&vo(t,this._createTextProperties(e,t)),t}},{key:"_createTextProperties",value:function(e){var t={};return vo(t,d(e,["text","fontFamily","fontSize","fontStyle","textAlign","textDecoration"])),t}},{key:"_addFabricObject",value:function(e){var t=mo(e);return this._objects[t]=e,t}},{key:"_removeFabricObject",value:function(e){delete this._objects[e]}}])&&uo(t.prototype,n),i&&uo(t,i),e}();wo.mixin(Oo);var jo=Oo;function Po(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var To=P,Mo=j,Ao=M,Do=D,Io=o.a.isUndefined,Ro=o.a.forEach,Lo=o.a.CustomEvents,Bo=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=o.a.extend({includeUI:!1,usageStatistics:!0},n),this.mode=null,this.activeObjectId=null,n.includeUI&&(this.ui=new _t(t,n.includeUI,this.getActions()),n=this.ui.setUiDefaultSelectionStyle(n)),this._invoker=new ee,this._graphics=new jo(this.ui?this.ui.getEditorArea():t,{cssMaxWidth:n.cssMaxWidth,cssMaxHeight:n.cssMaxHeight,useItext:!!this.ui,useDragAddIcon:!!this.ui}),this._handlers={keydown:this._onKeyDown.bind(this),mousedown:this._onMouseDown.bind(this),objectActivated:this._onObjectActivated.bind(this),objectMoved:this._onObjectMoved.bind(this),objectScaled:this._onObjectScaled.bind(this),createdPath:this._onCreatedPath,addText:this._onAddText.bind(this),addObject:this._onAddObject.bind(this),addObjectAfter:this._onAddObjectAfter.bind(this),textEditing:this._onTextEditing.bind(this),textChanged:this._onTextChanged.bind(this),iconCreateResize:this._onIconCreateResize.bind(this),iconCreateEnd:this._onIconCreateEnd.bind(this),selectionCleared:this._selectionCleared.bind(this),selectionCreated:this._selectionCreated.bind(this)},this._attachInvokerEvents(),this._attachGraphicsEvents(),this._attachDomEvents(),this._setSelectionStyle(n.selectionStyle,{applyCropSelectionStyle:n.applyCropSelectionStyle,applyGroupSelectionStyle:n.applyGroupSelectionStyle}),n.usageStatistics&&(l||(l=!0,Object(i.sendHostname)("image-editor","UA-129999381-1"))),this.ui&&(this.ui.initCanvas(),this.setReAction())}var t,n,r;return t=e,(n=[{key:"_setSelectionStyle",value:function(e,t){var n=t.applyCropSelectionStyle,i=t.applyGroupSelectionStyle;e&&this._graphics.setSelectionStyle(e),n&&this._graphics.setCropSelectionStyle(e),i&&this.on("selectionCreated",function(t){"group"===t.type&&t.set(e)})}},{key:"_attachInvokerEvents",value:function(){var e=To.UNDO_STACK_CHANGED,t=To.REDO_STACK_CHANGED;this._invoker.on(e,this.fire.bind(this,e)),this._invoker.on(t,this.fire.bind(this,t))}},{key:"_attachGraphicsEvents",value:function(){this._graphics.on({mousedown:this._handlers.mousedown,objectMoved:this._handlers.objectMoved,objectScaled:this._handlers.objectScaled,objectActivated:this._handlers.objectActivated,addText:this._handlers.addText,addObject:this._handlers.addObject,textEditing:this._handlers.textEditing,textChanged:this._handlers.textChanged,iconCreateResize:this._handlers.iconCreateResize,iconCreateEnd:this._handlers.iconCreateEnd,selectionCleared:this._handlers.selectionCleared,selectionCreated:this._handlers.selectionCreated,addObjectAfter:this._handlers.addObjectAfter})}},{key:"_attachDomEvents",value:function(){document.addEventListener("keydown",this._handlers.keydown)}},{key:"_detachDomEvents",value:function(){document.removeEventListener("keydown",this._handlers.keydown)}},{key:"_onKeyDown",value:function(e){var t=this._graphics.getActiveObject(),n=this._graphics.getActiveGroupObject(),i=t||n;(e.ctrlKey||e.metaKey)&&e.keyCode===Ao.Z&&this.undo().catch(function(){}),(e.ctrlKey||e.metaKey)&&e.keyCode===Ao.Y&&this.redo().catch(function(){}),e.keyCode!==Ao.BACKSPACE&&e.keyCode!==Ao.DEL||!i||(e.preventDefault(),this.removeActiveObject())}},{key:"removeActiveObject",value:function(){var e=this._graphics.getActiveObject(),t=this._graphics.getActiveGroupObject();if(t){var n=t.getObjects();this.discardSelection(),this._removeObjectStream(n)}else if(e){var i=this._graphics.getObjectId(e);this.removeObject(i)}}},{key:"_removeObjectStream",value:function(e){var t=this;if(!e.length)return!0;var n=e.pop();return this.removeObject(this._graphics.getObjectId(n)).then(function(){return t._removeObjectStream(e)})}},{key:"_onMouseDown",value:function(e,t){this.fire(To.MOUSE_DOWN,e,t)}},{key:"_pushAddObjectCommand",value:function(e){var t=C.create(Mo.ADD_OBJECT,this._graphics,e);this._invoker.pushUndoStack(t)}},{key:"_onObjectActivated",value:function(e){this.fire(To.OBJECT_ACTIVATED,e)}},{key:"_onObjectMoved",value:function(e){this.fire(To.OBJECT_MOVED,e)}},{key:"_onObjectScaled",value:function(e){this.fire(To.OBJECT_SCALED,e)}},{key:"getDrawingMode",value:function(){return this._graphics.getDrawingMode()}},{key:"clearObjects",value:function(){return this.execute(Mo.CLEAR_OBJECTS)}},{key:"deactivateAll",value:function(){this._graphics.deactivateAll(),this._graphics.renderAll()}},{key:"discardSelection",value:function(){this._graphics.discardSelection()}},{key:"changeSelectableAll",value:function(e){this._graphics.changeSelectableAll(e)}},{key:"execute",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var r=[this._graphics].concat(i);return(t=this._invoker).execute.apply(t,[e].concat(r))}},{key:"undo",value:function(){return this._invoker.undo()}},{key:"redo",value:function(){return this._invoker.redo()}},{key:"loadImageFromFile",value:function(e,t){if(!e)return a.a.reject(Do.invalidParameters);var n=URL.createObjectURL(e);return t=t||e.name,this.loadImageFromURL(n,t).then(function(t){return URL.revokeObjectURL(e),t})}},{key:"loadImageFromURL",value:function(e,t){return t&&e?this.execute(Mo.LOAD_IMAGE,t,e):a.a.reject(Do.invalidParameters)}},{key:"addImageObject",value:function(e){return e?this.execute(Mo.ADD_IMAGE_OBJECT,e):a.a.reject(Do.invalidParameters)}},{key:"startDrawingMode",value:function(e,t){return this._graphics.startDrawingMode(e,t)}},{key:"stopDrawingMode",value:function(){this._graphics.stopDrawingMode()}},{key:"crop",value:function(e){var t=this._graphics.getCroppedImageData(e);return t?this.loadImageFromURL(t.url,t.imageName):a.a.reject(Do.invalidParameters)}},{key:"getCropzoneRect",value:function(){return this._graphics.getCropzoneRect()}},{key:"setCropzoneRect",value:function(e){return this._graphics.setCropzoneRect(e)}},{key:"_flip",value:function(e){return this.execute(Mo.FLIP_IMAGE,e)}},{key:"flipX",value:function(){return this._flip("flipX")}},{key:"flipY",value:function(){return this._flip("flipY")}},{key:"resetFlip",value:function(){return this._flip("reset")}},{key:"_rotate",value:function(e,t){return this.execute(Mo.ROTATE_IMAGE,e,t)}},{key:"rotate",value:function(e){return this._rotate("rotate",e)}},{key:"setAngle",value:function(e){return this._rotate("setAngle",e)}},{key:"setBrush",value:function(e){this._graphics.setBrush(e)}},{key:"setDrawingShape",value:function(e,t){this._graphics.setDrawingShape(e,t)}},{key:"addShape",value:function(e,t){return t=t||{},this._setPositions(t),this.execute(Mo.ADD_SHAPE,e,t)}},{key:"changeShape",value:function(e,t){return this.execute(Mo.CHANGE_SHAPE,e,t)}},{key:"addText",value:function(e,t){return e=e||"",t=t||{},this.execute(Mo.ADD_TEXT,e,t)}},{key:"changeText",value:function(e,t){return t=t||"",this.execute(Mo.CHANGE_TEXT,e,t)}},{key:"changeTextStyle",value:function(e,t){return this.execute(Mo.CHANGE_TEXT_STYLE,e,t)}},{key:"_changeActivateMode",value:function(e){"ICON"!==e&&this.getDrawingMode()!==e&&this.startDrawingMode(e)}},{key:"_onTextChanged",value:function(e){this.changeText(e.id,e.text)}},{key:"_onIconCreateResize",value:function(e){this.fire(To.ICON_CREATE_RESIZE,e)}},{key:"_onIconCreateEnd",value:function(e){this.fire(To.ICON_CREATE_END,e)}},{key:"_onTextEditing",value:function(){this.fire(To.TEXT_EDITING)}},{key:"_onAddText",value:function(e){this.fire(To.ADD_TEXT,{originPosition:e.originPosition,clientPosition:e.clientPosition})}},{key:"_onAddObject",value:function(e){var t=this._graphics.getObject(e.id);this._pushAddObjectCommand(t)}},{key:"_onAddObjectAfter",value:function(e){this.fire(To.ADD_OBJECT_AFTER,e)}},{key:"_selectionCleared",value:function(){this.fire(To.SELECTION_CLEARED)}},{key:"_selectionCreated",value:function(e){this.fire(To.SELECTION_CREATED,e)}},{key:"registerIcons",value:function(e){this._graphics.registerPaths(e)}},{key:"changeCursor",value:function(e){this._graphics.changeCursor(e)}},{key:"addIcon",value:function(e,t){return t=t||{},this._setPositions(t),this.execute(Mo.ADD_ICON,e,t)}},{key:"changeIconColor",value:function(e,t){return this.execute(Mo.CHANGE_ICON_COLOR,e,t)}},{key:"removeObject",value:function(e){return this.execute(Mo.REMOVE_OBJECT,e)}},{key:"hasFilter",value:function(e){return this._graphics.hasFilter(e)}},{key:"removeFilter",value:function(e){return this.execute(Mo.REMOVE_FILTER,e)}},{key:"applyFilter",value:function(e,t){return this.execute(Mo.APPLY_FILTER,e,t)}},{key:"toDataURL",value:function(e){return this._graphics.toDataURL(e)}},{key:"getImageName",value:function(){return this._graphics.getImageName()}},{key:"clearUndoStack",value:function(){this._invoker.clearUndoStack()}},{key:"clearRedoStack",value:function(){this._invoker.clearRedoStack()}},{key:"isEmptyUndoStack",value:function(){return this._invoker.isEmptyUndoStack()}},{key:"isEmptyRedoStack",value:function(){return this._invoker.isEmptyRedoStack()}},{key:"resizeCanvasDimension",value:function(e){return e?this.execute(Mo.RESIZE_CANVAS_DIMENSION,e):a.a.reject(Do.invalidParameters)}},{key:"destroy",value:function(){var e=this;this.stopDrawingMode(),this._detachDomEvents(),this._graphics.destroy(),this._graphics=null,Ro(this,function(t,n){e[n]=null},this)}},{key:"_setPositions",value:function(e){var t=this._graphics.getCenter();Io(e.left)&&(e.left=t.left),Io(e.top)&&(e.top=t.top)}},{key:"setObjectProperties",value:function(e,t){return this.execute(Mo.SET_OBJECT_PROPERTIES,e,t)}},{key:"setObjectPropertiesQuietly",value:function(e,t){this._graphics.setObjectProperties(e,t)}},{key:"getObjectProperties",value:function(e,t){return this._graphics.getObject(e)?this._graphics.getObjectProperties(e,t):null}},{key:"getCanvasSize",value:function(){return this._graphics.getCanvasSize()}},{key:"getObjectPosition",value:function(e,t,n){return this._graphics.getObjectPosition(e,t,n)}},{key:"setObjectPosition",value:function(e,t){return this.execute(Mo.SET_OBJECT_POSITION,e,t)}}])&&Po(t.prototype,n),r&&Po(t,r),e}();Et.mixin(Bo),Lo.mixin(Bo);var Fo=Bo,No=(n(69),j),Ho=O.ICON,zo={name:No.ADD_ICON,execute:function(e,t,n){var i=this;return e.getComponent(Ho).add(t,n).then(function(t){return i.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),a.a.resolve()}};C.register(zo);var Uo={name:j.ADD_IMAGE_OBJECT,execute:function(e,t){var n=this;return e.addImageObject(t).then(function(t){return n.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),a.a.resolve()}};C.register(Uo);var Wo=D,Xo={name:j.ADD_OBJECT,execute:function(e,t){return new a.a(function(n,i){e.contains(t)?i(Wo.addedObject):(e.add(t),n(t))})},undo:function(e,t){return new a.a(function(n,i){e.contains(t)?(e.remove(t),n(t)):i(Wo.noObject)})}};C.register(Xo);var Vo=j,Go=O.SHAPE,Yo={name:Vo.ADD_SHAPE,execute:function(e,t,n){var i=this;return e.getComponent(Go).add(t,n).then(function(t){return i.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),a.a.resolve()}};C.register(Yo);var qo=j,Ko=O.TEXT,Jo={name:qo.ADD_TEXT,execute:function(e,t,n){var i=this;return e.getComponent(Ko).add(t,n).then(function(t){return i.undoData.object=e.getObject(t.id),t})},undo:function(e){return e.remove(this.undoData.object),a.a.resolve()}};C.register(Jo);var Zo=D,$o=j,Qo=O.FILTER,er={name:$o.APPLY_FILTER,execute:function(e,t,n){var i=e.getComponent(Qo);if("mask"===t){var o=e.getObject(n.maskObjId);if(!o||!o.isType("image"))return Promise.reject(Zo.invalidParameters);n={mask:o}}return"mask"===t?(this.undoData.object=n.mask,e.remove(n.mask)):this.undoData.options=i.getOptions(t),i.add(t,n)},undo:function(e,t){var n=e.getComponent(Qo);if("mask"===t){var i=this.undoData.object;return e.add(i),e.setActiveObject(i),n.remove(t)}return this.undoData.options?n.add(t,this.undoData.options):n.remove(t)}};C.register(er);var tr=D,nr=j,ir=O.ICON,or={name:nr.CHANGE_ICON_COLOR,execute:function(e,t,n){var i=this;return new a.a(function(o,r){var a=e.getComponent(ir),s=e.getObject(t);s||r(tr.noObject),i.undoData.object=s,i.undoData.color=a.getColor(s),a.setColor(n,s),o()})},undo:function(e){var t=e.getComponent(ir),n=this.undoData.object,i=n.object,o=n.color;return t.setColor(o,i),a.a.resolve()}};C.register(or);var rr=D,ar=j,sr=O.SHAPE,cr={name:ar.CHANGE_SHAPE,execute:function(e,t,n){var i=this,r=e.getComponent(sr),s=e.getObject(t);return s?(this.undoData.object=s,this.undoData.options={},o.a.forEachOwnProperties(n,function(e,t){i.undoData.options[t]=s[t]}),r.change(s,n)):a.a.reject(rr.noObject)},undo:function(e){var t=e.getComponent(sr),n=this.undoData,i=n.object,o=n.options;return t.change(i,o)}};C.register(cr);var lr=D,ur=j,hr=O.TEXT,dr={name:ur.CHANGE_TEXT,execute:function(e,t,n){var i=e.getComponent(hr),o=e.getObject(t);return o?(this.undoData.object=o,this.undoData.text=i.getText(o),i.change(o,n)):a.a.reject(lr.noObject)},undo:function(e){var t=e.getComponent(hr),n=this.undoData,i=n.object,o=n.text;return t.change(i,o)}};C.register(dr);var fr=D,pr=j,gr=O.TEXT,vr={name:pr.CHANGE_TEXT_STYLE,execute:function(e,t,n){var i=this,r=e.getComponent(gr),s=e.getObject(t);return s?(this.undoData.object=s,this.undoData.styles={},o.a.forEachOwnProperties(n,function(e,t){i.undoData.styles[t]=s[t]}),r.setStyle(s,n)):a.a.reject(fr.noObject)},undo:function(e){var t=e.getComponent(gr),n=this.undoData,i=n.object,o=n.styles;return t.setStyle(i,o)}};C.register(vr);var mr={name:j.CLEAR_OBJECTS,execute:function(e){var t=this;return new a.a(function(n){t.undoData.objects=e.removeAll(),n()})},undo:function(e){return e.add(this.undoData.objects),a.a.resolve()}};C.register(mr);var br=j,yr=O.FLIP,_r={name:br.FLIP_IMAGE,execute:function(e,t){var n=e.getComponent(yr);return this.undoData.setting=n.getCurrentSetting(),n[t]()},undo:function(e){return e.getComponent(yr).set(this.undoData.setting)}};C.register(_r);var kr=j,wr=O.IMAGE_LOADER,xr={name:kr.LOAD_IMAGE,execute:function(e,t,n){var i=e.getComponent(wr),o=i.getCanvasImage(),r=o?o.width:0,a=o?o.height:0,s=e.removeAll(!0).filter(function(e){return"cropzone"!==e.type});return s.forEach(function(e){e.evented=!0}),this.undoData={name:i.getImageName(),image:o,objects:s},i.load(t,n).then(function(e){return{oldWidth:r,oldHeight:a,newWidth:e.width,newHeight:e.height}})},undo:function(e){var t=e.getComponent(wr),n=this.undoData,i=n.objects,o=n.name,r=n.image;return e.removeAll(!0),e.add(i),t.load(o,r)}};C.register(xr);var Er=j,Sr=O.FILTER,Cr={name:Er.REMOVE_FILTER,execute:function(e,t){var n=e.getComponent(Sr);return this.undoData.options=n.getOptions(t),n.remove(t)},undo:function(e,t){var n=e.getComponent(Sr),i=this.undoData.options;return n.add(t,i)}};C.register(Cr);var Or=D,jr={name:j.REMOVE_OBJECT,execute:function(e,t){var n=this;return new a.a(function(i,o){n.undoData.objects=e.removeObjectById(t),n.undoData.objects.length?i():o(Or.noObject)})},undo:function(e){return e.add(this.undoData.objects),a.a.resolve()}};C.register(jr);var Pr={name:j.RESIZE_CANVAS_DIMENSION,execute:function(e,t){var n=this;return new a.a(function(i){n.undoData.size={width:e.cssMaxWidth,height:e.cssMaxHeight},e.setCssMaxDimension(t),e.adjustCanvasDimension(),i()})},undo:function(e){return e.setCssMaxDimension(this.undoData.size),e.adjustCanvasDimension(),a.a.resolve()}};C.register(Pr);var Tr=j,Mr=O.ROTATION,Ar={name:Tr.ROTATE_IMAGE,execute:function(e,t,n){var i=e.getComponent(Mr);return this.undoData.angle=i.getCurrentAngle(),i[t](n)},undo:function(e){var t=e.getComponent(Mr),n=this.undoData.angle;return t.setAngle(n)}};C.register(Ar);var Dr=D,Ir={name:j.SET_OBJECT_PROPERTIES,execute:function(e,t,n){var i=this,r=e.getObject(t);return r?(this.undoData.props={},o.a.forEachOwnProperties(n,function(e,t){i.undoData.props[t]=r[t]}),e.setObjectProperties(t,n),a.a.resolve()):a.a.reject(Dr.noObject)},undo:function(e,t){var n=this.undoData.props;return e.setObjectProperties(t,n),a.a.resolve()}};C.register(Ir);var Rr=D,Lr={name:j.SET_OBJECT_POSITION,execute:function(e,t,n){return e.getObject(t)?(this.undoData.objectId=t,this.undoData.props=e.getObjectProperties(t,["left","top"]),e.setObjectPosition(t,n),e.renderAll(),a.a.resolve()):a.a.reject(Rr.noObject)},undo:function(e){var t=this.undoData,n=t.objectId,i=t.props;return e.setObjectProperties(n,i),e.renderAll(),a.a.resolve()}};C.register(Lr);t.default=Fo},function(e,t){}])});